const $0=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}};$0();function Ee(){}const Ru=t=>t;function Fc(t,e){for(const i in e)t[i]=e[i];return t}function Xm(t){return t()}function pd(){return Object.create(null)}function ki(t){t.forEach(Xm)}function xu(t){return typeof t=="function"}function Je(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function z0(t){return Object.keys(t).length===0}function Zm(t,...e){if(t==null)return Ee;const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function Nr(t){let e;return Zm(t,i=>e=i)(),e}function St(t,e,i){t.$$.on_destroy.push(Zm(e,i))}function zi(t,e,i,n){if(t){const s=ep(t,e,i,n);return t[0](s)}}function ep(t,e,i,n){return t[1]&&n?Fc(i.ctx.slice(),t[1](n(e))):i.ctx}function ji(t,e,i,n){if(t[2]&&n){const s=t[2](n(i));if(e.dirty===void 0)return s;if(typeof s=="object"){const r=[],o=Math.max(e.dirty.length,s.length);for(let a=0;a<o;a+=1)r[a]=e.dirty[a]|s[a];return r}return e.dirty|s}return e.dirty}function qi(t,e,i,n,s,r){if(s){const o=ep(e,i,n,r);t.p(o,s)}}function Wi(t){if(t.ctx.length>32){const e=[],i=t.ctx.length/32;for(let n=0;n<i;n++)e[n]=-1;return e}return-1}function ls(t,e,i){return t.set(i),e}function gd(t){const e=typeof t=="string"&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const tp=typeof window!="undefined";let ip=tp?()=>window.performance.now():()=>Date.now(),Du=tp?t=>requestAnimationFrame(t):Ee;const cs=new Set;function np(t){cs.forEach(e=>{e.c(t)||(cs.delete(e),e.f())}),cs.size!==0&&Du(np)}function sp(t){let e;return cs.size===0&&Du(np),{promise:new Promise(i=>{cs.add(e={c:t,f:i})}),abort(){cs.delete(e)}}}function b(t,e){t.appendChild(e)}function rp(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function j0(t){const e=_("style");return q0(rp(t),e),e.sheet}function q0(t,e){return b(t.head||t,e),e.sheet}function q(t,e,i){t.insertBefore(e,i||null)}function j(t){t.parentNode&&t.parentNode.removeChild(t)}function Or(t,e){for(let i=0;i<t.length;i+=1)t[i]&&t[i].d(e)}function _(t){return document.createElement(t)}function Oe(t){return document.createTextNode(t)}function $(){return Oe(" ")}function Ga(){return Oe("")}function B(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function Mu(t){return function(e){return e.preventDefault(),t.call(this,e)}}function C(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function m(t,e,i){e in t?t[e]=typeof t[e]=="boolean"&&i===""?!0:i:C(t,e,i)}function W0(t){return Array.from(t.childNodes)}function Ni(t,e){e=""+e,t.data!==e&&(t.data=e)}function vd(t,e){t.value=e==null?"":e}function yd(t,e,i,n){i==null?t.style.removeProperty(e):t.style.setProperty(e,i,n?"important":"")}function Kn(t,e,i){for(let n=0;n<t.options.length;n+=1){const s=t.options[n];if(s.__value===e){s.selected=!0;return}}(!i||e!==void 0)&&(t.selectedIndex=-1)}function Xl(t){const e=t.querySelector(":checked");return e&&e.__value}function Vo(t,e,i){t.classList[i?"add":"remove"](e)}function op(t,e,{bubbles:i=!1,cancelable:n=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,i,n,e),s}const ua=new Map;let ha=0;function K0(t){let e=5381,i=t.length;for(;i--;)e=(e<<5)-e^t.charCodeAt(i);return e>>>0}function G0(t,e){const i={stylesheet:j0(e),rules:{}};return ua.set(t,i),i}function bd(t,e,i,n,s,r,o,a=0){const l=16.666/n;let u=`{
`;for(let v=0;v<=1;v+=l){const S=e+(i-e)*r(v);u+=v*100+`%{${o(S,1-S)}}
`}const c=u+`100% {${o(i,1-i)}}
}`,h=`__svelte_${K0(c)}_${a}`,d=rp(t),{stylesheet:f,rules:p}=ua.get(d)||G0(d,t);p[h]||(p[h]=!0,f.insertRule(`@keyframes ${h} ${c}`,f.cssRules.length));const T=t.style.animation||"";return t.style.animation=`${T?`${T}, `:""}${h} ${n}ms linear ${s}ms 1 both`,ha+=1,h}function Q0(t,e){const i=(t.style.animation||"").split(", "),n=i.filter(e?r=>r.indexOf(e)<0:r=>r.indexOf("__svelte")===-1),s=i.length-n.length;s&&(t.style.animation=n.join(", "),ha-=s,ha||Y0())}function Y0(){Du(()=>{ha||(ua.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&j(e)}),ua.clear())})}let Vr;function Sr(t){Vr=t}function Qa(){if(!Vr)throw new Error("Function called outside component initialization");return Vr}function Gt(t){Qa().$$.on_mount.push(t)}function J0(t){Qa().$$.after_update.push(t)}function X0(t){Qa().$$.on_destroy.push(t)}function jt(){const t=Qa();return(e,i,{cancelable:n=!1}={})=>{const s=t.$$.callbacks[e];if(s){const r=op(e,i,{cancelable:n});return s.slice().forEach(o=>{o.call(t,r)}),!r.defaultPrevented}return!0}}function Z0(t,e){const i=t.$$.callbacks[e.type];i&&i.slice().forEach(n=>n.call(this,e))}const Zn=[],Bt=[];let us=[];const Uc=[],eb=Promise.resolve();let Hc=!1;function tb(){Hc||(Hc=!0,eb.then(ap))}function ei(t){us.push(t)}function wd(t){Uc.push(t)}const Zl=new Set;let Gn=0;function ap(){if(Gn!==0)return;const t=Vr;do{try{for(;Gn<Zn.length;){const e=Zn[Gn];Gn++,Sr(e),ib(e.$$)}}catch(e){throw Zn.length=0,Gn=0,e}for(Sr(null),Zn.length=0,Gn=0;Bt.length;)Bt.pop()();for(let e=0;e<us.length;e+=1){const i=us[e];Zl.has(i)||(Zl.add(i),i())}us.length=0}while(Zn.length);for(;Uc.length;)Uc.pop()();Hc=!1,Zl.clear(),Sr(t)}function ib(t){if(t.fragment!==null){t.update(),ki(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ei)}}function nb(t){const e=[],i=[];us.forEach(n=>t.indexOf(n)===-1?e.push(n):i.push(n)),i.forEach(n=>n()),us=e}let ur;function sb(){return ur||(ur=Promise.resolve(),ur.then(()=>{ur=null})),ur}function ec(t,e,i){t.dispatchEvent(op(`${e?"intro":"outro"}${i}`))}const Zo=new Set;let Ri;function An(){Ri={r:0,c:[],p:Ri}}function Pn(){Ri.r||ki(Ri.c),Ri=Ri.p}function W(t,e){t&&t.i&&(Zo.delete(t),t.i(e))}function Z(t,e,i,n){if(t&&t.o){if(Zo.has(t))return;Zo.add(t),Ri.c.push(()=>{Zo.delete(t),n&&(i&&t.d(1),n())}),t.o(e)}else n&&n()}const rb={duration:0};function sn(t,e,i,n){const s={direction:"both"};let r=e(t,i,s),o=n?0:1,a=null,l=null,u=null;function c(){u&&Q0(t,u)}function h(f,p){const T=f.b-o;return p*=Math.abs(T),{a:o,b:f.b,d:T,duration:p,start:f.start,end:f.start+p,group:f.group}}function d(f){const{delay:p=0,duration:T=300,easing:v=Ru,tick:S=Ee,css:O}=r||rb,I={start:ip()+p,b:f};f||(I.group=Ri,Ri.r+=1),a||l?l=I:(O&&(c(),u=bd(t,o,f,T,p,v,O)),f&&S(0,1),a=h(I,T),ei(()=>ec(t,f,"start")),sp(V=>{if(l&&V>l.start&&(a=h(l,T),l=null,ec(t,a.b,"start"),O&&(c(),u=bd(t,o,a.b,a.duration,0,v,r.css))),a){if(V>=a.end)S(o=a.b,1-o),ec(t,a.b,"end"),l||(a.b?c():--a.group.r||ki(a.group.c)),a=null;else if(V>=a.start){const G=V-a.start;o=a.a+a.d*v(G/a.duration),S(o,1-o)}}return!!(a||l)}))}return{run(f){xu(r)?sb().then(()=>{r=r(s),d(f)}):d(f)},end(){c(),a=l=null}}}function kd(t,e,i){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=i,i(t.$$.ctx[n]))}function Re(t){t&&t.c()}function Ae(t,e,i,n){const{fragment:s,after_update:r}=t.$$;s&&s.m(e,i),n||ei(()=>{const o=t.$$.on_mount.map(Xm).filter(xu);t.$$.on_destroy?t.$$.on_destroy.push(...o):ki(o),t.$$.on_mount=[]}),r.forEach(ei)}function Pe(t,e){const i=t.$$;i.fragment!==null&&(nb(i.after_update),ki(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function ob(t,e){t.$$.dirty[0]===-1&&(Zn.push(t),tb(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function rt(t,e,i,n,s,r,o,a=[-1]){const l=Vr;Sr(t);const u=t.$$={fragment:null,ctx:[],props:r,update:Ee,not_equal:s,bound:pd(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:pd(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(u.root);let c=!1;if(u.ctx=i?i(t,e.props||{},(h,d,...f)=>{const p=f.length?f[0]:d;return u.ctx&&s(u.ctx[h],u.ctx[h]=p)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](p),c&&ob(t,h)),d}):[],u.update(),c=!0,ki(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const h=W0(e.target);u.fragment&&u.fragment.l(h),h.forEach(j)}else u.fragment&&u.fragment.c();e.intro&&W(t.$$.fragment),Ae(t,e.target,e.anchor,e.customElement),ap()}Sr(l)}class ot{$destroy(){Pe(this,1),this.$destroy=Ee}$on(e,i){if(!xu(i))return Ee;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(i),()=>{const s=n.indexOf(i);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!z0(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lp=function(t){const e=[];let i=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[i++]=s:s<2048?(e[i++]=s>>6|192,e[i++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[i++]=s>>18|240,e[i++]=s>>12&63|128,e[i++]=s>>6&63|128,e[i++]=s&63|128):(e[i++]=s>>12|224,e[i++]=s>>6&63|128,e[i++]=s&63|128)}return e},ab=function(t){const e=[];let i=0,n=0;for(;i<t.length;){const s=t[i++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const r=t[i++];e[n++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=t[i++],o=t[i++],a=t[i++],l=((s&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const r=t[i++],o=t[i++];e[n++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return e.join("")},cp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const i=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const r=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,u=l?t[s+2]:0,c=r>>2,h=(r&3)<<4|a>>4;let d=(a&15)<<2|u>>6,f=u&63;l||(f=64,o||(d=64)),n.push(i[c],i[h],i[d],i[f])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(lp(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ab(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const i=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const r=i[t.charAt(s++)],a=s<t.length?i[t.charAt(s)]:0;++s;const u=s<t.length?i[t.charAt(s)]:64;++s;const h=s<t.length?i[t.charAt(s)]:64;if(++s,r==null||a==null||u==null||h==null)throw new lb;const d=r<<2|a>>4;if(n.push(d),u!==64){const f=a<<4&240|u>>2;if(n.push(f),h!==64){const p=u<<6&192|h;n.push(p)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class lb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const cb=function(t){const e=lp(t);return cp.encodeByteArray(e,!0)},da=function(t){return cb(t).replace(/\./g,"")},up=function(t){try{return cp.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ub(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb=()=>ub().__FIREBASE_DEFAULTS__,db=()=>{typeof process=="undefined"||process.env},fb=()=>{if(typeof document=="undefined")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&up(t[1]);return e&&JSON.parse(e)},Lu=()=>{try{return hb()||db()||fb()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},hp=t=>{var e,i;return(i=(e=Lu())===null||e===void 0?void 0:e.emulatorHosts)===null||i===void 0?void 0:i[t]},dp=t=>{const e=hp(t);if(!e)return;const i=e.lastIndexOf(":");if(i<=0||i+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(i+1),10);return e[0]==="["?[e.substring(1,i-1),n]:[e.substring(0,i),n]},fp=()=>{var t;return(t=Lu())===null||t===void 0?void 0:t.config},mp=t=>{var e;return(e=Lu())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,i)=>{this.resolve=e,this.reject=i})}wrapCallback(e){return(i,n)=>{i?this.reject(i):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(i):e(i,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[da(JSON.stringify(i)),da(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function pb(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(kt())}function gb(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function vb(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yb(){const t=kt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function bb(){try{return typeof indexedDB=="object"}catch{return!1}}function wb(){return new Promise((t,e)=>{try{let i=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),i||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{i=!1},s.onerror=()=>{var r;e(((r=s.error)===null||r===void 0?void 0:r.message)||"")}}catch(i){e(i)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb="FirebaseError";class Ti extends Error{constructor(e,i,n){super(i),this.code=e,this.customData=n,this.name=kb,Object.setPrototypeOf(this,Ti.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ro.prototype.create)}}class ro{constructor(e,i,n){this.service=e,this.serviceName=i,this.errors=n}create(e,...i){const n=i[0]||{},s=`${this.service}/${e}`,r=this.errors[e],o=r?Tb(r,n):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Ti(s,a,n)}}function Tb(t,e){return t.replace(_b,(i,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const _b=/\{\$([^}]+)}/g;function Cb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function fa(t,e){if(t===e)return!0;const i=Object.keys(t),n=Object.keys(e);for(const s of i){if(!n.includes(s))return!1;const r=t[s],o=e[s];if(Td(r)&&Td(o)){if(!fa(r,o))return!1}else if(r!==o)return!1}for(const s of n)if(!i.includes(s))return!1;return!0}function Td(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oo(t){const e=[];for(const[i,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(i)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(i)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function yr(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,r]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(r)}}),e}function br(t){const e=t.indexOf("?");if(!e)return"";const i=t.indexOf("#",e);return t.substring(e,i>0?i:void 0)}function Eb(t,e){const i=new Sb(t,e);return i.subscribe.bind(i)}class Sb{constructor(e,i){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=i,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(i=>{i.next(e)})}error(e){this.forEachObserver(i=>{i.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,i,n){let s;if(e===void 0&&i===void 0&&n===void 0)throw new Error("Missing Observer.");Ib(e,["next","error","complete"])?s=e:s={next:e,error:i,complete:n},s.next===void 0&&(s.next=tc),s.error===void 0&&(s.error=tc),s.complete===void 0&&(s.complete=tc);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let i=0;i<this.observers.length;i++)this.sendOne(i,e)}sendOne(e,i){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{i(this.observers[e])}catch(n){typeof console!="undefined"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ib(t,e){if(typeof t!="object"||t===null)return!1;for(const i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}function tc(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(t){return t&&t._delegate?t._delegate:t}class rn{constructor(e,i,n){this.name=e,this.instanceFactory=i,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e,i){this.name=e,this.container=i,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const i=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(i)){const n=new mb;if(this.instancesDeferred.set(i,n),this.isInitialized(i)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:i});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(i).promise}getImmediate(e){var i;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(i=e==null?void 0:e.optional)!==null&&i!==void 0?i:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Rb(e))try{this.getOrInitializeService({instanceIdentifier:kn})}catch{}for(const[i,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(i);try{const r=this.getOrInitializeService({instanceIdentifier:s});n.resolve(r)}catch{}}}}clearInstance(e=kn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...e.filter(i=>"_delete"in i).map(i=>i._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=kn){return this.instances.has(e)}getOptions(e=kn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:i={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:i});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);n===a&&o.resolve(s)}return s}onInit(e,i){var n;const s=this.normalizeInstanceIdentifier(i),r=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;r.add(e),this.onInitCallbacks.set(s,r);const o=this.instances.get(s);return o&&e(o,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,i){const n=this.onInitCallbacks.get(i);if(!!n)for(const s of n)try{s(e,i)}catch{}}getOrInitializeService({instanceIdentifier:e,options:i={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Pb(e),options:i}),this.instances.set(e,n),this.instancesOptions.set(e,i),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=kn){return this.component?this.component.multipleInstances?e:kn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Pb(t){return t===kn?void 0:t}function Rb(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const i=this.getProvider(e.name);if(i.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);i.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const i=new Ab(e,this);return this.providers.set(e,i),i}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(fe||(fe={}));const Db={debug:fe.DEBUG,verbose:fe.VERBOSE,info:fe.INFO,warn:fe.WARN,error:fe.ERROR,silent:fe.SILENT},Mb=fe.INFO,Lb={[fe.DEBUG]:"log",[fe.VERBOSE]:"log",[fe.INFO]:"info",[fe.WARN]:"warn",[fe.ERROR]:"error"},Nb=(t,e,...i)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=Lb[e];if(s)console[s](`[${n}]  ${t.name}:`,...i);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Nu{constructor(e){this.name=e,this._logLevel=Mb,this._logHandler=Nb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Db[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,fe.DEBUG,...e),this._logHandler(this,fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,fe.VERBOSE,...e),this._logHandler(this,fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,fe.INFO,...e),this._logHandler(this,fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,fe.WARN,...e),this._logHandler(this,fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,fe.ERROR,...e),this._logHandler(this,fe.ERROR,...e)}}const Ob=(t,e)=>e.some(i=>t instanceof i);let _d,Cd;function Vb(){return _d||(_d=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Fb(){return Cd||(Cd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gp=new WeakMap,Bc=new WeakMap,vp=new WeakMap,ic=new WeakMap,Ou=new WeakMap;function Ub(t){const e=new Promise((i,n)=>{const s=()=>{t.removeEventListener("success",r),t.removeEventListener("error",o)},r=()=>{i(en(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",r),t.addEventListener("error",o)});return e.then(i=>{i instanceof IDBCursor&&gp.set(i,t)}).catch(()=>{}),Ou.set(e,t),e}function Hb(t){if(Bc.has(t))return;const e=new Promise((i,n)=>{const s=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",o),t.removeEventListener("abort",o)},r=()=>{i(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",r),t.addEventListener("error",o),t.addEventListener("abort",o)});Bc.set(t,e)}let $c={get(t,e,i){if(t instanceof IDBTransaction){if(e==="done")return Bc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||vp.get(t);if(e==="store")return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return en(t[e])},set(t,e,i){return t[e]=i,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Bb(t){$c=t($c)}function $b(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...i){const n=t.call(nc(this),e,...i);return vp.set(n,e.sort?e.sort():[e]),en(n)}:Fb().includes(t)?function(...e){return t.apply(nc(this),e),en(gp.get(this))}:function(...e){return en(t.apply(nc(this),e))}}function zb(t){return typeof t=="function"?$b(t):(t instanceof IDBTransaction&&Hb(t),Ob(t,Vb())?new Proxy(t,$c):t)}function en(t){if(t instanceof IDBRequest)return Ub(t);if(ic.has(t))return ic.get(t);const e=zb(t);return e!==t&&(ic.set(t,e),Ou.set(e,t)),e}const nc=t=>Ou.get(t);function jb(t,e,{blocked:i,upgrade:n,blocking:s,terminated:r}={}){const o=indexedDB.open(t,e),a=en(o);return n&&o.addEventListener("upgradeneeded",l=>{n(en(o.result),l.oldVersion,l.newVersion,en(o.transaction),l)}),i&&o.addEventListener("blocked",l=>i(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const qb=["get","getKey","getAll","getAllKeys","count"],Wb=["put","add","delete","clear"],sc=new Map;function Ed(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(sc.get(e))return sc.get(e);const i=e.replace(/FromIndex$/,""),n=e!==i,s=Wb.includes(i);if(!(i in(n?IDBIndex:IDBObjectStore).prototype)||!(s||qb.includes(i)))return;const r=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(a.shift())),(await Promise.all([u[i](...a),s&&l.done]))[0]};return sc.set(e,r),r}Bb(t=>({...t,get:(e,i,n)=>Ed(e,i)||t.get(e,i,n),has:(e,i)=>!!Ed(e,i)||t.has(e,i)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(i=>{if(Gb(i)){const n=i.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(i=>i).join(" ")}}function Gb(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const zc="@firebase/app",Sd="0.9.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new Nu("@firebase/app"),Qb="@firebase/app-compat",Yb="@firebase/analytics-compat",Jb="@firebase/analytics",Xb="@firebase/app-check-compat",Zb="@firebase/app-check",ew="@firebase/auth",tw="@firebase/auth-compat",iw="@firebase/database",nw="@firebase/database-compat",sw="@firebase/functions",rw="@firebase/functions-compat",ow="@firebase/installations",aw="@firebase/installations-compat",lw="@firebase/messaging",cw="@firebase/messaging-compat",uw="@firebase/performance",hw="@firebase/performance-compat",dw="@firebase/remote-config",fw="@firebase/remote-config-compat",mw="@firebase/storage",pw="@firebase/storage-compat",gw="@firebase/firestore",vw="@firebase/firestore-compat",yw="firebase",bw="9.23.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jc="[DEFAULT]",ww={[zc]:"fire-core",[Qb]:"fire-core-compat",[Jb]:"fire-analytics",[Yb]:"fire-analytics-compat",[Zb]:"fire-app-check",[Xb]:"fire-app-check-compat",[ew]:"fire-auth",[tw]:"fire-auth-compat",[iw]:"fire-rtdb",[nw]:"fire-rtdb-compat",[sw]:"fire-fn",[rw]:"fire-fn-compat",[ow]:"fire-iid",[aw]:"fire-iid-compat",[lw]:"fire-fcm",[cw]:"fire-fcm-compat",[uw]:"fire-perf",[hw]:"fire-perf-compat",[dw]:"fire-rc",[fw]:"fire-rc-compat",[mw]:"fire-gcs",[pw]:"fire-gcs-compat",[gw]:"fire-fst",[vw]:"fire-fst-compat","fire-js":"fire-js",[yw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ma=new Map,qc=new Map;function kw(t,e){try{t.container.addComponent(e)}catch(i){Rn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,i)}}function xn(t){const e=t.name;if(qc.has(e))return Rn.debug(`There were multiple attempts to register component ${e}.`),!1;qc.set(e,t);for(const i of ma.values())kw(i,t);return!0}function Ya(t,e){const i=t.container.getProvider("heartbeat").getImmediate({optional:!0});return i&&i.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tw={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},tn=new ro("app","Firebase",Tw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(e,i,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},i),this._name=i.name,this._automaticDataCollectionEnabled=i.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new rn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw tn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn=bw;function yp(t,e={}){let i=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:jc,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw tn.create("bad-app-name",{appName:String(s)});if(i||(i=fp()),!i)throw tn.create("no-options");const r=ma.get(s);if(r){if(fa(i,r.options)&&fa(n,r.config))return r;throw tn.create("duplicate-app",{appName:s})}const o=new xb(s);for(const l of qc.values())o.addComponent(l);const a=new _w(i,n,o);return ma.set(s,a),a}function Vu(t=jc){const e=ma.get(t);if(!e&&t===jc&&fp())return yp();if(!e)throw tn.create("no-app",{appName:t});return e}function mi(t,e,i){var n;let s=(n=ww[t])!==null&&n!==void 0?n:t;i&&(s+=`-${i}`);const r=s.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${s}" with version "${e}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Rn.warn(a.join(" "));return}xn(new rn(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cw="firebase-heartbeat-database",Ew=1,Fr="firebase-heartbeat-store";let rc=null;function bp(){return rc||(rc=jb(Cw,Ew,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Fr)}}}).catch(t=>{throw tn.create("idb-open",{originalErrorMessage:t.message})})),rc}async function Sw(t){try{return await(await bp()).transaction(Fr).objectStore(Fr).get(wp(t))}catch(e){if(e instanceof Ti)Rn.warn(e.message);else{const i=tn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Rn.warn(i.message)}}}async function Id(t,e){try{const n=(await bp()).transaction(Fr,"readwrite");await n.objectStore(Fr).put(e,wp(t)),await n.done}catch(i){if(i instanceof Ti)Rn.warn(i.message);else{const n=tn.create("idb-set",{originalErrorMessage:i==null?void 0:i.message});Rn.warn(n.message)}}}function wp(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw=1024,Aw=30*24*60*60*1e3;class Pw{constructor(e){this.container=e,this._heartbeatsCache=null;const i=this.container.getProvider("app").getImmediate();this._storage=new xw(i),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Ad();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n)))return this._heartbeatsCache.heartbeats.push({date:n,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const r=new Date(s.date).valueOf();return Date.now()-r<=Aw}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ad(),{heartbeatsToSend:i,unsentEntries:n}=Rw(this._heartbeatsCache.heartbeats),s=da(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Ad(){return new Date().toISOString().substring(0,10)}function Rw(t,e=Iw){const i=[];let n=t.slice();for(const s of t){const r=i.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),Pd(i)>e){r.dates.pop();break}}else if(i.push({agent:s.agent,dates:[s.date]}),Pd(i)>e){i.pop();break}n=n.slice(1)}return{heartbeatsToSend:i,unsentEntries:n}}class xw{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bb()?wb().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Sw(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var i;if(await this._canUseIndexedDBPromise){const s=await this.read();return Id(this.app,{lastSentHeartbeatDate:(i=e.lastSentHeartbeatDate)!==null&&i!==void 0?i:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var i;if(await this._canUseIndexedDBPromise){const s=await this.read();return Id(this.app,{lastSentHeartbeatDate:(i=e.lastSentHeartbeatDate)!==null&&i!==void 0?i:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Pd(t){return da(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dw(t){xn(new rn("platform-logger",e=>new Kb(e),"PRIVATE")),xn(new rn("heartbeat",e=>new Pw(e),"PRIVATE")),mi(zc,Sd,t),mi(zc,Sd,"esm2017"),mi("fire-js","")}Dw("");function Fu(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(i[n[s]]=t[n[s]]);return i}function kp(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Mw=kp,Tp=new ro("auth","Firebase",kp());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=new Nu("@firebase/auth");function Lw(t,...e){pa.logLevel<=fe.WARN&&pa.warn(`Auth (${Hn}): ${t}`,...e)}function ea(t,...e){pa.logLevel<=fe.ERROR&&pa.error(`Auth (${Hn}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(t,...e){throw Uu(t,...e)}function pi(t,...e){return Uu(t,...e)}function Nw(t,e,i){const n=Object.assign(Object.assign({},Mw()),{[e]:i});return new ro("auth","Firebase",n).create(e,{appName:t.name})}function Uu(t,...e){if(typeof t!="string"){const i=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(i,...n)}return Tp.create(t,...e)}function ee(t,e,...i){if(!t)throw Uu(e,...i)}function xi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ea(e),new Error(e)}function Oi(t,e){t||xi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wc(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Ow(){return Rd()==="http:"||Rd()==="https:"}function Rd(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vw(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ow()||gb()||"connection"in navigator)?navigator.onLine:!0}function Fw(){if(typeof navigator=="undefined")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,i){this.shortDelay=e,this.longDelay=i,Oi(i>e,"Short delay should be less than long delay!"),this.isMobile=pb()||vb()}get(){return Vw()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t,e){Oi(t.emulator,"Emulator should always be set here");const{url:i}=t.emulator;return e?`${i}${e.startsWith("/")?e.slice(1):e}`:i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{static initialize(e,i,n){this.fetchImpl=e,i&&(this.headersImpl=i),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;xi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;xi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;xi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw=new ao(3e4,6e4);function Rs(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function xs(t,e,i,n,s={}){return Cp(t,s,async()=>{let r={},o={};n&&(e==="GET"?o=n:r={body:JSON.stringify(n)});const a=oo(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),_p.fetch()(Ep(t,t.config.apiHost,i,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},r))})}async function Cp(t,e,i){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Uw),e);try{const s=new Bw(t),r=await Promise.race([i(),s.promise]);s.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw Fo(t,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Fo(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Fo(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Fo(t,"user-disabled",o);const c=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Nw(t,c,u);ii(t,c)}}catch(s){if(s instanceof Ti)throw s;ii(t,"network-request-failed",{message:String(s)})}}async function lo(t,e,i,n,s={}){const r=await xs(t,e,i,n,s);return"mfaPendingCredential"in r&&ii(t,"multi-factor-auth-required",{_serverResponse:r}),r}function Ep(t,e,i,n){const s=`${e}${i}?${n}`;return t.config.emulator?Hu(t.config,s):`${t.config.apiScheme}://${s}`}class Bw{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((i,n)=>{this.timer=setTimeout(()=>n(pi(this.auth,"network-request-failed")),Hw.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Fo(t,e,i){const n={appName:t.name};i.email&&(n.email=i.email),i.phoneNumber&&(n.phoneNumber=i.phoneNumber);const s=pi(t,e,n);return s.customData._tokenResponse=i,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $w(t,e){return xs(t,"POST","/v1/accounts:delete",e)}async function zw(t,e){return xs(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(t){if(!!t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function jw(t,e=!1){const i=Ue(t),n=await i.getIdToken(e),s=Bu(n);ee(s&&s.exp&&s.auth_time&&s.iat,i.auth,"internal-error");const r=typeof s.firebase=="object"?s.firebase:void 0,o=r==null?void 0:r.sign_in_provider;return{claims:s,token:n,authTime:Ir(oc(s.auth_time)),issuedAtTime:Ir(oc(s.iat)),expirationTime:Ir(oc(s.exp)),signInProvider:o||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function oc(t){return Number(t)*1e3}function Bu(t){const[e,i,n]=t.split(".");if(e===void 0||i===void 0||n===void 0)return ea("JWT malformed, contained fewer than 3 sections"),null;try{const s=up(i);return s?JSON.parse(s):(ea("Failed to decode base64 JWT payload"),null)}catch(s){return ea("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function qw(t){const e=Bu(t);return ee(e,"internal-error"),ee(typeof e.exp!="undefined","internal-error"),ee(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ur(t,e,i=!1){if(i)return e;try{return await e}catch(n){throw n instanceof Ti&&Ww(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Ww({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var i;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((i=this.user.stsTokenManager.expirationTime)!==null&&i!==void 0?i:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const i=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},i)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,i){this.createdAt=e,this.lastLoginAt=i,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ir(this.lastLoginAt),this.creationTime=Ir(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ga(t){var e;const i=t.auth,n=await t.getIdToken(),s=await Ur(t,zw(i,{idToken:n}));ee(s==null?void 0:s.users.length,i,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const o=!((e=r.providerUserInfo)===null||e===void 0)&&e.length?Yw(r.providerUserInfo):[],a=Qw(t.providerData,o),l=t.isAnonymous,u=!(t.email&&r.passwordHash)&&!(a!=null&&a.length),c=l?u:!1,h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Sp(r.createdAt,r.lastLoginAt),isAnonymous:c};Object.assign(t,h)}async function Gw(t){const e=Ue(t);await ga(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Qw(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function Yw(t){return t.map(e=>{var{providerId:i}=e,n=Fu(e,["providerId"]);return{providerId:i,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jw(t,e){const i=await Cp(t,{},async()=>{const n=oo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:r}=t.config,o=Ep(t,s,"/v1/token",`key=${r}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",_p.fetch()(o,{method:"POST",headers:a,body:n})});return{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ee(e.idToken,"internal-error"),ee(typeof e.idToken!="undefined","internal-error"),ee(typeof e.refreshToken!="undefined","internal-error");const i="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):qw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,i)}async getToken(e,i=!1){return ee(!this.accessToken||this.refreshToken,e,"user-token-expired"),!i&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,i){const{accessToken:n,refreshToken:s,expiresIn:r}=await Jw(e,i);this.updateTokensAndExpiration(n,s,Number(r))}updateTokensAndExpiration(e,i,n){this.refreshToken=i||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,i){const{refreshToken:n,accessToken:s,expirationTime:r}=i,o=new Hr;return n&&(ee(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(ee(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),r&&(ee(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Hr,this.toJSON())}_performRefresh(){return xi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(t,e){ee(typeof t=="string"||typeof t=="undefined","internal-error",{appName:e})}class Sn{constructor(e){var{uid:i,auth:n,stsTokenManager:s}=e,r=Fu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Kw(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=i,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Sp(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const i=await Ur(this,this.stsTokenManager.getToken(this.auth,e));return ee(i,this.auth,"internal-error"),this.accessToken!==i&&(this.accessToken=i,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),i}getIdTokenResult(e){return jw(this,e)}reload(){return Gw(this)}_assign(e){this!==e&&(ee(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(i=>Object.assign({},i)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const i=new Sn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return i.metadata._copy(this.metadata),i}_onReload(e){ee(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,i=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),i&&await ga(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Ur(this,$w(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,i){var n,s,r,o,a,l,u,c;const h=(n=i.displayName)!==null&&n!==void 0?n:void 0,d=(s=i.email)!==null&&s!==void 0?s:void 0,f=(r=i.phoneNumber)!==null&&r!==void 0?r:void 0,p=(o=i.photoURL)!==null&&o!==void 0?o:void 0,T=(a=i.tenantId)!==null&&a!==void 0?a:void 0,v=(l=i._redirectEventId)!==null&&l!==void 0?l:void 0,S=(u=i.createdAt)!==null&&u!==void 0?u:void 0,O=(c=i.lastLoginAt)!==null&&c!==void 0?c:void 0,{uid:I,emailVerified:V,isAnonymous:G,providerData:P,stsTokenManager:ue}=i;ee(I&&ue,e,"internal-error");const oe=Hr.fromJSON(this.name,ue);ee(typeof I=="string",e,"internal-error"),Gi(h,e.name),Gi(d,e.name),ee(typeof V=="boolean",e,"internal-error"),ee(typeof G=="boolean",e,"internal-error"),Gi(f,e.name),Gi(p,e.name),Gi(T,e.name),Gi(v,e.name),Gi(S,e.name),Gi(O,e.name);const D=new Sn({uid:I,auth:e,email:d,emailVerified:V,displayName:h,isAnonymous:G,photoURL:p,phoneNumber:f,tenantId:T,stsTokenManager:oe,createdAt:S,lastLoginAt:O});return P&&Array.isArray(P)&&(D.providerData=P.map(ve=>Object.assign({},ve))),v&&(D._redirectEventId=v),D}static async _fromIdTokenResponse(e,i,n=!1){const s=new Hr;s.updateFromServerResponse(i);const r=new Sn({uid:i.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await ga(r),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd=new Map;function Di(t){Oi(t instanceof Function,"Expected a class definition");let e=xd.get(t);return e?(Oi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,xd.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,i){this.storage[e]=i}async _get(e){const i=this.storage[e];return i===void 0?null:i}async _remove(e){delete this.storage[e]}_addListener(e,i){}_removeListener(e,i){}}Ip.type="NONE";const Dd=Ip;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ta(t,e,i){return`firebase:${t}:${e}:${i}`}class hs{constructor(e,i,n){this.persistence=e,this.auth=i,this.userKey=n;const{config:s,name:r}=this.auth;this.fullUserKey=ta(this.userKey,s.apiKey,r),this.fullPersistenceKey=ta("persistence",s.apiKey,r),this.boundEventHandler=i._onStorageEvent.bind(i),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Sn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const i=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,i)return this.setCurrentUser(i)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,i,n="authUser"){if(!i.length)return new hs(Di(Dd),e,n);const s=(await Promise.all(i.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let r=s[0]||Di(Dd);const o=ta(n,e.config.apiKey,e.name);let a=null;for(const u of i)try{const c=await u._get(o);if(c){const h=Sn._fromJSON(e,c);u!==r&&(a=h),r=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new hs(r,e,n):(r=l[0],a&&await r._set(o,a.toJSON()),await Promise.all(i.map(async u=>{if(u!==r)try{await u._remove(o)}catch{}})),new hs(r,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Md(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Rp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ap(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Dp(e))return"Blackberry";if(Mp(e))return"Webos";if($u(e))return"Safari";if((e.includes("chrome/")||Pp(e))&&!e.includes("edge/"))return"Chrome";if(xp(e))return"Android";{const i=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(i);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Ap(t=kt()){return/firefox\//i.test(t)}function $u(t=kt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Pp(t=kt()){return/crios\//i.test(t)}function Rp(t=kt()){return/iemobile/i.test(t)}function xp(t=kt()){return/android/i.test(t)}function Dp(t=kt()){return/blackberry/i.test(t)}function Mp(t=kt()){return/webos/i.test(t)}function Ja(t=kt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Xw(t=kt()){var e;return Ja(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Zw(){return yb()&&document.documentMode===10}function Lp(t=kt()){return Ja(t)||xp(t)||Mp(t)||Dp(t)||/windows phone/i.test(t)||Rp(t)}function ek(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Np(t,e=[]){let i;switch(t){case"Browser":i=Md(kt());break;case"Worker":i=`${Md(kt())}-${t}`;break;default:i=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${i}/JsCore/${Hn}/${n}`}async function Op(t,e){return xs(t,"GET","/v2/recaptchaConfig",Rs(t,e))}function Ld(t){return t!==void 0&&t.enterprise!==void 0}class Vp{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(i=>i.provider==="EMAIL_PASSWORD_PROVIDER"&&i.enforcementState!=="OFF")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tk(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function Fp(t){return new Promise((e,i)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const r=pi("internal-error");r.customData=s,i(r)},n.type="text/javascript",n.charset="UTF-8",tk().appendChild(n)})}function ik(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const nk="https://www.google.com/recaptcha/enterprise.js?render=",sk="recaptcha-enterprise",rk="NO_RECAPTCHA";class Up{constructor(e){this.type=sk,this.auth=Ds(e)}async verify(e="verify",i=!1){async function n(r){if(!i){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(o,a)=>{Op(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new Vp(l);return r.tenantId==null?r._agentRecaptchaConfig=u:r._tenantRecaptchaConfigs[r.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function s(r,o,a){const l=window.grecaptcha;Ld(l)?l.enterprise.ready(()=>{l.enterprise.execute(r,{action:e}).then(u=>{o(u)}).catch(()=>{o(rk)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((r,o)=>{n(this.auth).then(a=>{if(!i&&Ld(window.grecaptcha))s(a,r,o);else{if(typeof window=="undefined"){o(new Error("RecaptchaVerifier is only supported in browser"));return}Fp(nk+a).then(()=>{s(a,r,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})}}async function va(t,e,i,n=!1){const s=new Up(t);let r;try{r=await s.verify(i)}catch{r=await s.verify(i,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:r}):Object.assign(o,{captchaResponse:r}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,i){const n=r=>new Promise((o,a)=>{try{const l=e(r);o(l)}catch(l){a(l)}});n.onAbort=i,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const i=[];try{for(const n of this.queue)await n(e),n.onAbort&&i.push(n.onAbort)}catch(n){i.reverse();for(const s of i)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,i,n,s){this.app=e,this.heartbeatServiceProvider=i,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Nd(this),this.idTokenSubscription=new Nd(this),this.beforeStateQueue=new ok(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Tp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,i){return i&&(this._popupRedirectResolver=Di(i)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await hs.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(i),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var i;const n=await this.assertedPersistence.getCurrentUser();let s=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l==null?void 0:l.user)&&(s=l.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ee(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let i=null;try{i=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return i}async reloadAndSetCurrentUserOrClear(e){try{await ga(e)}catch(i){if((i==null?void 0:i.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Fw()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const i=e?Ue(e):null;return i&&ee(i.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(i&&i._clone(this))}async _updateCurrentUser(e,i=!1){if(!this._deleted)return e&&ee(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),i||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Di(e))})}async initializeRecaptchaConfig(){const e=await Op(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),i=new Vp(e);this.tenantId==null?this._agentRecaptchaConfig=i:this._tenantRecaptchaConfigs[this.tenantId]=i,i.emailPasswordEnabled&&new Up(this).verify()}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ro("auth","Firebase",e())}onAuthStateChanged(e,i,n){return this.registerStateListener(this.authStateSubscription,e,i,n)}beforeAuthStateChanged(e,i){return this.beforeStateQueue.pushCallback(e,i)}onIdTokenChanged(e,i,n){return this.registerStateListener(this.idTokenSubscription,e,i,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,i){const n=await this.getOrInitRedirectPersistenceManager(i);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const i=e&&Di(e)||this._popupRedirectResolver;ee(i,this,"argument-error"),this.redirectPersistenceManager=await hs.create(this,[Di(i._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var i,n;return this._isInitialized&&await this.queue(async()=>{}),((i=this._currentUser)===null||i===void 0?void 0:i._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,i;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(i=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&i!==void 0?i:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,i,n,s){if(this._deleted)return()=>{};const r=typeof i=="function"?i:i.next.bind(i),o=this._isInitialized?Promise.resolve():this._initializationPromise;return ee(o,this,"internal-error"),o.then(()=>r(this.currentUser)),typeof i=="function"?e.addObserver(i,n,s):e.addObserver(i)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ee(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Np(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const i={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(i["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(i["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(i["X-Firebase-AppCheck"]=s),i}async _getAppCheckToken(){var e;const i=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return i!=null&&i.error&&Lw(`Error while retrieving App Check token: ${i.error}`),i==null?void 0:i.token}}function Ds(t){return Ue(t)}class Nd{constructor(e){this.auth=e,this.observer=null,this.addObserver=Eb(i=>this.observer=i)}get next(){return ee(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lk(t,e){const i=Ya(t,"auth");if(i.isInitialized()){const s=i.getImmediate(),r=i.getOptions();if(fa(r,e!=null?e:{}))return s;ii(s,"already-initialized")}return i.initialize({options:e})}function ck(t,e){const i=(e==null?void 0:e.persistence)||[],n=(Array.isArray(i)?i:[i]).map(Di);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function uk(t,e,i){const n=Ds(t);ee(n._canInitEmulator,n,"emulator-config-failed"),ee(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!!(i!=null&&i.disableWarnings),r=Hp(e),{host:o,port:a}=hk(e),l=a===null?"":`:${a}`;n.config.emulator={url:`${r}//${o}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||dk()}function Hp(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function hk(t){const e=Hp(t),i=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!i)return{host:"",port:null};const n=i[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const r=s[1];return{host:r,port:Od(n.substr(r.length+1))}}else{const[r,o]=n.split(":");return{host:r,port:Od(o)}}}function Od(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function dk(){function t(){const e=document.createElement("p"),i=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",i.position="fixed",i.width="100%",i.backgroundColor="#ffffff",i.border=".1em solid #000000",i.color="#b50000",i.bottom="0px",i.left="0px",i.margin="0px",i.zIndex="10000",i.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console!="undefined"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window!="undefined"&&typeof document!="undefined"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,i){this.providerId=e,this.signInMethod=i}toJSON(){return xi("not implemented")}_getIdTokenResponse(e){return xi("not implemented")}_linkToIdToken(e,i){return xi("not implemented")}_getReauthenticationResolver(e){return xi("not implemented")}}async function fk(t,e){return xs(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ac(t,e){return lo(t,"POST","/v1/accounts:signInWithPassword",Rs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mk(t,e){return lo(t,"POST","/v1/accounts:signInWithEmailLink",Rs(t,e))}async function pk(t,e){return lo(t,"POST","/v1/accounts:signInWithEmailLink",Rs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br extends zu{constructor(e,i,n,s=null){super("password",n),this._email=e,this._password=i,this._tenantId=s}static _fromEmailAndPassword(e,i){return new Br(e,i,"password")}static _fromEmailAndCode(e,i,n=null){return new Br(e,i,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const i=typeof e=="string"?JSON.parse(e):e;if((i==null?void 0:i.email)&&(i==null?void 0:i.password)){if(i.signInMethod==="password")return this._fromEmailAndPassword(i.email,i.password);if(i.signInMethod==="emailLink")return this._fromEmailAndCode(i.email,i.password,i.tenantId)}return null}async _getIdTokenResponse(e){var i;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(!((i=e._getRecaptchaConfig())===null||i===void 0)&&i.emailPasswordEnabled){const s=await va(e,n,"signInWithPassword");return ac(e,s)}else return ac(e,n).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const r=await va(e,n,"signInWithPassword");return ac(e,r)}else return Promise.reject(s)});case"emailLink":return mk(e,{email:this._email,oobCode:this._password});default:ii(e,"internal-error")}}async _linkToIdToken(e,i){switch(this.signInMethod){case"password":return fk(e,{idToken:i,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return pk(e,{idToken:i,email:this._email,oobCode:this._password});default:ii(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ds(t,e){return lo(t,"POST","/v1/accounts:signInWithIdp",Rs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk="http://localhost";class Dn extends zu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const i=new Dn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(i.idToken=e.idToken),e.accessToken&&(i.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(i.nonce=e.nonce),e.pendingToken&&(i.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(i.accessToken=e.oauthToken,i.secret=e.oauthTokenSecret):ii("argument-error"),i}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const i=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=i,r=Fu(i,["providerId","signInMethod"]);if(!n||!s)return null;const o=new Dn(n,s);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const i=this.buildRequest();return ds(e,i)}_linkToIdToken(e,i){const n=this.buildRequest();return n.idToken=i,ds(e,n)}_getReauthenticationResolver(e){const i=this.buildRequest();return i.autoCreate=!1,ds(e,i)}buildRequest(){const e={requestUri:gk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const i={};this.idToken&&(i.id_token=this.idToken),this.accessToken&&(i.access_token=this.accessToken),this.secret&&(i.oauth_token_secret=this.secret),i.providerId=this.providerId,this.nonce&&!this.pendingToken&&(i.nonce=this.nonce),e.postBody=oo(i)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function yk(t){const e=yr(br(t)).link,i=e?yr(br(e)).deep_link_id:null,n=yr(br(t)).deep_link_id;return(n?yr(br(n)).link:null)||n||i||e||t}class ju{constructor(e){var i,n,s,r,o,a;const l=yr(br(e)),u=(i=l.apiKey)!==null&&i!==void 0?i:null,c=(n=l.oobCode)!==null&&n!==void 0?n:null,h=vk((s=l.mode)!==null&&s!==void 0?s:null);ee(u&&c&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=c,this.continueUrl=(r=l.continueUrl)!==null&&r!==void 0?r:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const i=yk(e);try{return new ju(i)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(){this.providerId=Ms.PROVIDER_ID}static credential(e,i){return Br._fromEmailAndPassword(e,i)}static credentialWithLink(e,i){const n=ju.parseLink(i);return ee(n,"argument-error"),Br._fromEmailAndCode(e,n.code,n.tenantId)}}Ms.PROVIDER_ID="password";Ms.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ms.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co extends Bp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi extends co{constructor(){super("facebook.com")}static credential(e){return Dn._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi extends co{constructor(){super("google.com"),this.addScope("profile")}static credential(e,i){return Dn._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:i})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:i,oauthAccessToken:n}=e;if(!i&&!n)return null;try{return Yi.credential(i,n)}catch{return null}}}Yi.GOOGLE_SIGN_IN_METHOD="google.com";Yi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji extends co{constructor(){super("github.com")}static credential(e){return Dn._fromParams({providerId:Ji.PROVIDER_ID,signInMethod:Ji.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ji.credentialFromTaggedObject(e)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ji.credential(e.oauthAccessToken)}catch{return null}}}Ji.GITHUB_SIGN_IN_METHOD="github.com";Ji.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends co{constructor(){super("twitter.com")}static credential(e,i){return Dn._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:i})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:i,oauthTokenSecret:n}=e;if(!i||!n)return null;try{return Xi.credential(i,n)}catch{return null}}}Xi.TWITTER_SIGN_IN_METHOD="twitter.com";Xi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lc(t,e){return lo(t,"POST","/v1/accounts:signUp",Rs(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,i,n,s=!1){const r=await Sn._fromIdTokenResponse(e,n,s),o=Vd(n);return new Mn({user:r,providerId:o,_tokenResponse:n,operationType:i})}static async _forOperation(e,i,n){await e._updateTokensIfNecessary(n,!0);const s=Vd(n);return new Mn({user:e,providerId:s,_tokenResponse:n,operationType:i})}}function Vd(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends Ti{constructor(e,i,n,s){var r;super(i.code,i.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,ya.prototype),this.customData={appName:e.name,tenantId:(r=e.tenantId)!==null&&r!==void 0?r:void 0,_serverResponse:i.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,i,n,s){return new ya(e,i,n,s)}}function $p(t,e,i,n){return(e==="reauthenticate"?i._getReauthenticationResolver(t):i._getIdTokenResponse(t)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?ya._fromErrorAndOperation(t,r,e,n):r})}async function bk(t,e,i=!1){const n=await Ur(t,e._linkToIdToken(t.auth,await t.getIdToken()),i);return Mn._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wk(t,e,i=!1){const{auth:n}=t,s="reauthenticate";try{const r=await Ur(t,$p(n,s,e,t),i);ee(r.idToken,n,"internal-error");const o=Bu(r.idToken);ee(o,n,"internal-error");const{sub:a}=o;return ee(t.uid===a,n,"user-mismatch"),Mn._forOperation(t,s,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&ii(n,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zp(t,e,i=!1){const n="signIn",s=await $p(t,n,e),r=await Mn._fromIdTokenResponse(t,n,s);return i||await t._updateCurrentUser(r.user),r}async function kk(t,e){return zp(Ds(t),e)}async function Tk(t,e,i){var n;const s=Ds(t),r={returnSecureToken:!0,email:e,password:i,clientType:"CLIENT_TYPE_WEB"};let o;if(!((n=s._getRecaptchaConfig())===null||n===void 0)&&n.emailPasswordEnabled){const u=await va(s,r,"signUpPassword");o=lc(s,u)}else o=lc(s,r).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const c=await va(s,r,"signUpPassword");return lc(s,c)}else return Promise.reject(u)});const a=await o.catch(u=>Promise.reject(u)),l=await Mn._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(l.user),l}function Fd(t,e,i){return kk(Ue(t),Ms.credential(e,i))}function _k(t,e,i,n){return Ue(t).onIdTokenChanged(e,i,n)}function Ck(t,e,i){return Ue(t).beforeAuthStateChanged(e,i)}function Ek(t,e,i,n){return Ue(t).onAuthStateChanged(e,i,n)}function Sk(t){return Ue(t).signOut()}const ba="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e,i){this.storageRetriever=e,this.type=i}_isAvailable(){try{return this.storage?(this.storage.setItem(ba,"1"),this.storage.removeItem(ba),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,i){return this.storage.setItem(e,JSON.stringify(i)),Promise.resolve()}_get(e){const i=this.storage.getItem(e);return Promise.resolve(i?JSON.parse(i):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(){const t=kt();return $u(t)||Ja(t)}const Ak=1e3,Pk=10;class qp extends jp{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,i)=>this.onStorageEvent(e,i),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=Ik()&&ek(),this.fallbackToPolling=Lp(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const i of Object.keys(this.listeners)){const n=this.storage.getItem(i),s=this.localCache[i];n!==s&&e(i,s,n)}}onStorageEvent(e,i=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const n=e.key;if(i?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(n);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!i)return}const s=()=>{const o=this.storage.getItem(n);!i&&this.localCache[n]===o||this.notifyListeners(n,o)},r=this.storage.getItem(n);Zw()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Pk):s()}notifyListeners(e,i){this.localCache[e]=i;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,i,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:i,newValue:n}),!0)})},Ak)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,i){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(i)}_removeListener(e,i){this.listeners[e]&&(this.listeners[e].delete(i),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,i){await super._set(e,i),this.localCache[e]=JSON.stringify(i)}async _get(e){const i=await super._get(e);return this.localCache[e]=JSON.stringify(i),i}async _remove(e){await super._remove(e),delete this.localCache[e]}}qp.type="LOCAL";const Rk=qp;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp extends jp{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,i){}_removeListener(e,i){}}Wp.type="SESSION";const Kp=Wp;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xk(t){return Promise.all(t.map(async e=>{try{const i=await e;return{fulfilled:!0,value:i}}catch(i){return{fulfilled:!1,reason:i}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const i=this.receivers.find(s=>s.isListeningto(e));if(i)return i;const n=new Xa(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const i=e,{eventId:n,eventType:s,data:r}=i.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;i.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const a=Array.from(o).map(async u=>u(i.origin,r)),l=await xk(a);i.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,i){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(i)}_unsubscribe(e,i){this.handlersMap[e]&&i&&this.handlersMap[e].delete(i),(!i||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xa.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(t="",e=10){let i="";for(let n=0;n<e;n++)i+=Math.floor(Math.random()*10);return t+i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,i,n=50){const s=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,o;return new Promise((a,l)=>{const u=qu("",20);s.port1.start();const c=setTimeout(()=>{l(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(h){const d=h;if(d.data.eventId===u)switch(d.data.status){case"ack":clearTimeout(c),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(d.data.response);break;default:clearTimeout(c),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:i},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(){return window}function Mk(t){gi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(){return typeof gi().WorkerGlobalScope!="undefined"&&typeof gi().importScripts=="function"}async function Lk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Nk(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Ok(){return Gp()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp="firebaseLocalStorageDb",Vk=1,wa="firebaseLocalStorage",Yp="fbase_key";class uo{constructor(e){this.request=e}toPromise(){return new Promise((e,i)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{i(this.request.error)})})}}function Za(t,e){return t.transaction([wa],e?"readwrite":"readonly").objectStore(wa)}function Fk(){const t=indexedDB.deleteDatabase(Qp);return new uo(t).toPromise()}function Kc(){const t=indexedDB.open(Qp,Vk);return new Promise((e,i)=>{t.addEventListener("error",()=>{i(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(wa,{keyPath:Yp})}catch(s){i(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(wa)?e(n):(n.close(),await Fk(),e(await Kc()))})})}async function Ud(t,e,i){const n=Za(t,!0).put({[Yp]:e,value:i});return new uo(n).toPromise()}async function Uk(t,e){const i=Za(t,!1).get(e),n=await new uo(i).toPromise();return n===void 0?null:n.value}function Hd(t,e){const i=Za(t,!0).delete(e);return new uo(i).toPromise()}const Hk=800,Bk=3;class Jp{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Kc(),this.db)}async _withRetries(e){let i=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(i++>Bk)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Gp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xa._getInstance(Ok()),this.receiver._subscribe("keyChanged",async(e,i)=>({keyProcessed:(await this._poll()).includes(i.key)})),this.receiver._subscribe("ping",async(e,i)=>["keyChanged"])}async initializeSender(){var e,i;if(this.activeServiceWorker=await Lk(),!this.activeServiceWorker)return;this.sender=new Dk(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);!n||((e=n[0])===null||e===void 0?void 0:e.fulfilled)&&((i=n[0])===null||i===void 0?void 0:i.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Nk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Kc();return await Ud(e,ba,"1"),await Hd(e,ba),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,i){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ud(n,e,i)),this.localCache[e]=i,this.notifyServiceWorker(e)))}async _get(e){const i=await this._withRetries(n=>Uk(n,e));return this.localCache[e]=i,i}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(i=>Hd(i,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const r=Za(s,!1).getAll();return new uo(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const i=[],n=new Set;for(const{fbase_key:s,value:r}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),i.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),i.push(s));return i}notifyListeners(e,i){this.localCache[e]=i;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(i)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Hk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,i){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(i)}_removeListener(e,i){this.listeners[e]&&(this.listeners[e].delete(i),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Jp.type="LOCAL";const $k=Jp;new ao(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zk(t,e){return e?Di(e):(ee(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu extends zu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ds(e,this._buildIdpRequest())}_linkToIdToken(e,i){return ds(e,this._buildIdpRequest(i))}_getReauthenticationResolver(e){return ds(e,this._buildIdpRequest())}_buildIdpRequest(e){const i={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(i.idToken=e),i}}function jk(t){return zp(t.auth,new Wu(t),t.bypassAuthState)}function qk(t){const{auth:e,user:i}=t;return ee(i,e,"internal-error"),wk(i,new Wu(t),t.bypassAuthState)}async function Wk(t){const{auth:e,user:i}=t;return ee(i,e,"internal-error"),bk(i,new Wu(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e,i,n,s,r=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(i)?i:[i]}execute(){return new Promise(async(e,i)=>{this.pendingPromise={resolve:e,reject:i};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:i,sessionId:n,postBody:s,tenantId:r,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:i,sessionId:n,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jk;case"linkViaPopup":case"linkViaRedirect":return Wk;case"reauthViaPopup":case"reauthViaRedirect":return qk;default:ii(this.auth,"internal-error")}}resolve(e){Oi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Oi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk=new ao(2e3,1e4);class rs extends Xp{constructor(e,i,n,s,r){super(e,i,s,r),this.provider=n,this.authWindow=null,this.pollId=null,rs.currentPopupAction&&rs.currentPopupAction.cancel(),rs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ee(e,this.auth,"internal-error"),e}async onExecution(){Oi(this.filter.length===1,"Popup operations only handle one event");const e=qu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(i=>{this.reject(i)}),this.resolver._isIframeWebStorageSupported(this.auth,i=>{i||this.reject(pi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(pi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,rs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var i,n;if(!((n=(i=this.authWindow)===null||i===void 0?void 0:i.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(pi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Kk.get())};e()}}rs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gk="pendingRedirect",ia=new Map;class Qk extends Xp{constructor(e,i,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],i,void 0,n),this.eventId=null}async execute(){let e=ia.get(this.auth._key());if(!e){try{const n=await Yk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(i){e=()=>Promise.reject(i)}ia.set(this.auth._key(),e)}return this.bypassAuthState||ia.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const i=await this.auth._redirectUserForId(e.eventId);if(i)return this.user=i,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Yk(t,e){const i=Zk(e),n=Xk(t);if(!await n._isAvailable())return!1;const s=await n._get(i)==="true";return await n._remove(i),s}function Jk(t,e){ia.set(t._key(),e)}function Xk(t){return Di(t._redirectPersistence)}function Zk(t){return ta(Gk,t.config.apiKey,t.name)}async function eT(t,e,i=!1){const n=Ds(t),s=zk(n,e),o=await new Qk(n,s,i).execute();return o&&!i&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tT=10*60*1e3;class iT{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let i=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(i=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nT(e)||(this.hasHandledPotentialRedirect=!0,i||(this.queuedRedirectEvent=e,i=!0)),i}sendToConsumer(e,i){var n;if(e.error&&!Zp(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";i.onError(pi(this.auth,s))}else i.onAuthEvent(e)}isEventForConsumer(e,i){const n=i.eventId===null||!!e.eventId&&e.eventId===i.eventId;return i.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tT&&this.cachedEventUids.clear(),this.cachedEventUids.has(Bd(e))}saveEventToCache(e){this.cachedEventUids.add(Bd(e)),this.lastProcessedEventTime=Date.now()}}function Bd(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Zp({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function nT(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Zp(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sT(t,e={}){return xs(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oT=/^https?/;async function aT(t){if(t.config.emulator)return;const{authorizedDomains:e}=await sT(t);for(const i of e)try{if(lT(i))return}catch{}ii(t,"unauthorized-domain")}function lT(t){const e=Wc(),{protocol:i,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?i==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):i==="chrome-extension:"&&o.hostname===n}if(!oT.test(i))return!1;if(rT.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT=new ao(3e4,6e4);function $d(){const t=gi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let i=0;i<t.CP.length;i++)t.CP[i]=null}}function uT(t){return new Promise((e,i)=>{var n,s,r;function o(){$d(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{$d(),i(pi(t,"network-request-failed"))},timeout:cT.get()})}if(!((s=(n=gi().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((r=gi().gapi)===null||r===void 0)&&r.load)o();else{const a=ik("iframefcb");return gi()[a]=()=>{gapi.load?o():i(pi(t,"network-request-failed"))},Fp(`https://apis.google.com/js/api.js?onload=${a}`).catch(l=>i(l))}}).catch(e=>{throw na=null,e})}let na=null;function hT(t){return na=na||uT(t),na}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dT=new ao(5e3,15e3),fT="__/auth/iframe",mT="emulator/auth/iframe",pT={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gT=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vT(t){const e=t.config;ee(e.authDomain,t,"auth-domain-config-required");const i=e.emulator?Hu(e,mT):`https://${t.config.authDomain}/${fT}`,n={apiKey:e.apiKey,appName:t.name,v:Hn},s=gT.get(t.config.apiHost);s&&(n.eid=s);const r=t._getFrameworks();return r.length&&(n.fw=r.join(",")),`${i}?${oo(n).slice(1)}`}async function yT(t){const e=await hT(t),i=gi().gapi;return ee(i,t,"internal-error"),e.open({where:document.body,url:vT(t),messageHandlersFilter:i.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pT,dontclear:!0},n=>new Promise(async(s,r)=>{await n.restyle({setHideOnLeave:!1});const o=pi(t,"network-request-failed"),a=gi().setTimeout(()=>{r(o)},dT.get());function l(){gi().clearTimeout(a),s(n)}n.ping(l).then(l,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wT=500,kT=600,TT="_blank",_T="http://localhost";class zd{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function CT(t,e,i,n=wT,s=kT){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const l=Object.assign(Object.assign({},bT),{width:n.toString(),height:s.toString(),top:r,left:o}),u=kt().toLowerCase();i&&(a=Pp(u)?TT:i),Ap(u)&&(e=e||_T,l.scrollbars="yes");const c=Object.entries(l).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(Xw(u)&&a!=="_self")return ET(e||"",a),new zd(null);const h=window.open(e||"",a,c);ee(h,t,"popup-blocked");try{h.focus()}catch{}return new zd(h)}function ET(t,e){const i=document.createElement("a");i.href=t,i.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),i.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ST="__/auth/handler",IT="emulator/auth/handler",AT=encodeURIComponent("fac");async function jd(t,e,i,n,s,r){ee(t.config.authDomain,t,"auth-domain-config-required"),ee(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:i,redirectUrl:n,v:Hn,eventId:s};if(e instanceof Bp){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Cb(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,h]of Object.entries(r||{}))o[c]=h}if(e instanceof co){const c=e.getScopes().filter(h=>h!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];const l=await t._getAppCheckToken(),u=l?`#${AT}=${encodeURIComponent(l)}`:"";return`${PT(t)}?${oo(a).slice(1)}${u}`}function PT({config:t}){return t.emulator?Hu(t,IT):`https://${t.authDomain}/${ST}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cc="webStorageSupport";class RT{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Kp,this._completeRedirectFn=eT,this._overrideRedirectResult=Jk}async _openPopup(e,i,n,s){var r;Oi((r=this.eventManagers[e._key()])===null||r===void 0?void 0:r.manager,"_initialize() not called before _openPopup()");const o=await jd(e,i,n,Wc(),s);return CT(e,o,qu())}async _openRedirect(e,i,n,s){await this._originValidation(e);const r=await jd(e,i,n,Wc(),s);return Mk(r),new Promise(()=>{})}_initialize(e){const i=e._key();if(this.eventManagers[i]){const{manager:s,promise:r}=this.eventManagers[i];return s?Promise.resolve(s):(Oi(r,"If manager is not set, promise should be"),r)}const n=this.initAndGetManager(e);return this.eventManagers[i]={promise:n},n.catch(()=>{delete this.eventManagers[i]}),n}async initAndGetManager(e){const i=await yT(e),n=new iT(e);return i.register("authEvent",s=>(ee(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=i,n}_isIframeWebStorageSupported(e,i){this.iframes[e._key()].send(cc,{type:cc},s=>{var r;const o=(r=s==null?void 0:s[0])===null||r===void 0?void 0:r[cc];o!==void 0&&i(!!o),ii(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const i=e._key();return this.originValidationPromises[i]||(this.originValidationPromises[i]=aT(e)),this.originValidationPromises[i]}get _shouldInitProactively(){return Lp()||$u()||Ja()}}const xT=RT;var qd="@firebase/auth",Wd="0.23.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const i=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,i),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const i=this.internalListeners.get(e);!i||(this.internalListeners.delete(e),i(),this.updateProactiveRefresh())}assertAuthConfigured(){ee(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MT(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function LT(t){xn(new rn("auth",(e,{options:i})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;ee(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Np(t)},u=new ak(n,s,r,l);return ck(u,i),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,i,n)=>{e.getProvider("auth-internal").initialize()})),xn(new rn("auth-internal",e=>{const i=Ds(e.getProvider("auth").getImmediate());return(n=>new DT(n))(i)},"PRIVATE").setInstantiationMode("EXPLICIT")),mi(qd,Wd,MT(t)),mi(qd,Wd,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT=5*60,OT=mp("authIdTokenMaxAge")||NT;let Kd=null;const VT=t=>async e=>{const i=e&&await e.getIdTokenResult(),n=i&&(new Date().getTime()-Date.parse(i.issuedAtTime))/1e3;if(n&&n>OT)return;const s=i==null?void 0:i.token;Kd!==s&&(Kd=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Ku(t=Vu()){const e=Ya(t,"auth");if(e.isInitialized())return e.getImmediate();const i=lk(t,{popupRedirectResolver:xT,persistence:[$k,Rk,Kp]}),n=mp("authTokenSyncURL");if(n){const r=VT(n);Ck(i,r,()=>r(i.currentUser)),_k(i,o=>r(o))}const s=hp("auth");return s&&uk(i,`http://${s}`),i}LT("Browser");var FT=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},M,Gu=Gu||{},te=FT||self;function el(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function ho(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function UT(t){return Object.prototype.hasOwnProperty.call(t,uc)&&t[uc]||(t[uc]=++HT)}var uc="closure_uid_"+(1e9*Math.random()>>>0),HT=0;function BT(t,e,i){return t.call.apply(t.bind,arguments)}function $T(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,n),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function yt(t,e,i){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?yt=BT:yt=$T,yt.apply(null,arguments)}function Uo(t,e){var i=Array.prototype.slice.call(arguments,1);return function(){var n=i.slice();return n.push.apply(n,arguments),t.apply(this,n)}}function at(t,e){function i(){}i.prototype=e.prototype,t.$=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.ac=function(n,s,r){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(n,o)}}function cn(){this.s=this.s,this.o=this.o}var zT=0;cn.prototype.s=!1;cn.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),zT!=0)&&UT(this)};cn.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const eg=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let i=0;i<t.length;i++)if(i in t&&t[i]===e)return i;return-1};function Qu(t){const e=t.length;if(0<e){const i=Array(e);for(let n=0;n<e;n++)i[n]=t[n];return i}return[]}function Gd(t,e){for(let i=1;i<arguments.length;i++){const n=arguments[i];if(el(n)){const s=t.length||0,r=n.length||0;t.length=s+r;for(let o=0;o<r;o++)t[s+o]=n[o]}else t.push(n)}}function bt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}bt.prototype.h=function(){this.defaultPrevented=!0};var jT=function(){if(!te.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{te.addEventListener("test",()=>{},e),te.removeEventListener("test",()=>{},e)}catch{}return t}();function $r(t){return/^[\s\xa0]*$/.test(t)}function tl(){var t=te.navigator;return t&&(t=t.userAgent)?t:""}function ui(t){return tl().indexOf(t)!=-1}function Yu(t){return Yu[" "](t),t}Yu[" "]=function(){};function qT(t,e){var i=V_;return Object.prototype.hasOwnProperty.call(i,t)?i[t]:i[t]=e(t)}var WT=ui("Opera"),ks=ui("Trident")||ui("MSIE"),tg=ui("Edge"),Gc=tg||ks,ig=ui("Gecko")&&!(tl().toLowerCase().indexOf("webkit")!=-1&&!ui("Edge"))&&!(ui("Trident")||ui("MSIE"))&&!ui("Edge"),KT=tl().toLowerCase().indexOf("webkit")!=-1&&!ui("Edge");function ng(){var t=te.document;return t?t.documentMode:void 0}var Qc;e:{var hc="",dc=function(){var t=tl();if(ig)return/rv:([^\);]+)(\)|;)/.exec(t);if(tg)return/Edge\/([\d\.]+)/.exec(t);if(ks)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(KT)return/WebKit\/(\S+)/.exec(t);if(WT)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(dc&&(hc=dc?dc[1]:""),ks){var fc=ng();if(fc!=null&&fc>parseFloat(hc)){Qc=String(fc);break e}}Qc=hc}var Yc;if(te.document&&ks){var Qd=ng();Yc=Qd||parseInt(Qc,10)||void 0}else Yc=void 0;var GT=Yc;function zr(t,e){if(bt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var i=this.type=t.type,n=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(ig){e:{try{Yu(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else i=="mouseover"?e=t.fromElement:i=="mouseout"&&(e=t.toElement);this.relatedTarget=e,n?(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:QT[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&zr.$.h.call(this)}}at(zr,bt);var QT={2:"touch",3:"pen",4:"mouse"};zr.prototype.h=function(){zr.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var fo="closure_listenable_"+(1e6*Math.random()|0),YT=0;function JT(t,e,i,n,s){this.listener=t,this.proxy=null,this.src=e,this.type=i,this.capture=!!n,this.la=s,this.key=++YT,this.fa=this.ia=!1}function il(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Ju(t,e,i){for(const n in t)e.call(i,t[n],n,t)}function XT(t,e){for(const i in t)e.call(void 0,t[i],i,t)}function sg(t){const e={};for(const i in t)e[i]=t[i];return e}const Yd="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rg(t,e){let i,n;for(let s=1;s<arguments.length;s++){n=arguments[s];for(i in n)t[i]=n[i];for(let r=0;r<Yd.length;r++)i=Yd[r],Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}}function nl(t){this.src=t,this.g={},this.h=0}nl.prototype.add=function(t,e,i,n,s){var r=t.toString();t=this.g[r],t||(t=this.g[r]=[],this.h++);var o=Xc(t,e,n,s);return-1<o?(e=t[o],i||(e.ia=!1)):(e=new JT(e,this.src,r,!!n,s),e.ia=i,t.push(e)),e};function Jc(t,e){var i=e.type;if(i in t.g){var n=t.g[i],s=eg(n,e),r;(r=0<=s)&&Array.prototype.splice.call(n,s,1),r&&(il(e),t.g[i].length==0&&(delete t.g[i],t.h--))}}function Xc(t,e,i,n){for(var s=0;s<t.length;++s){var r=t[s];if(!r.fa&&r.listener==e&&r.capture==!!i&&r.la==n)return s}return-1}var Xu="closure_lm_"+(1e6*Math.random()|0),mc={};function og(t,e,i,n,s){if(n&&n.once)return lg(t,e,i,n,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)og(t,e[r],i,n,s);return null}return i=th(i),t&&t[fo]?t.O(e,i,ho(n)?!!n.capture:!!n,s):ag(t,e,i,!1,n,s)}function ag(t,e,i,n,s,r){if(!e)throw Error("Invalid event type");var o=ho(s)?!!s.capture:!!s,a=eh(t);if(a||(t[Xu]=a=new nl(t)),i=a.add(e,i,n,o,r),i.proxy)return i;if(n=ZT(),i.proxy=n,n.src=t,n.listener=i,t.addEventListener)jT||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),n,s);else if(t.attachEvent)t.attachEvent(ug(e.toString()),n);else if(t.addListener&&t.removeListener)t.addListener(n);else throw Error("addEventListener and attachEvent are unavailable.");return i}function ZT(){function t(i){return e.call(t.src,t.listener,i)}const e=e_;return t}function lg(t,e,i,n,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)lg(t,e[r],i,n,s);return null}return i=th(i),t&&t[fo]?t.P(e,i,ho(n)?!!n.capture:!!n,s):ag(t,e,i,!0,n,s)}function cg(t,e,i,n,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)cg(t,e[r],i,n,s);else n=ho(n)?!!n.capture:!!n,i=th(i),t&&t[fo]?(t=t.i,e=String(e).toString(),e in t.g&&(r=t.g[e],i=Xc(r,i,n,s),-1<i&&(il(r[i]),Array.prototype.splice.call(r,i,1),r.length==0&&(delete t.g[e],t.h--)))):t&&(t=eh(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Xc(e,i,n,s)),(i=-1<t?e[t]:null)&&Zu(i))}function Zu(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[fo])Jc(e.i,t);else{var i=t.type,n=t.proxy;e.removeEventListener?e.removeEventListener(i,n,t.capture):e.detachEvent?e.detachEvent(ug(i),n):e.addListener&&e.removeListener&&e.removeListener(n),(i=eh(e))?(Jc(i,t),i.h==0&&(i.src=null,e[Xu]=null)):il(t)}}}function ug(t){return t in mc?mc[t]:mc[t]="on"+t}function e_(t,e){if(t.fa)t=!0;else{e=new zr(e,this);var i=t.listener,n=t.la||t.src;t.ia&&Zu(t),t=i.call(n,e)}return t}function eh(t){return t=t[Xu],t instanceof nl?t:null}var pc="__closure_events_fn_"+(1e9*Math.random()>>>0);function th(t){return typeof t=="function"?t:(t[pc]||(t[pc]=function(e){return t.handleEvent(e)}),t[pc])}function nt(){cn.call(this),this.i=new nl(this),this.S=this,this.J=null}at(nt,cn);nt.prototype[fo]=!0;nt.prototype.removeEventListener=function(t,e,i,n){cg(this,t,e,i,n)};function dt(t,e){var i,n=t.J;if(n)for(i=[];n;n=n.J)i.push(n);if(t=t.S,n=e.type||e,typeof e=="string")e=new bt(e,t);else if(e instanceof bt)e.target=e.target||t;else{var s=e;e=new bt(n,t),rg(e,s)}if(s=!0,i)for(var r=i.length-1;0<=r;r--){var o=e.g=i[r];s=Ho(o,n,!0,e)&&s}if(o=e.g=t,s=Ho(o,n,!0,e)&&s,s=Ho(o,n,!1,e)&&s,i)for(r=0;r<i.length;r++)o=e.g=i[r],s=Ho(o,n,!1,e)&&s}nt.prototype.N=function(){if(nt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var i=t.g[e],n=0;n<i.length;n++)il(i[n]);delete t.g[e],t.h--}}this.J=null};nt.prototype.O=function(t,e,i,n){return this.i.add(String(t),e,!1,i,n)};nt.prototype.P=function(t,e,i,n){return this.i.add(String(t),e,!0,i,n)};function Ho(t,e,i,n){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.fa&&o.capture==i){var a=o.listener,l=o.la||o.src;o.ia&&Jc(t.i,o),s=a.call(l,n)!==!1&&s}}return s&&!n.defaultPrevented}var ih=te.JSON.stringify;class t_{constructor(e,i){this.i=e,this.j=i,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function i_(){var t=nh;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class n_{constructor(){this.h=this.g=null}add(e,i){const n=hg.get();n.set(e,i),this.h?this.h.next=n:this.g=n,this.h=n}}var hg=new t_(()=>new s_,t=>t.reset());class s_{constructor(){this.next=this.g=this.h=null}set(e,i){this.h=e,this.g=i,this.next=null}reset(){this.next=this.g=this.h=null}}function r_(t){var e=1;t=t.split(":");const i=[];for(;0<e&&t.length;)i.push(t.shift()),e--;return t.length&&i.push(t.join(":")),i}function o_(t){te.setTimeout(()=>{throw t},0)}let jr,qr=!1,nh=new n_,dg=()=>{const t=te.Promise.resolve(void 0);jr=()=>{t.then(a_)}};var a_=()=>{for(var t;t=i_();){try{t.h.call(t.g)}catch(i){o_(i)}var e=hg;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}qr=!1};function sl(t,e){nt.call(this),this.h=t||1,this.g=e||te,this.j=yt(this.qb,this),this.l=Date.now()}at(sl,nt);M=sl.prototype;M.ga=!1;M.T=null;M.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),dt(this,"tick"),this.ga&&(sh(this),this.start()))}};M.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function sh(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}M.N=function(){sl.$.N.call(this),sh(this),delete this.g};function rh(t,e,i){if(typeof t=="function")i&&(t=yt(t,i));else if(t&&typeof t.handleEvent=="function")t=yt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:te.setTimeout(t,e||0)}function fg(t){t.g=rh(()=>{t.g=null,t.i&&(t.i=!1,fg(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class l_ extends cn{constructor(e,i){super(),this.m=e,this.j=i,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:fg(this)}N(){super.N(),this.g&&(te.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wr(t){cn.call(this),this.h=t,this.g={}}at(Wr,cn);var Jd=[];function mg(t,e,i,n){Array.isArray(i)||(i&&(Jd[0]=i.toString()),i=Jd);for(var s=0;s<i.length;s++){var r=og(e,i[s],n||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function pg(t){Ju(t.g,function(e,i){this.g.hasOwnProperty(i)&&Zu(e)},t),t.g={}}Wr.prototype.N=function(){Wr.$.N.call(this),pg(this)};Wr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function rl(){this.g=!0}rl.prototype.Ea=function(){this.g=!1};function c_(t,e,i,n,s,r){t.info(function(){if(t.g)if(r)for(var o="",a=r.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var c=u[0];u=u[1];var h=c.split("_");o=2<=h.length&&h[1]=="type"?o+(c+"="+u+"&"):o+(c+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+n+") [attempt "+s+"]: "+e+`
`+i+`
`+o})}function u_(t,e,i,n,s,r,o){t.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+s+"]: "+e+`
`+i+`
`+r+" "+o})}function os(t,e,i,n){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+d_(t,i)+(n?" "+n:"")})}function h_(t,e){t.info(function(){return"TIMEOUT: "+e})}rl.prototype.info=function(){};function d_(t,e){if(!t.g)return e;if(!e)return null;try{var i=JSON.parse(e);if(i){for(t=0;t<i.length;t++)if(Array.isArray(i[t])){var n=i[t];if(!(2>n.length)){var s=n[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if(r!="noop"&&r!="stop"&&r!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return ih(i)}catch{return e}}var Bn={},Xd=null;function ol(){return Xd=Xd||new nt}Bn.Ta="serverreachability";function gg(t){bt.call(this,Bn.Ta,t)}at(gg,bt);function Kr(t){const e=ol();dt(e,new gg(e))}Bn.STAT_EVENT="statevent";function vg(t,e){bt.call(this,Bn.STAT_EVENT,t),this.stat=e}at(vg,bt);function It(t){const e=ol();dt(e,new vg(e,t))}Bn.Ua="timingevent";function yg(t,e){bt.call(this,Bn.Ua,t),this.size=e}at(yg,bt);function mo(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return te.setTimeout(function(){t()},e)}var al={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},bg={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function oh(){}oh.prototype.h=null;function Zd(t){return t.h||(t.h=t.i())}function wg(){}var po={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ah(){bt.call(this,"d")}at(ah,bt);function lh(){bt.call(this,"c")}at(lh,bt);var Zc;function ll(){}at(ll,oh);ll.prototype.g=function(){return new XMLHttpRequest};ll.prototype.i=function(){return{}};Zc=new ll;function go(t,e,i,n){this.l=t,this.j=e,this.m=i,this.W=n||1,this.U=new Wr(this),this.P=f_,t=Gc?125:void 0,this.V=new sl(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new kg}function kg(){this.i=null,this.g="",this.h=!1}var f_=45e3,eu={},ka={};M=go.prototype;M.setTimeout=function(t){this.P=t};function tu(t,e,i){t.L=1,t.v=ul(Vi(e)),t.s=i,t.S=!0,Tg(t,null)}function Tg(t,e){t.G=Date.now(),vo(t),t.A=Vi(t.v);var i=t.A,n=t.W;Array.isArray(n)||(n=[String(n)]),Rg(i.i,"t",n),t.C=0,i=t.l.J,t.h=new kg,t.g=Jg(t.l,i?e:null,!t.s),0<t.O&&(t.M=new l_(yt(t.Pa,t,t.g),t.O)),mg(t.U,t.g,"readystatechange",t.nb),e=t.I?sg(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),Kr(),c_(t.j,t.u,t.A,t.m,t.W,t.s)}M.nb=function(t){t=t.target;const e=this.M;e&&hi(t)==3?e.l():this.Pa(t)};M.Pa=function(t){try{if(t==this.g)e:{const c=hi(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>c)&&(c!=3||Gc||this.g&&(this.h.h||this.g.ja()||sf(this.g)))){this.J||c!=4||e==7||(e==8||0>=h?Kr(3):Kr(2)),cl(this);var i=this.g.da();this.ca=i;t:if(_g(this)){var n=sf(this.g);t="";var s=n.length,r=hi(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){Tn(this),Ar(this);var o="";break t}this.h.i=new te.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(n[e],{stream:r&&e==s-1});n.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=i==200,u_(this.j,this.u,this.A,this.m,this.W,c,i),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$r(a)){var u=a;break t}}u=null}if(i=u)os(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,iu(this,i);else{this.i=!1,this.o=3,It(12),Tn(this),Ar(this);break e}}this.S?(Cg(this,c,o),Gc&&this.i&&c==3&&(mg(this.U,this.V,"tick",this.mb),this.V.start())):(os(this.j,this.m,o,null),iu(this,o)),c==4&&Tn(this),this.i&&!this.J&&(c==4?Kg(this.l,this):(this.i=!1,vo(this)))}else L_(this.g),i==400&&0<o.indexOf("Unknown SID")?(this.o=3,It(12)):(this.o=0,It(13)),Tn(this),Ar(this)}}}catch{}finally{}};function _g(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function Cg(t,e,i){let n=!0,s;for(;!t.J&&t.C<i.length;)if(s=m_(t,i),s==ka){e==4&&(t.o=4,It(14),n=!1),os(t.j,t.m,null,"[Incomplete Response]");break}else if(s==eu){t.o=4,It(15),os(t.j,t.m,i,"[Invalid Chunk]"),n=!1;break}else os(t.j,t.m,s,null),iu(t,s);_g(t)&&s!=ka&&s!=eu&&(t.h.g="",t.C=0),e!=4||i.length!=0||t.h.h||(t.o=1,It(16),n=!1),t.i=t.i&&n,n?0<i.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+i.length),mh(e),e.M=!0,It(11))):(os(t.j,t.m,i,"[Invalid Chunked Response]"),Tn(t),Ar(t))}M.mb=function(){if(this.g){var t=hi(this.g),e=this.g.ja();this.C<e.length&&(cl(this),Cg(this,t,e),this.i&&t!=4&&vo(this))}};function m_(t,e){var i=t.C,n=e.indexOf(`
`,i);return n==-1?ka:(i=Number(e.substring(i,n)),isNaN(i)?eu:(n+=1,n+i>e.length?ka:(e=e.slice(n,n+i),t.C=n+i,e)))}M.cancel=function(){this.J=!0,Tn(this)};function vo(t){t.Y=Date.now()+t.P,Eg(t,t.P)}function Eg(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=mo(yt(t.lb,t),e)}function cl(t){t.B&&(te.clearTimeout(t.B),t.B=null)}M.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(h_(this.j,this.A),this.L!=2&&(Kr(),It(17)),Tn(this),this.o=2,Ar(this)):Eg(this,this.Y-t)};function Ar(t){t.l.H==0||t.J||Kg(t.l,t)}function Tn(t){cl(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,sh(t.V),pg(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function iu(t,e){try{var i=t.l;if(i.H!=0&&(i.g==t||nu(i.i,t))){if(!t.K&&nu(i.i,t)&&i.H==3){try{var n=i.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&n.length==3){var s=n;if(s[0]==0){e:if(!i.u){if(i.g)if(i.g.G+3e3<t.G)Ca(i),fl(i);else break e;fh(i),It(18)}}else i.Fa=s[1],0<i.Fa-i.V&&37500>s[2]&&i.G&&i.A==0&&!i.v&&(i.v=mo(yt(i.ib,i),6e3));if(1>=Mg(i.i)&&i.oa){try{i.oa()}catch{}i.oa=void 0}}else _n(i,11)}else if((t.K||i.g==t)&&Ca(i),!$r(e))for(s=i.Ja.g.parse(e),e=0;e<s.length;e++){let u=s[e];if(i.V=u[0],u=u[1],i.H==2)if(u[0]=="c"){i.K=u[1],i.pa=u[2];const c=u[3];c!=null&&(i.ra=c,i.l.info("VER="+i.ra));const h=u[4];h!=null&&(i.Ga=h,i.l.info("SVER="+i.Ga));const d=u[5];d!=null&&typeof d=="number"&&0<d&&(n=1.5*d,i.L=n,i.l.info("backChannelRequestTimeoutMs_="+n)),n=i;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var r=n.i;r.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(r.j=r.l,r.g=new Set,r.h&&(ch(r,r.h),r.h=null))}if(n.F){const T=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;T&&(n.Da=T,Se(n.I,n.F,T))}}i.H=3,i.h&&i.h.Ba(),i.ca&&(i.S=Date.now()-t.G,i.l.info("Handshake RTT: "+i.S+"ms")),n=i;var o=t;if(n.wa=Yg(n,n.J?n.pa:null,n.Y),o.K){Lg(n.i,o);var a=o,l=n.L;l&&a.setTimeout(l),a.B&&(cl(a),vo(a)),n.g=o}else qg(n);0<i.j.length&&ml(i)}else u[0]!="stop"&&u[0]!="close"||_n(i,7);else i.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?_n(i,7):dh(i):u[0]!="noop"&&i.h&&i.h.Aa(u),i.A=0)}}Kr(4)}catch{}}function p_(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map!="undefined"&&t instanceof Map||typeof Set!="undefined"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(el(t)){for(var e=[],i=t.length,n=0;n<i;n++)e.push(t[n]);return e}e=[],i=0;for(n in t)e[i++]=t[n];return e}function g_(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map!="undefined"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set!="undefined"&&t instanceof Set)){if(el(t)||typeof t=="string"){var e=[];t=t.length;for(var i=0;i<t;i++)e.push(i);return e}e=[],i=0;for(const n in t)e[i++]=n;return e}}}function Sg(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(el(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var i=g_(t),n=p_(t),s=n.length,r=0;r<s;r++)e.call(void 0,n[r],i&&i[r],t)}var Ig=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function v_(t,e){if(t){t=t.split("&");for(var i=0;i<t.length;i++){var n=t[i].indexOf("="),s=null;if(0<=n){var r=t[i].substring(0,n);s=t[i].substring(n+1)}else r=t[i];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function In(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof In){this.h=t.h,Ta(this,t.j),this.s=t.s,this.g=t.g,_a(this,t.m),this.l=t.l;var e=t.i,i=new Gr;i.i=e.i,e.g&&(i.g=new Map(e.g),i.h=e.h),ef(this,i),this.o=t.o}else t&&(e=String(t).match(Ig))?(this.h=!1,Ta(this,e[1]||"",!0),this.s=wr(e[2]||""),this.g=wr(e[3]||"",!0),_a(this,e[4]),this.l=wr(e[5]||"",!0),ef(this,e[6]||"",!0),this.o=wr(e[7]||"")):(this.h=!1,this.i=new Gr(null,this.h))}In.prototype.toString=function(){var t=[],e=this.j;e&&t.push(kr(e,tf,!0),":");var i=this.g;return(i||e=="file")&&(t.push("//"),(e=this.s)&&t.push(kr(e,tf,!0),"@"),t.push(encodeURIComponent(String(i)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i=this.m,i!=null&&t.push(":",String(i))),(i=this.l)&&(this.g&&i.charAt(0)!="/"&&t.push("/"),t.push(kr(i,i.charAt(0)=="/"?w_:b_,!0))),(i=this.i.toString())&&t.push("?",i),(i=this.o)&&t.push("#",kr(i,T_)),t.join("")};function Vi(t){return new In(t)}function Ta(t,e,i){t.j=i?wr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function _a(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function ef(t,e,i){e instanceof Gr?(t.i=e,__(t.i,t.h)):(i||(e=kr(e,k_)),t.i=new Gr(e,t.h))}function Se(t,e,i){t.i.set(e,i)}function ul(t){return Se(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function wr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function kr(t,e,i){return typeof t=="string"?(t=encodeURI(t).replace(e,y_),i&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function y_(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var tf=/[#\/\?@]/g,b_=/[#\?:]/g,w_=/[#\?]/g,k_=/[#\?@]/g,T_=/#/g;function Gr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function un(t){t.g||(t.g=new Map,t.h=0,t.i&&v_(t.i,function(e,i){t.add(decodeURIComponent(e.replace(/\+/g," ")),i)}))}M=Gr.prototype;M.add=function(t,e){un(this),this.i=null,t=Ls(this,t);var i=this.g.get(t);return i||this.g.set(t,i=[]),i.push(e),this.h+=1,this};function Ag(t,e){un(t),e=Ls(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Pg(t,e){return un(t),e=Ls(t,e),t.g.has(e)}M.forEach=function(t,e){un(this),this.g.forEach(function(i,n){i.forEach(function(s){t.call(e,s,n,this)},this)},this)};M.ta=function(){un(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),i=[];for(let n=0;n<e.length;n++){const s=t[n];for(let r=0;r<s.length;r++)i.push(e[n])}return i};M.Z=function(t){un(this);let e=[];if(typeof t=="string")Pg(this,t)&&(e=e.concat(this.g.get(Ls(this,t))));else{t=Array.from(this.g.values());for(let i=0;i<t.length;i++)e=e.concat(t[i])}return e};M.set=function(t,e){return un(this),this.i=null,t=Ls(this,t),Pg(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};M.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function Rg(t,e,i){Ag(t,e),0<i.length&&(t.i=null,t.g.set(Ls(t,e),Qu(i)),t.h+=i.length)}M.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var i=0;i<e.length;i++){var n=e[i];const r=encodeURIComponent(String(n)),o=this.Z(n);for(n=0;n<o.length;n++){var s=r;o[n]!==""&&(s+="="+encodeURIComponent(String(o[n]))),t.push(s)}}return this.i=t.join("&")};function Ls(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function __(t,e){e&&!t.j&&(un(t),t.i=null,t.g.forEach(function(i,n){var s=n.toLowerCase();n!=s&&(Ag(this,n),Rg(this,s,i))},t)),t.j=e}var C_=class{constructor(t,e){this.g=t,this.map=e}};function xg(t){this.l=t||E_,te.PerformanceNavigationTiming?(t=te.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(te.g&&te.g.Ka&&te.g.Ka()&&te.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var E_=10;function Dg(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function Mg(t){return t.h?1:t.g?t.g.size:0}function nu(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function ch(t,e){t.g?t.g.add(e):t.h=e}function Lg(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}xg.prototype.cancel=function(){if(this.i=Ng(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function Ng(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const i of t.g.values())e=e.concat(i.F);return e}return Qu(t.i)}var S_=class{stringify(t){return te.JSON.stringify(t,void 0)}parse(t){return te.JSON.parse(t,void 0)}};function I_(){this.g=new S_}function A_(t,e,i){const n=i||"";try{Sg(t,function(s,r){let o=s;ho(s)&&(o=ih(s)),e.push(n+r+"="+encodeURIComponent(o))})}catch(s){throw e.push(n+"type="+encodeURIComponent("_badmap")),s}}function P_(t,e){const i=new rl;if(te.Image){const n=new Image;n.onload=Uo(Bo,i,n,"TestLoadImage: loaded",!0,e),n.onerror=Uo(Bo,i,n,"TestLoadImage: error",!1,e),n.onabort=Uo(Bo,i,n,"TestLoadImage: abort",!1,e),n.ontimeout=Uo(Bo,i,n,"TestLoadImage: timeout",!1,e),te.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=t}else e(!1)}function Bo(t,e,i,n,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(n)}catch{}}function yo(t){this.l=t.fc||null,this.j=t.ob||!1}at(yo,oh);yo.prototype.g=function(){return new hl(this.l,this.j)};yo.prototype.i=function(t){return function(){return t}}({});function hl(t,e){nt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=uh,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}at(hl,nt);var uh=0;M=hl.prototype;M.open=function(t,e){if(this.readyState!=uh)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Qr(this)};M.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||te).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};M.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,bo(this)),this.readyState=uh};M.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Qr(this)),this.g&&(this.readyState=3,Qr(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof te.ReadableStream!="undefined"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Og(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function Og(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}M.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?bo(this):Qr(this),this.readyState==3&&Og(this)}};M.Za=function(t){this.g&&(this.response=this.responseText=t,bo(this))};M.Ya=function(t){this.g&&(this.response=t,bo(this))};M.ka=function(){this.g&&bo(this)};function bo(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Qr(t)}M.setRequestHeader=function(t,e){this.v.append(t,e)};M.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};M.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var i=e.next();!i.done;)i=i.value,t.push(i[0]+": "+i[1]),i=e.next();return t.join(`\r
`)};function Qr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(hl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var R_=te.JSON.parse;function He(t){nt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Vg,this.L=this.M=!1}at(He,nt);var Vg="",x_=/^https?$/i,D_=["POST","PUT"];M=He.prototype;M.Oa=function(t){this.M=t};M.ha=function(t,e,i,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Zc.g(),this.C=this.u?Zd(this.u):Zd(Zc),this.g.onreadystatechange=yt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(r){nf(this,r);return}if(t=i||"",i=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var s in n)i.set(s,n[s]);else if(typeof n.keys=="function"&&typeof n.get=="function")for(const r of n.keys())i.set(r,n.get(r));else throw Error("Unknown input type for opt_headers: "+String(n));n=Array.from(i.keys()).find(r=>r.toLowerCase()=="content-type"),s=te.FormData&&t instanceof te.FormData,!(0<=eg(D_,e))||n||s||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[r,o]of i)this.g.setRequestHeader(r,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Hg(this),0<this.B&&((this.L=M_(this.g))?(this.g.timeout=this.B,this.g.ontimeout=yt(this.ua,this)):this.A=rh(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(r){nf(this,r)}};function M_(t){return ks&&typeof t.timeout=="number"&&t.ontimeout!==void 0}M.ua=function(){typeof Gu!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,dt(this,"timeout"),this.abort(8))};function nf(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Fg(t),dl(t)}function Fg(t){t.F||(t.F=!0,dt(t,"complete"),dt(t,"error"))}M.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,dt(this,"complete"),dt(this,"abort"),dl(this))};M.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),dl(this,!0)),He.$.N.call(this)};M.La=function(){this.s||(this.G||this.v||this.l?Ug(this):this.kb())};M.kb=function(){Ug(this)};function Ug(t){if(t.h&&typeof Gu!="undefined"&&(!t.C[1]||hi(t)!=4||t.da()!=2)){if(t.v&&hi(t)==4)rh(t.La,0,t);else if(dt(t,"readystatechange"),hi(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var i;if(!(i=e)){var n;if(n=o===0){var s=String(t.I).match(Ig)[1]||null;!s&&te.self&&te.self.location&&(s=te.self.location.protocol.slice(0,-1)),n=!x_.test(s?s.toLowerCase():"")}i=n}if(i)dt(t,"complete"),dt(t,"success");else{t.m=6;try{var r=2<hi(t)?t.g.statusText:""}catch{r=""}t.j=r+" ["+t.da()+"]",Fg(t)}}finally{dl(t)}}}}function dl(t,e){if(t.g){Hg(t);const i=t.g,n=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||dt(t,"ready");try{i.onreadystatechange=n}catch{}}}function Hg(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(te.clearTimeout(t.A),t.A=null)}M.isActive=function(){return!!this.g};function hi(t){return t.g?t.g.readyState:0}M.da=function(){try{return 2<hi(this)?this.g.status:-1}catch{return-1}};M.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};M.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),R_(e)}};function sf(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Vg:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function L_(t){const e={};t=(t.g&&2<=hi(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let n=0;n<t.length;n++){if($r(t[n]))continue;var i=r_(t[n]);const s=i[0];if(i=i[1],typeof i!="string")continue;i=i.trim();const r=e[s]||[];e[s]=r,r.push(i)}XT(e,function(n){return n.join(", ")})}M.Ia=function(){return this.m};M.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Bg(t){let e="";return Ju(t,function(i,n){e+=n,e+=":",e+=i,e+=`\r
`}),e}function hh(t,e,i){e:{for(n in i){var n=!1;break e}n=!0}n||(i=Bg(i),typeof t=="string"?i!=null&&encodeURIComponent(String(i)):Se(t,e,i))}function hr(t,e,i){return i&&i.internalChannelParams&&i.internalChannelParams[t]||e}function $g(t){this.Ga=0,this.j=[],this.l=new rl,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=hr("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=hr("baseRetryDelayMs",5e3,t),this.hb=hr("retryDelaySeedMs",1e4,t),this.eb=hr("forwardChannelMaxRetries",2,t),this.xa=hr("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new xg(t&&t.concurrentRequestLimit),this.Ja=new I_,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}M=$g.prototype;M.ra=8;M.H=1;function dh(t){if(zg(t),t.H==3){var e=t.W++,i=Vi(t.I);if(Se(i,"SID",t.K),Se(i,"RID",e),Se(i,"TYPE","terminate"),wo(t,i),e=new go(t,t.l,e),e.L=2,e.v=ul(Vi(i)),i=!1,te.navigator&&te.navigator.sendBeacon)try{i=te.navigator.sendBeacon(e.v.toString(),"")}catch{}!i&&te.Image&&(new Image().src=e.v,i=!0),i||(e.g=Jg(e.l,null),e.g.ha(e.v)),e.G=Date.now(),vo(e)}Qg(t)}function fl(t){t.g&&(mh(t),t.g.cancel(),t.g=null)}function zg(t){fl(t),t.u&&(te.clearTimeout(t.u),t.u=null),Ca(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&te.clearTimeout(t.m),t.m=null)}function ml(t){if(!Dg(t.i)&&!t.m){t.m=!0;var e=t.Na;jr||dg(),qr||(jr(),qr=!0),nh.add(e,t),t.C=0}}function N_(t,e){return Mg(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=mo(yt(t.Na,t,e),Gg(t,t.C)),t.C++,!0)}M.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new go(this,this.l,t);let r=this.s;if(this.U&&(r?(r=sg(r),rg(r,this.U)):r=this.U),this.o!==null||this.O||(s.I=r,r=null),this.P)e:{for(var e=0,i=0;i<this.j.length;i++){t:{var n=this.j[i];if("__data__"in n.map&&(n=n.map.__data__,typeof n=="string")){n=n.length;break t}n=void 0}if(n===void 0)break;if(e+=n,4096<e){e=i;break e}if(e===4096||i===this.j.length-1){e=i+1;break e}}e=1e3}else e=1e3;e=jg(this,s,e),i=Vi(this.I),Se(i,"RID",t),Se(i,"CVER",22),this.F&&Se(i,"X-HTTP-Session-Id",this.F),wo(this,i),r&&(this.O?e="headers="+encodeURIComponent(String(Bg(r)))+"&"+e:this.o&&hh(i,this.o,r)),ch(this.i,s),this.bb&&Se(i,"TYPE","init"),this.P?(Se(i,"$req",e),Se(i,"SID","null"),s.aa=!0,tu(s,i,null)):tu(s,i,e),this.H=2}}else this.H==3&&(t?rf(this,t):this.j.length==0||Dg(this.i)||rf(this))};function rf(t,e){var i;e?i=e.m:i=t.W++;const n=Vi(t.I);Se(n,"SID",t.K),Se(n,"RID",i),Se(n,"AID",t.V),wo(t,n),t.o&&t.s&&hh(n,t.o,t.s),i=new go(t,t.l,i,t.C+1),t.o===null&&(i.I=t.s),e&&(t.j=e.F.concat(t.j)),e=jg(t,i,1e3),i.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),ch(t.i,i),tu(i,n,e)}function wo(t,e){t.na&&Ju(t.na,function(i,n){Se(e,n,i)}),t.h&&Sg({},function(i,n){Se(e,n,i)})}function jg(t,e,i){i=Math.min(t.j.length,i);var n=t.h?yt(t.h.Va,t.h,t):null;e:{var s=t.j;let r=-1;for(;;){const o=["count="+i];r==-1?0<i?(r=s[0].g,o.push("ofs="+r)):r=0:o.push("ofs="+r);let a=!0;for(let l=0;l<i;l++){let u=s[l].g;const c=s[l].map;if(u-=r,0>u)r=Math.max(0,s[l].g-100),a=!1;else try{A_(c,o,"req"+u+"_")}catch{n&&n(c)}}if(a){n=o.join("&");break e}}}return t=t.j.splice(0,i),e.F=t,n}function qg(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;jr||dg(),qr||(jr(),qr=!0),nh.add(e,t),t.A=0}}function fh(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=mo(yt(t.Ma,t),Gg(t,t.A)),t.A++,!0)}M.Ma=function(){if(this.u=null,Wg(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=mo(yt(this.jb,this),t)}};M.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,It(10),fl(this),Wg(this))};function mh(t){t.B!=null&&(te.clearTimeout(t.B),t.B=null)}function Wg(t){t.g=new go(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Vi(t.wa);Se(e,"RID","rpc"),Se(e,"SID",t.K),Se(e,"AID",t.V),Se(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Se(e,"TO",t.qa),Se(e,"TYPE","xmlhttp"),wo(t,e),t.o&&t.s&&hh(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var i=t.g;t=t.pa,i.L=1,i.v=ul(Vi(e)),i.s=null,i.S=!0,Tg(i,t)}M.ib=function(){this.v!=null&&(this.v=null,fl(this),fh(this),It(19))};function Ca(t){t.v!=null&&(te.clearTimeout(t.v),t.v=null)}function Kg(t,e){var i=null;if(t.g==e){Ca(t),mh(t),t.g=null;var n=2}else if(nu(t.i,e))i=e.F,Lg(t.i,e),n=1;else return;if(t.H!=0){if(e.i)if(n==1){i=e.s?e.s.length:0,e=Date.now()-e.G;var s=t.C;n=ol(),dt(n,new yg(n,i)),ml(t)}else qg(t);else if(s=e.o,s==3||s==0&&0<e.ca||!(n==1&&N_(t,e)||n==2&&fh(t)))switch(i&&0<i.length&&(e=t.i,e.i=e.i.concat(i)),s){case 1:_n(t,5);break;case 4:_n(t,10);break;case 3:_n(t,6);break;default:_n(t,2)}}}function Gg(t,e){let i=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(i*=2),i*e}function _n(t,e){if(t.l.info("Error code "+e),e==2){var i=null;t.h&&(i=null);var n=yt(t.pb,t);i||(i=new In("//www.google.com/images/cleardot.gif"),te.location&&te.location.protocol=="http"||Ta(i,"https"),ul(i)),P_(i.toString(),n)}else It(2);t.H=0,t.h&&t.h.za(e),Qg(t),zg(t)}M.pb=function(t){t?(this.l.info("Successfully pinged google.com"),It(2)):(this.l.info("Failed to ping google.com"),It(1))};function Qg(t){if(t.H=0,t.ma=[],t.h){const e=Ng(t.i);(e.length!=0||t.j.length!=0)&&(Gd(t.ma,e),Gd(t.ma,t.j),t.i.i.length=0,Qu(t.j),t.j.length=0),t.h.ya()}}function Yg(t,e,i){var n=i instanceof In?Vi(i):new In(i);if(n.g!="")e&&(n.g=e+"."+n.g),_a(n,n.m);else{var s=te.location;n=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var r=new In(null);n&&Ta(r,n),e&&(r.g=e),s&&_a(r,s),i&&(r.l=i),n=r}return i=t.F,e=t.Da,i&&e&&Se(n,i,e),Se(n,"VER",t.ra),wo(t,n),n}function Jg(t,e,i){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=i&&t.Ha&&!t.va?new He(new yo({ob:!0})):new He(t.va),e.Oa(t.J),e}M.isActive=function(){return!!this.h&&this.h.isActive(this)};function Xg(){}M=Xg.prototype;M.Ba=function(){};M.Aa=function(){};M.za=function(){};M.ya=function(){};M.isActive=function(){return!0};M.Va=function(){};function Ea(){if(ks&&!(10<=Number(GT)))throw Error("Environmental error: no available transport.")}Ea.prototype.g=function(t,e){return new $t(t,e)};function $t(t,e){nt.call(this),this.g=new $g(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!$r(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!$r(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Ns(this)}at($t,nt);$t.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,i=this.h||void 0;It(0),t.Y=e,t.na=i||{},t.G=t.aa,t.I=Yg(t,null,t.Y),ml(t)};$t.prototype.close=function(){dh(this.g)};$t.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var i={};i.__data__=t,t=i}else this.v&&(i={},i.__data__=ih(t),t=i);e.j.push(new C_(e.fb++,t)),e.H==3&&ml(e)};$t.prototype.N=function(){this.g.h=null,delete this.j,dh(this.g),delete this.g,$t.$.N.call(this)};function Zg(t){ah.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const i in e){t=i;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}at(Zg,ah);function ev(){lh.call(this),this.status=1}at(ev,lh);function Ns(t){this.g=t}at(Ns,Xg);Ns.prototype.Ba=function(){dt(this.g,"a")};Ns.prototype.Aa=function(t){dt(this.g,new Zg(t))};Ns.prototype.za=function(t){dt(this.g,new ev)};Ns.prototype.ya=function(){dt(this.g,"b")};function O_(){this.blockSize=-1}function ni(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}at(ni,O_);ni.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function gc(t,e,i){i||(i=0);var n=Array(16);if(typeof e=="string")for(var s=0;16>s;++s)n[s]=e.charCodeAt(i++)|e.charCodeAt(i++)<<8|e.charCodeAt(i++)<<16|e.charCodeAt(i++)<<24;else for(s=0;16>s;++s)n[s]=e[i++]|e[i++]<<8|e[i++]<<16|e[i++]<<24;e=t.g[0],i=t.g[1],s=t.g[2];var r=t.g[3],o=e+(r^i&(s^r))+n[0]+3614090360&4294967295;e=i+(o<<7&4294967295|o>>>25),o=r+(s^e&(i^s))+n[1]+3905402710&4294967295,r=e+(o<<12&4294967295|o>>>20),o=s+(i^r&(e^i))+n[2]+606105819&4294967295,s=r+(o<<17&4294967295|o>>>15),o=i+(e^s&(r^e))+n[3]+3250441966&4294967295,i=s+(o<<22&4294967295|o>>>10),o=e+(r^i&(s^r))+n[4]+4118548399&4294967295,e=i+(o<<7&4294967295|o>>>25),o=r+(s^e&(i^s))+n[5]+1200080426&4294967295,r=e+(o<<12&4294967295|o>>>20),o=s+(i^r&(e^i))+n[6]+2821735955&4294967295,s=r+(o<<17&4294967295|o>>>15),o=i+(e^s&(r^e))+n[7]+4249261313&4294967295,i=s+(o<<22&4294967295|o>>>10),o=e+(r^i&(s^r))+n[8]+1770035416&4294967295,e=i+(o<<7&4294967295|o>>>25),o=r+(s^e&(i^s))+n[9]+2336552879&4294967295,r=e+(o<<12&4294967295|o>>>20),o=s+(i^r&(e^i))+n[10]+4294925233&4294967295,s=r+(o<<17&4294967295|o>>>15),o=i+(e^s&(r^e))+n[11]+2304563134&4294967295,i=s+(o<<22&4294967295|o>>>10),o=e+(r^i&(s^r))+n[12]+1804603682&4294967295,e=i+(o<<7&4294967295|o>>>25),o=r+(s^e&(i^s))+n[13]+4254626195&4294967295,r=e+(o<<12&4294967295|o>>>20),o=s+(i^r&(e^i))+n[14]+2792965006&4294967295,s=r+(o<<17&4294967295|o>>>15),o=i+(e^s&(r^e))+n[15]+1236535329&4294967295,i=s+(o<<22&4294967295|o>>>10),o=e+(s^r&(i^s))+n[1]+4129170786&4294967295,e=i+(o<<5&4294967295|o>>>27),o=r+(i^s&(e^i))+n[6]+3225465664&4294967295,r=e+(o<<9&4294967295|o>>>23),o=s+(e^i&(r^e))+n[11]+643717713&4294967295,s=r+(o<<14&4294967295|o>>>18),o=i+(r^e&(s^r))+n[0]+3921069994&4294967295,i=s+(o<<20&4294967295|o>>>12),o=e+(s^r&(i^s))+n[5]+3593408605&4294967295,e=i+(o<<5&4294967295|o>>>27),o=r+(i^s&(e^i))+n[10]+38016083&4294967295,r=e+(o<<9&4294967295|o>>>23),o=s+(e^i&(r^e))+n[15]+3634488961&4294967295,s=r+(o<<14&4294967295|o>>>18),o=i+(r^e&(s^r))+n[4]+3889429448&4294967295,i=s+(o<<20&4294967295|o>>>12),o=e+(s^r&(i^s))+n[9]+568446438&4294967295,e=i+(o<<5&4294967295|o>>>27),o=r+(i^s&(e^i))+n[14]+3275163606&4294967295,r=e+(o<<9&4294967295|o>>>23),o=s+(e^i&(r^e))+n[3]+4107603335&4294967295,s=r+(o<<14&4294967295|o>>>18),o=i+(r^e&(s^r))+n[8]+1163531501&4294967295,i=s+(o<<20&4294967295|o>>>12),o=e+(s^r&(i^s))+n[13]+2850285829&4294967295,e=i+(o<<5&4294967295|o>>>27),o=r+(i^s&(e^i))+n[2]+4243563512&4294967295,r=e+(o<<9&4294967295|o>>>23),o=s+(e^i&(r^e))+n[7]+1735328473&4294967295,s=r+(o<<14&4294967295|o>>>18),o=i+(r^e&(s^r))+n[12]+2368359562&4294967295,i=s+(o<<20&4294967295|o>>>12),o=e+(i^s^r)+n[5]+4294588738&4294967295,e=i+(o<<4&4294967295|o>>>28),o=r+(e^i^s)+n[8]+2272392833&4294967295,r=e+(o<<11&4294967295|o>>>21),o=s+(r^e^i)+n[11]+1839030562&4294967295,s=r+(o<<16&4294967295|o>>>16),o=i+(s^r^e)+n[14]+4259657740&4294967295,i=s+(o<<23&4294967295|o>>>9),o=e+(i^s^r)+n[1]+2763975236&4294967295,e=i+(o<<4&4294967295|o>>>28),o=r+(e^i^s)+n[4]+1272893353&4294967295,r=e+(o<<11&4294967295|o>>>21),o=s+(r^e^i)+n[7]+4139469664&4294967295,s=r+(o<<16&4294967295|o>>>16),o=i+(s^r^e)+n[10]+3200236656&4294967295,i=s+(o<<23&4294967295|o>>>9),o=e+(i^s^r)+n[13]+681279174&4294967295,e=i+(o<<4&4294967295|o>>>28),o=r+(e^i^s)+n[0]+3936430074&4294967295,r=e+(o<<11&4294967295|o>>>21),o=s+(r^e^i)+n[3]+3572445317&4294967295,s=r+(o<<16&4294967295|o>>>16),o=i+(s^r^e)+n[6]+76029189&4294967295,i=s+(o<<23&4294967295|o>>>9),o=e+(i^s^r)+n[9]+3654602809&4294967295,e=i+(o<<4&4294967295|o>>>28),o=r+(e^i^s)+n[12]+3873151461&4294967295,r=e+(o<<11&4294967295|o>>>21),o=s+(r^e^i)+n[15]+530742520&4294967295,s=r+(o<<16&4294967295|o>>>16),o=i+(s^r^e)+n[2]+3299628645&4294967295,i=s+(o<<23&4294967295|o>>>9),o=e+(s^(i|~r))+n[0]+4096336452&4294967295,e=i+(o<<6&4294967295|o>>>26),o=r+(i^(e|~s))+n[7]+1126891415&4294967295,r=e+(o<<10&4294967295|o>>>22),o=s+(e^(r|~i))+n[14]+2878612391&4294967295,s=r+(o<<15&4294967295|o>>>17),o=i+(r^(s|~e))+n[5]+4237533241&4294967295,i=s+(o<<21&4294967295|o>>>11),o=e+(s^(i|~r))+n[12]+1700485571&4294967295,e=i+(o<<6&4294967295|o>>>26),o=r+(i^(e|~s))+n[3]+2399980690&4294967295,r=e+(o<<10&4294967295|o>>>22),o=s+(e^(r|~i))+n[10]+4293915773&4294967295,s=r+(o<<15&4294967295|o>>>17),o=i+(r^(s|~e))+n[1]+2240044497&4294967295,i=s+(o<<21&4294967295|o>>>11),o=e+(s^(i|~r))+n[8]+1873313359&4294967295,e=i+(o<<6&4294967295|o>>>26),o=r+(i^(e|~s))+n[15]+4264355552&4294967295,r=e+(o<<10&4294967295|o>>>22),o=s+(e^(r|~i))+n[6]+2734768916&4294967295,s=r+(o<<15&4294967295|o>>>17),o=i+(r^(s|~e))+n[13]+1309151649&4294967295,i=s+(o<<21&4294967295|o>>>11),o=e+(s^(i|~r))+n[4]+4149444226&4294967295,e=i+(o<<6&4294967295|o>>>26),o=r+(i^(e|~s))+n[11]+3174756917&4294967295,r=e+(o<<10&4294967295|o>>>22),o=s+(e^(r|~i))+n[2]+718787259&4294967295,s=r+(o<<15&4294967295|o>>>17),o=i+(r^(s|~e))+n[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+r&4294967295}ni.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var i=e-this.blockSize,n=this.m,s=this.h,r=0;r<e;){if(s==0)for(;r<=i;)gc(this,t,r),r+=this.blockSize;if(typeof t=="string"){for(;r<e;)if(n[s++]=t.charCodeAt(r++),s==this.blockSize){gc(this,n),s=0;break}}else for(;r<e;)if(n[s++]=t[r++],s==this.blockSize){gc(this,n),s=0;break}}this.h=s,this.i+=e};ni.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var i=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=i&255,i/=256;for(this.j(t),t=Array(16),e=i=0;4>e;++e)for(var n=0;32>n;n+=8)t[i++]=this.g[e]>>>n&255;return t};function be(t,e){this.h=e;for(var i=[],n=!0,s=t.length-1;0<=s;s--){var r=t[s]|0;n&&r==e||(i[s]=r,n=!1)}this.g=i}var V_={};function ph(t){return-128<=t&&128>t?qT(t,function(e){return new be([e|0],0>e?-1:0)}):new be([t|0],0>t?-1:0)}function di(t){if(isNaN(t)||!isFinite(t))return fs;if(0>t)return ht(di(-t));for(var e=[],i=1,n=0;t>=i;n++)e[n]=t/i|0,i*=su;return new be(e,0)}function tv(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return ht(tv(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=di(Math.pow(e,8)),n=fs,s=0;s<t.length;s+=8){var r=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+r),e);8>r?(r=di(Math.pow(e,r)),n=n.R(r).add(di(o))):(n=n.R(i),n=n.add(di(o)))}return n}var su=4294967296,fs=ph(0),ru=ph(1),of=ph(16777216);M=be.prototype;M.ea=function(){if(Kt(this))return-ht(this).ea();for(var t=0,e=1,i=0;i<this.g.length;i++){var n=this.D(i);t+=(0<=n?n:su+n)*e,e*=su}return t};M.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Mi(this))return"0";if(Kt(this))return"-"+ht(this).toString(t);for(var e=di(Math.pow(t,6)),i=this,n="";;){var s=Ia(i,e).g;i=Sa(i,s.R(e));var r=((0<i.g.length?i.g[0]:i.h)>>>0).toString(t);if(i=s,Mi(i))return r+n;for(;6>r.length;)r="0"+r;n=r+n}};M.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Mi(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Kt(t){return t.h==-1}M.X=function(t){return t=Sa(this,t),Kt(t)?-1:Mi(t)?0:1};function ht(t){for(var e=t.g.length,i=[],n=0;n<e;n++)i[n]=~t.g[n];return new be(i,~t.h).add(ru)}M.abs=function(){return Kt(this)?ht(this):this};M.add=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0,s=0;s<=e;s++){var r=n+(this.D(s)&65535)+(t.D(s)&65535),o=(r>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);n=o>>>16,r&=65535,o&=65535,i[s]=o<<16|r}return new be(i,i[i.length-1]&-2147483648?-1:0)};function Sa(t,e){return t.add(ht(e))}M.R=function(t){if(Mi(this)||Mi(t))return fs;if(Kt(this))return Kt(t)?ht(this).R(ht(t)):ht(ht(this).R(t));if(Kt(t))return ht(this.R(ht(t)));if(0>this.X(of)&&0>t.X(of))return di(this.ea()*t.ea());for(var e=this.g.length+t.g.length,i=[],n=0;n<2*e;n++)i[n]=0;for(n=0;n<this.g.length;n++)for(var s=0;s<t.g.length;s++){var r=this.D(n)>>>16,o=this.D(n)&65535,a=t.D(s)>>>16,l=t.D(s)&65535;i[2*n+2*s]+=o*l,$o(i,2*n+2*s),i[2*n+2*s+1]+=r*l,$o(i,2*n+2*s+1),i[2*n+2*s+1]+=o*a,$o(i,2*n+2*s+1),i[2*n+2*s+2]+=r*a,$o(i,2*n+2*s+2)}for(n=0;n<e;n++)i[n]=i[2*n+1]<<16|i[2*n];for(n=e;n<2*e;n++)i[n]=0;return new be(i,0)};function $o(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function dr(t,e){this.g=t,this.h=e}function Ia(t,e){if(Mi(e))throw Error("division by zero");if(Mi(t))return new dr(fs,fs);if(Kt(t))return e=Ia(ht(t),e),new dr(ht(e.g),ht(e.h));if(Kt(e))return e=Ia(t,ht(e)),new dr(ht(e.g),e.h);if(30<t.g.length){if(Kt(t)||Kt(e))throw Error("slowDivide_ only works with positive integers.");for(var i=ru,n=e;0>=n.X(t);)i=af(i),n=af(n);var s=Qn(i,1),r=Qn(n,1);for(n=Qn(n,2),i=Qn(i,2);!Mi(n);){var o=r.add(n);0>=o.X(t)&&(s=s.add(i),r=o),n=Qn(n,1),i=Qn(i,1)}return e=Sa(t,s.R(e)),new dr(s,e)}for(s=fs;0<=t.X(e);){for(i=Math.max(1,Math.floor(t.ea()/e.ea())),n=Math.ceil(Math.log(i)/Math.LN2),n=48>=n?1:Math.pow(2,n-48),r=di(i),o=r.R(e);Kt(o)||0<o.X(t);)i-=n,r=di(i),o=r.R(e);Mi(r)&&(r=ru),s=s.add(r),t=Sa(t,o)}return new dr(s,t)}M.gb=function(t){return Ia(this,t).h};M.and=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)&t.D(n);return new be(i,this.h&t.h)};M.or=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)|t.D(n);return new be(i,this.h|t.h)};M.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)^t.D(n);return new be(i,this.h^t.h)};function af(t){for(var e=t.g.length+1,i=[],n=0;n<e;n++)i[n]=t.D(n)<<1|t.D(n-1)>>>31;return new be(i,t.h)}function Qn(t,e){var i=e>>5;e%=32;for(var n=t.g.length-i,s=[],r=0;r<n;r++)s[r]=0<e?t.D(r+i)>>>e|t.D(r+i+1)<<32-e:t.D(r+i);return new be(s,t.h)}Ea.prototype.createWebChannel=Ea.prototype.g;$t.prototype.send=$t.prototype.u;$t.prototype.open=$t.prototype.m;$t.prototype.close=$t.prototype.close;al.NO_ERROR=0;al.TIMEOUT=8;al.HTTP_ERROR=6;bg.COMPLETE="complete";wg.EventType=po;po.OPEN="a";po.CLOSE="b";po.ERROR="c";po.MESSAGE="d";nt.prototype.listen=nt.prototype.O;He.prototype.listenOnce=He.prototype.P;He.prototype.getLastError=He.prototype.Sa;He.prototype.getLastErrorCode=He.prototype.Ia;He.prototype.getStatus=He.prototype.da;He.prototype.getResponseJson=He.prototype.Wa;He.prototype.getResponseText=He.prototype.ja;He.prototype.send=He.prototype.ha;He.prototype.setWithCredentials=He.prototype.Oa;ni.prototype.digest=ni.prototype.l;ni.prototype.reset=ni.prototype.reset;ni.prototype.update=ni.prototype.j;be.prototype.add=be.prototype.add;be.prototype.multiply=be.prototype.R;be.prototype.modulo=be.prototype.gb;be.prototype.compare=be.prototype.X;be.prototype.toNumber=be.prototype.ea;be.prototype.toString=be.prototype.toString;be.prototype.getBits=be.prototype.D;be.fromNumber=di;be.fromString=tv;var F_=function(){return new Ea},U_=function(){return ol()},vc=al,H_=bg,B_=Bn,lf={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},$_=yo,zo=wg,z_=He,j_=ni,ms=be;const cf="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pt.UNAUTHENTICATED=new pt(null),pt.GOOGLE_CREDENTIALS=new pt("google-credentials-uid"),pt.FIRST_PARTY=new pt("first-party-uid"),pt.MOCK_USER=new pt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Os="9.23.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ln=new Nu("@firebase/firestore");function uf(){return Ln.logLevel}function H(t,...e){if(Ln.logLevel<=fe.DEBUG){const i=e.map(gh);Ln.debug(`Firestore (${Os}): ${t}`,...i)}}function Fi(t,...e){if(Ln.logLevel<=fe.ERROR){const i=e.map(gh);Ln.error(`Firestore (${Os}): ${t}`,...i)}}function Ts(t,...e){if(Ln.logLevel<=fe.WARN){const i=e.map(gh);Ln.warn(`Firestore (${Os}): ${t}`,...i)}}function gh(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K(t="Unexpected state"){const e=`FIRESTORE (${Os}) INTERNAL ASSERTION FAILED: `+t;throw Fi(e),new Error(e)}function ye(t,e){t||K()}function ne(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class L extends Ti{constructor(e,i){super(e,i),this.code=e,this.message=i,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(){this.promise=new Promise((e,i)=>{this.resolve=e,this.reject=i})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,i){this.user=i,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class q_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,i){e.enqueueRetryable(()=>i(pt.UNAUTHENTICATED))}shutdown(){}}class W_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,i){this.changeListener=i,e.enqueueRetryable(()=>i(this.token.user))}shutdown(){this.changeListener=null}}class K_{constructor(e){this.t=e,this.currentUser=pt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,i){let n=this.i;const s=l=>this.i!==n?(n=this.i,i(l)):Promise.resolve();let r=new vi;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new vi,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=r;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{H("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(H("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new vi)}},0),o()}getToken(){const e=this.i,i=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(i).then(n=>this.i!==e?(H("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ye(typeof n.accessToken=="string"),new iv(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ye(e===null||typeof e=="string"),new pt(e)}}class G_{constructor(e,i,n){this.h=e,this.l=i,this.m=n,this.type="FirstParty",this.user=pt.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class Q_{constructor(e,i,n){this.h=e,this.l=i,this.m=n}getToken(){return Promise.resolve(new G_(this.h,this.l,this.m))}start(e,i){e.enqueueRetryable(()=>i(pt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Y_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class J_{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,i){const n=r=>{r.error!=null&&H("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.T;return this.T=r.token,H("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?i(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>n(r))};const s=r=>{H("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.appCheck.addTokenListener(this.o)};this.I.onInit(r=>s(r)),setTimeout(()=>{if(!this.appCheck){const r=this.I.getImmediate({optional:!0});r?s(r):H("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(i=>i?(ye(typeof i.token=="string"),this.T=i.token,new Y_(i.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X_(t){const e=typeof self!="undefined"&&(self.crypto||self.msCrypto),i=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(i);else for(let n=0;n<t;n++)i[n]=Math.floor(256*Math.random());return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=X_(40);for(let r=0;r<s.length;++r)n.length<20&&s[r]<i&&(n+=e.charAt(s[r]%e.length))}return n}}function pe(t,e){return t<e?-1:t>e?1:0}function _s(t,e,i){return t.length===e.length&&t.every((n,s)=>i(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e,i){if(this.seconds=e,this.nanoseconds=i,i<0)throw new L(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(i>=1e9)throw new L(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(e<-62135596800)throw new L(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ge.fromMillis(Date.now())}static fromDate(e){return Ge.fromMillis(e.getTime())}static fromMillis(e){const i=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*i));return new Ge(i,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?pe(this.nanoseconds,e.nanoseconds):pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.timestamp=e}static fromTimestamp(e){return new J(e)}static min(){return new J(new Ge(0,0))}static max(){return new J(new Ge(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e,i,n){i===void 0?i=0:i>e.length&&K(),n===void 0?n=e.length-i:n>e.length-i&&K(),this.segments=e,this.offset=i,this.len=n}get length(){return this.len}isEqual(e){return Yr.comparator(this,e)===0}child(e){const i=this.segments.slice(this.offset,this.limit());return e instanceof Yr?e.forEach(n=>{i.push(n)}):i.push(e),this.construct(i)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==e.get(i))return!1;return!0}forEach(e){for(let i=this.offset,n=this.limit();i<n;i++)e(this.segments[i])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,i){const n=Math.min(e.length,i.length);for(let s=0;s<n;s++){const r=e.get(s),o=i.get(s);if(r<o)return-1;if(r>o)return 1}return e.length<i.length?-1:e.length>i.length?1:0}}class Ie extends Yr{construct(e,i,n){return new Ie(e,i,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const i=[];for(const n of e){if(n.indexOf("//")>=0)throw new L(E.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);i.push(...n.split("/").filter(s=>s.length>0))}return new Ie(i)}static emptyPath(){return new Ie([])}}const Z_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gt extends Yr{construct(e,i,n){return new gt(e,i,n)}static isValidIdentifier(e){return Z_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new gt(["__name__"])}static fromServerFormat(e){const i=[];let n="",s=0;const r=()=>{if(n.length===0)throw new L(E.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);i.push(n),n=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new L(E.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new L(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(n+=a,s++):(r(),s++)}if(r(),o)throw new L(E.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gt(i)}static emptyPath(){return new gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.path=e}static fromPath(e){return new z(Ie.fromString(e))}static fromName(e){return new z(Ie.fromString(e).popFirst(5))}static empty(){return new z(Ie.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ie.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,i){return Ie.comparator(e.path,i.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new z(new Ie(e.slice()))}}function e1(t,e){const i=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=J.fromTimestamp(n===1e9?new Ge(i+1,0):new Ge(i,n));return new on(s,z.empty(),e)}function t1(t){return new on(t.readTime,t.key,-1)}class on{constructor(e,i,n){this.readTime=e,this.documentKey=i,this.largestBatchId=n}static min(){return new on(J.min(),z.empty(),-1)}static max(){return new on(J.max(),z.empty(),-1)}}function i1(t,e){let i=t.readTime.compareTo(e.readTime);return i!==0?i:(i=z.comparator(t.documentKey,e.documentKey),i!==0?i:pe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class s1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ko(t){if(t.code!==E.FAILED_PRECONDITION||t.message!==n1)throw t;H("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(i=>{this.isDone=!0,this.result=i,this.nextCallback&&this.nextCallback(i)},i=>{this.isDone=!0,this.error=i,this.catchCallback&&this.catchCallback(i)})}catch(e){return this.next(void 0,e)}next(e,i){return this.callbackAttached&&K(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(e,this.result):new A((n,s)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(n,s)},this.catchCallback=r=>{this.wrapFailure(i,r).next(n,s)}})}toPromise(){return new Promise((e,i)=>{this.next(e,i)})}wrapUserFunction(e){try{const i=e();return i instanceof A?i:A.resolve(i)}catch(i){return A.reject(i)}}wrapSuccess(e,i){return e?this.wrapUserFunction(()=>e(i)):A.resolve(i)}wrapFailure(e,i){return e?this.wrapUserFunction(()=>e(i)):A.reject(i)}static resolve(e){return new A((i,n)=>{i(e)})}static reject(e){return new A((i,n)=>{n(e)})}static waitFor(e){return new A((i,n)=>{let s=0,r=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++r,o&&r===s&&i()},l=>n(l))}),o=!0,r===s&&i()})}static or(e){let i=A.resolve(!1);for(const n of e)i=i.next(s=>s?A.resolve(s):n());return i}static forEach(e,i){const n=[];return e.forEach((s,r)=>{n.push(i.call(this,s,r))}),this.waitFor(n)}static mapArray(e,i){return new A((n,s)=>{const r=e.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const u=l;i(e[u]).next(c=>{o[u]=c,++a,a===r&&n(o)},c=>s(c))}})}static doWhile(e,i){return new A((n,s)=>{const r=()=>{e()===!0?i().next(()=>{r()},s):n()};r()})}}function To(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,i){this.previousValue=e,i&&(i.sequenceNumberHandler=n=>this.ot(n),this.ut=n=>i.writeSequenceNumber(n))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}vh.ct=-1;function _o(t){return t==null}function Aa(t){return t===0&&1/t==-1/0}function r1(t){return typeof t=="number"&&Number.isInteger(t)&&!Aa(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(t){let e=0;for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&e++;return e}function $n(t,e){for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&e(i,t[i])}function sv(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e,i){this.comparator=e,this.root=i||ut.EMPTY}insert(e,i){return new Ve(this.comparator,this.root.insert(e,i,this.comparator).copy(null,null,ut.BLACK,null,null))}remove(e){return new Ve(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ut.BLACK,null,null))}get(e){let i=this.root;for(;!i.isEmpty();){const n=this.comparator(e,i.key);if(n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}indexOf(e){let i=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return i+n.left.size;s<0?n=n.left:(i+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((i,n)=>(e(i,n),!1))}toString(){const e=[];return this.inorderTraversal((i,n)=>(e.push(`${i}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new jo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new jo(this.root,e,this.comparator,!1)}getReverseIterator(){return new jo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new jo(this.root,e,this.comparator,!0)}}class jo{constructor(e,i,n,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=i?n(e.key,i):1,i&&s&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const i={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return i}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ut{constructor(e,i,n,s,r){this.key=e,this.value=i,this.color=n!=null?n:ut.RED,this.left=s!=null?s:ut.EMPTY,this.right=r!=null?r:ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,i,n,s,r){return new ut(e!=null?e:this.key,i!=null?i:this.value,n!=null?n:this.color,s!=null?s:this.left,r!=null?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,i,n){let s=this;const r=n(e,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(e,i,n),null):r===0?s.copy(null,i,null,null,null):s.copy(null,null,null,null,s.right.insert(e,i,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ut.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,i){let n,s=this;if(i(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,i),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),i(e,s.key)===0){if(s.right.isEmpty())return ut.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,i))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,i)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw K();const e=this.left.check();if(e!==this.right.check())throw K();return e+(this.isRed()?0:1)}}ut.EMPTY=null,ut.RED=!0,ut.BLACK=!1;ut.EMPTY=new class{constructor(){this.size=0}get key(){throw K()}get value(){throw K()}get color(){throw K()}get left(){throw K()}get right(){throw K()}copy(t,e,i,n,s){return this}insert(t,e,i){return new ut(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.comparator=e,this.data=new Ve(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((i,n)=>(e(i),!1))}forEachInRange(e,i){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;i(s.key)}}forEachWhile(e,i){let n;for(n=i!==void 0?this.data.getIteratorFrom(i):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const i=this.data.getIteratorFrom(e);return i.hasNext()?i.getNext().key:null}getIterator(){return new df(this.data.getIterator())}getIteratorFrom(e){return new df(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let i=this;return i.size<e.size&&(i=e,e=this),e.forEach(n=>{i=i.add(n)}),i}isEqual(e){if(!(e instanceof wt)||this.size!==e.size)return!1;const i=this.data.getIterator(),n=e.data.getIterator();for(;i.hasNext();){const s=i.getNext().key,r=n.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(i=>{e.push(i)}),e}toString(){const e=[];return this.forEach(i=>e.push(i)),"SortedSet("+e.toString()+")"}copy(e){const i=new wt(this.comparator);return i.data=e,i}}class df{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.fields=e,e.sort(gt.comparator)}static empty(){return new Ft([])}unionWith(e){let i=new wt(gt.comparator);for(const n of this.fields)i=i.add(n);for(const n of e)i=i.add(n);return new Ft(i.toArray())}covers(e){for(const i of this.fields)if(i.isPrefixOf(e))return!0;return!1}isEqual(e){return _s(this.fields,e.fields,(i,n)=>i.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.binaryString=e}static fromBase64String(e){const i=function(n){try{return atob(n)}catch(s){throw typeof DOMException!="undefined"&&s instanceof DOMException?new rv("Invalid base64 string: "+s):s}}(e);return new Tt(i)}static fromUint8Array(e){const i=function(n){let s="";for(let r=0;r<n.length;++r)s+=String.fromCharCode(n[r]);return s}(e);return new Tt(i)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const i=new Uint8Array(e.length);for(let n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Tt.EMPTY_BYTE_STRING=new Tt("");const o1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function an(t){if(ye(!!t),typeof t=="string"){let e=0;const i=o1.exec(t);if(ye(!!i),i[1]){let s=i[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:qe(t.seconds),nanos:qe(t.nanos)}}function qe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Nn(t){return typeof t=="string"?Tt.fromBase64String(t):Tt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yh(t){var e,i;return((i=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||i===void 0?void 0:i.stringValue)==="server_timestamp"}function bh(t){const e=t.mapValue.fields.__previous_value__;return yh(e)?bh(e):e}function Jr(t){const e=an(t.mapValue.fields.__local_write_time__.timestampValue);return new Ge(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(e,i,n,s,r,o,a,l,u){this.databaseId=e,this.appId=i,this.persistenceKey=n,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Xr{constructor(e,i){this.projectId=e,this.database=i||"(default)"}static empty(){return new Xr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Xr&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function On(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yh(t)?4:l1(t)?9007199254740991:10:K()}function yi(t,e){if(t===e)return!0;const i=On(t);if(i!==On(e))return!1;switch(i){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jr(t).isEqual(Jr(e));case 3:return function(n,s){if(typeof n.timestampValue=="string"&&typeof s.timestampValue=="string"&&n.timestampValue.length===s.timestampValue.length)return n.timestampValue===s.timestampValue;const r=an(n.timestampValue),o=an(s.timestampValue);return r.seconds===o.seconds&&r.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(n,s){return Nn(n.bytesValue).isEqual(Nn(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(n,s){return qe(n.geoPointValue.latitude)===qe(s.geoPointValue.latitude)&&qe(n.geoPointValue.longitude)===qe(s.geoPointValue.longitude)}(t,e);case 2:return function(n,s){if("integerValue"in n&&"integerValue"in s)return qe(n.integerValue)===qe(s.integerValue);if("doubleValue"in n&&"doubleValue"in s){const r=qe(n.doubleValue),o=qe(s.doubleValue);return r===o?Aa(r)===Aa(o):isNaN(r)&&isNaN(o)}return!1}(t,e);case 9:return _s(t.arrayValue.values||[],e.arrayValue.values||[],yi);case 10:return function(n,s){const r=n.mapValue.fields||{},o=s.mapValue.fields||{};if(hf(r)!==hf(o))return!1;for(const a in r)if(r.hasOwnProperty(a)&&(o[a]===void 0||!yi(r[a],o[a])))return!1;return!0}(t,e);default:return K()}}function Zr(t,e){return(t.values||[]).find(i=>yi(i,e))!==void 0}function Cs(t,e){if(t===e)return 0;const i=On(t),n=On(e);if(i!==n)return pe(i,n);switch(i){case 0:case 9007199254740991:return 0;case 1:return pe(t.booleanValue,e.booleanValue);case 2:return function(s,r){const o=qe(s.integerValue||s.doubleValue),a=qe(r.integerValue||r.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return ff(t.timestampValue,e.timestampValue);case 4:return ff(Jr(t),Jr(e));case 5:return pe(t.stringValue,e.stringValue);case 6:return function(s,r){const o=Nn(s),a=Nn(r);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,r){const o=s.split("/"),a=r.split("/");for(let l=0;l<o.length&&l<a.length;l++){const u=pe(o[l],a[l]);if(u!==0)return u}return pe(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,r){const o=pe(qe(s.latitude),qe(r.latitude));return o!==0?o:pe(qe(s.longitude),qe(r.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,r){const o=s.values||[],a=r.values||[];for(let l=0;l<o.length&&l<a.length;++l){const u=Cs(o[l],a[l]);if(u)return u}return pe(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,r){if(s===qo.mapValue&&r===qo.mapValue)return 0;if(s===qo.mapValue)return 1;if(r===qo.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),l=r.fields||{},u=Object.keys(l);a.sort(),u.sort();for(let c=0;c<a.length&&c<u.length;++c){const h=pe(a[c],u[c]);if(h!==0)return h;const d=Cs(o[a[c]],l[u[c]]);if(d!==0)return d}return pe(a.length,u.length)}(t.mapValue,e.mapValue);default:throw K()}}function ff(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return pe(t,e);const i=an(t),n=an(e),s=pe(i.seconds,n.seconds);return s!==0?s:pe(i.nanos,n.nanos)}function Es(t){return ou(t)}function ou(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const s=an(n);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Nn(t.bytesValue).toBase64():"referenceValue"in t?(i=t.referenceValue,z.fromName(i).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(n){let s="[",r=!0;for(const o of n.values||[])r?r=!1:s+=",",s+=ou(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(n){const s=Object.keys(n.fields||{}).sort();let r="{",o=!0;for(const a of s)o?o=!1:r+=",",r+=`${a}:${ou(n.fields[a])}`;return r+"}"}(t.mapValue):K();var e,i}function mf(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function au(t){return!!t&&"integerValue"in t}function wh(t){return!!t&&"arrayValue"in t}function pf(t){return!!t&&"nullValue"in t}function gf(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function sa(t){return!!t&&"mapValue"in t}function Pr(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return $n(t.mapValue.fields,(i,n)=>e.mapValue.fields[i]=Pr(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let i=0;i<(t.arrayValue.values||[]).length;++i)e.arrayValue.values[i]=Pr(t.arrayValue.values[i]);return e}return Object.assign({},t)}function l1(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.value=e}static empty(){return new Et({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let i=this.value;for(let n=0;n<e.length-1;++n)if(i=(i.mapValue.fields||{})[e.get(n)],!sa(i))return null;return i=(i.mapValue.fields||{})[e.lastSegment()],i||null}}set(e,i){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pr(i)}setAll(e){let i=gt.emptyPath(),n={},s=[];e.forEach((o,a)=>{if(!i.isImmediateParentOf(a)){const l=this.getFieldsMap(i);this.applyChanges(l,n,s),n={},s=[],i=a.popLast()}o?n[a.lastSegment()]=Pr(o):s.push(a.lastSegment())});const r=this.getFieldsMap(i);this.applyChanges(r,n,s)}delete(e){const i=this.field(e.popLast());sa(i)&&i.mapValue.fields&&delete i.mapValue.fields[e.lastSegment()]}isEqual(e){return yi(this.value,e.value)}getFieldsMap(e){let i=this.value;i.mapValue.fields||(i.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=i.mapValue.fields[e.get(n)];sa(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},i.mapValue.fields[e.get(n)]=s),i=s}return i.mapValue.fields}applyChanges(e,i,n){$n(i,(s,r)=>e[s]=r);for(const s of n)delete e[s]}clone(){return new Et(Pr(this.value))}}function ov(t){const e=[];return $n(t.fields,(i,n)=>{const s=new gt([i]);if(sa(n)){const r=ov(n.mapValue).fields;if(r.length===0)e.push(s);else for(const o of r)e.push(s.child(o))}else e.push(s)}),new Ft(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,i,n,s,r,o,a){this.key=e,this.documentType=i,this.version=n,this.readTime=s,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(e){return new it(e,0,J.min(),J.min(),J.min(),Et.empty(),0)}static newFoundDocument(e,i,n,s){return new it(e,1,i,J.min(),n,s,0)}static newNoDocument(e,i){return new it(e,2,i,J.min(),J.min(),Et.empty(),0)}static newUnknownDocument(e,i){return new it(e,3,i,J.min(),J.min(),Et.empty(),2)}convertToFoundDocument(e,i){return!this.createTime.isEqual(J.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=i,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Et.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Et.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof it&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new it(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,i){this.position=e,this.inclusive=i}}function vf(t,e,i){let n=0;for(let s=0;s<t.position.length;s++){const r=e[s],o=t.position[s];if(r.field.isKeyField()?n=z.comparator(z.fromName(o.referenceValue),i.key):n=Cs(o,i.data.field(r.field)),r.dir==="desc"&&(n*=-1),n!==0)break}return n}function yf(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let i=0;i<t.position.length;i++)if(!yi(t.position[i],e.position[i]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,i="asc"){this.field=e,this.dir=i}}function c1(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{}class We extends av{constructor(e,i,n){super(),this.field=e,this.op=i,this.value=n}static create(e,i,n){return e.isKeyField()?i==="in"||i==="not-in"?this.createKeyFieldInFilter(e,i,n):new h1(e,i,n):i==="array-contains"?new m1(e,n):i==="in"?new p1(e,n):i==="not-in"?new g1(e,n):i==="array-contains-any"?new v1(e,n):new We(e,i,n)}static createKeyFieldInFilter(e,i,n){return i==="in"?new d1(e,n):new f1(e,n)}matches(e){const i=e.data.field(this.field);return this.op==="!="?i!==null&&this.matchesComparison(Cs(i,this.value)):i!==null&&On(this.value)===On(i)&&this.matchesComparison(Cs(i,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return K()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class si extends av{constructor(e,i){super(),this.filters=e,this.op=i,this.lt=null}static create(e,i){return new si(e,i)}matches(e){return lv(this)?this.filters.find(i=>!i.matches(e))===void 0:this.filters.find(i=>i.matches(e))!==void 0}getFlattenedFilters(){return this.lt!==null||(this.lt=this.filters.reduce((e,i)=>e.concat(i.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(i=>i.isInequality());return e!==null?e.field:null}ft(e){for(const i of this.getFlattenedFilters())if(e(i))return i;return null}}function lv(t){return t.op==="and"}function cv(t){return u1(t)&&lv(t)}function u1(t){for(const e of t.filters)if(e instanceof si)return!1;return!0}function lu(t){if(t instanceof We)return t.field.canonicalString()+t.op.toString()+Es(t.value);if(cv(t))return t.filters.map(e=>lu(e)).join(",");{const e=t.filters.map(i=>lu(i)).join(",");return`${t.op}(${e})`}}function uv(t,e){return t instanceof We?function(i,n){return n instanceof We&&i.op===n.op&&i.field.isEqual(n.field)&&yi(i.value,n.value)}(t,e):t instanceof si?function(i,n){return n instanceof si&&i.op===n.op&&i.filters.length===n.filters.length?i.filters.reduce((s,r,o)=>s&&uv(r,n.filters[o]),!0):!1}(t,e):void K()}function hv(t){return t instanceof We?function(e){return`${e.field.canonicalString()} ${e.op} ${Es(e.value)}`}(t):t instanceof si?function(e){return e.op.toString()+" {"+e.getFilters().map(hv).join(" ,")+"}"}(t):"Filter"}class h1 extends We{constructor(e,i,n){super(e,i,n),this.key=z.fromName(n.referenceValue)}matches(e){const i=z.comparator(e.key,this.key);return this.matchesComparison(i)}}class d1 extends We{constructor(e,i){super(e,"in",i),this.keys=dv("in",i)}matches(e){return this.keys.some(i=>i.isEqual(e.key))}}class f1 extends We{constructor(e,i){super(e,"not-in",i),this.keys=dv("not-in",i)}matches(e){return!this.keys.some(i=>i.isEqual(e.key))}}function dv(t,e){var i;return(((i=e.arrayValue)===null||i===void 0?void 0:i.values)||[]).map(n=>z.fromName(n.referenceValue))}class m1 extends We{constructor(e,i){super(e,"array-contains",i)}matches(e){const i=e.data.field(this.field);return wh(i)&&Zr(i.arrayValue,this.value)}}class p1 extends We{constructor(e,i){super(e,"in",i)}matches(e){const i=e.data.field(this.field);return i!==null&&Zr(this.value.arrayValue,i)}}class g1 extends We{constructor(e,i){super(e,"not-in",i)}matches(e){if(Zr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const i=e.data.field(this.field);return i!==null&&!Zr(this.value.arrayValue,i)}}class v1 extends We{constructor(e,i){super(e,"array-contains-any",i)}matches(e){const i=e.data.field(this.field);return!(!wh(i)||!i.arrayValue.values)&&i.arrayValue.values.some(n=>Zr(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e,i=null,n=[],s=[],r=null,o=null,a=null){this.path=e,this.collectionGroup=i,this.orderBy=n,this.filters=s,this.limit=r,this.startAt=o,this.endAt=a,this.dt=null}}function bf(t,e=null,i=[],n=[],s=null,r=null,o=null){return new y1(t,e,i,n,s,r,o)}function kh(t){const e=ne(t);if(e.dt===null){let i=e.path.canonicalString();e.collectionGroup!==null&&(i+="|cg:"+e.collectionGroup),i+="|f:",i+=e.filters.map(n=>lu(n)).join(","),i+="|ob:",i+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),_o(e.limit)||(i+="|l:",i+=e.limit),e.startAt&&(i+="|lb:",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(n=>Es(n)).join(",")),e.endAt&&(i+="|ub:",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(n=>Es(n)).join(",")),e.dt=i}return e.dt}function Th(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<t.orderBy.length;i++)if(!c1(t.orderBy[i],e.orderBy[i]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(!uv(t.filters[i],e.filters[i]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!yf(t.startAt,e.startAt)&&yf(t.endAt,e.endAt)}function cu(t){return z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e,i=null,n=[],s=[],r=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=i,this.explicitOrderBy=n,this.filters=s,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.wt=null,this._t=null,this.startAt,this.endAt}}function b1(t,e,i,n,s,r,o,a){return new Vs(t,e,i,n,s,r,o,a)}function pl(t){return new Vs(t)}function wf(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function _h(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function gl(t){for(const e of t.filters){const i=e.getFirstInequalityField();if(i!==null)return i}return null}function fv(t){return t.collectionGroup!==null}function gs(t){const e=ne(t);if(e.wt===null){e.wt=[];const i=gl(e),n=_h(e);if(i!==null&&n===null)i.isKeyField()||e.wt.push(new ps(i)),e.wt.push(new ps(gt.keyField(),"asc"));else{let s=!1;for(const r of e.explicitOrderBy)e.wt.push(r),r.field.isKeyField()&&(s=!0);if(!s){const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new ps(gt.keyField(),r))}}}return e.wt}function Ui(t){const e=ne(t);if(!e._t)if(e.limitType==="F")e._t=bf(e.path,e.collectionGroup,gs(e),e.filters,e.limit,e.startAt,e.endAt);else{const i=[];for(const r of gs(e)){const o=r.dir==="desc"?"asc":"desc";i.push(new ps(r.field,o))}const n=e.endAt?new Pa(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new Pa(e.startAt.position,e.startAt.inclusive):null;e._t=bf(e.path,e.collectionGroup,i,e.filters,e.limit,n,s)}return e._t}function uu(t,e){e.getFirstInequalityField(),gl(t);const i=t.filters.concat([e]);return new Vs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),i,t.limit,t.limitType,t.startAt,t.endAt)}function hu(t,e,i){return new Vs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,i,t.startAt,t.endAt)}function vl(t,e){return Th(Ui(t),Ui(e))&&t.limitType===e.limitType}function mv(t){return`${kh(Ui(t))}|lt:${t.limitType}`}function du(t){return`Query(target=${function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map(n=>hv(n)).join(", ")}]`),_o(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map(n=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(n)).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(n=>Es(n)).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(n=>Es(n)).join(",")),`Target(${i})`}(Ui(t))}; limitType=${t.limitType})`}function yl(t,e){return e.isFoundDocument()&&function(i,n){const s=n.key.path;return i.collectionGroup!==null?n.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):z.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(t,e)&&function(i,n){for(const s of gs(i))if(!s.field.isKeyField()&&n.data.field(s.field)===null)return!1;return!0}(t,e)&&function(i,n){for(const s of i.filters)if(!s.matches(n))return!1;return!0}(t,e)&&function(i,n){return!(i.startAt&&!function(s,r,o){const a=vf(s,r,o);return s.inclusive?a<=0:a<0}(i.startAt,gs(i),n)||i.endAt&&!function(s,r,o){const a=vf(s,r,o);return s.inclusive?a>=0:a>0}(i.endAt,gs(i),n))}(t,e)}function w1(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function pv(t){return(e,i)=>{let n=!1;for(const s of gs(t)){const r=k1(s,e,i);if(r!==0)return r;n=n||s.field.isKeyField()}return 0}}function k1(t,e,i){const n=t.field.isKeyField()?z.comparator(e.key,i.key):function(s,r,o){const a=r.data.field(s),l=o.data.field(s);return a!==null&&l!==null?Cs(a,l):K()}(t.field,e,i);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return K()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,i){this.mapKeyFn=e,this.equalsFn=i,this.inner={},this.innerSize=0}get(e){const i=this.mapKeyFn(e),n=this.inner[i];if(n!==void 0){for(const[s,r]of n)if(this.equalsFn(s,e))return r}}has(e){return this.get(e)!==void 0}set(e,i){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,i]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return void(s[r]=[e,i]);s.push([e,i]),this.innerSize++}delete(e){const i=this.mapKeyFn(e),n=this.inner[i];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[i]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){$n(this.inner,(i,n)=>{for(const[s,r]of n)e(s,r)})}isEmpty(){return sv(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1=new Ve(z.comparator);function Hi(){return T1}const gv=new Ve(z.comparator);function Tr(...t){let e=gv;for(const i of t)e=e.insert(i.key,i);return e}function vv(t){let e=gv;return t.forEach((i,n)=>e=e.insert(i,n.overlayedDocument)),e}function Cn(){return Rr()}function yv(){return Rr()}function Rr(){return new Fs(t=>t.toString(),(t,e)=>t.isEqual(e))}const _1=new Ve(z.comparator),C1=new wt(z.comparator);function le(...t){let e=C1;for(const i of t)e=e.add(i);return e}const E1=new wt(pe);function S1(){return E1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Aa(e)?"-0":e}}function wv(t){return{integerValue:""+t}}function I1(t,e){return r1(e)?wv(e):bv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(){this._=void 0}}function A1(t,e,i){return t instanceof eo?function(n,s){const r={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return s&&yh(s)&&(s=bh(s)),s&&(r.fields.__previous_value__=s),{mapValue:r}}(i,e):t instanceof to?Tv(t,e):t instanceof io?_v(t,e):function(n,s){const r=kv(n,s),o=kf(r)+kf(n.gt);return au(r)&&au(n.gt)?wv(o):bv(n.serializer,o)}(t,e)}function P1(t,e,i){return t instanceof to?Tv(t,e):t instanceof io?_v(t,e):i}function kv(t,e){return t instanceof Ra?au(i=e)||function(n){return!!n&&"doubleValue"in n}(i)?e:{integerValue:0}:null;var i}class eo extends bl{}class to extends bl{constructor(e){super(),this.elements=e}}function Tv(t,e){const i=Cv(e);for(const n of t.elements)i.some(s=>yi(s,n))||i.push(n);return{arrayValue:{values:i}}}class io extends bl{constructor(e){super(),this.elements=e}}function _v(t,e){let i=Cv(e);for(const n of t.elements)i=i.filter(s=>!yi(s,n));return{arrayValue:{values:i}}}class Ra extends bl{constructor(e,i){super(),this.serializer=e,this.gt=i}}function kf(t){return qe(t.integerValue||t.doubleValue)}function Cv(t){return wh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e,i){this.field=e,this.transform=i}}function x1(t,e){return t.field.isEqual(e.field)&&function(i,n){return i instanceof to&&n instanceof to||i instanceof io&&n instanceof io?_s(i.elements,n.elements,yi):i instanceof Ra&&n instanceof Ra?yi(i.gt,n.gt):i instanceof eo&&n instanceof eo}(t.transform,e.transform)}class D1{constructor(e,i){this.version=e,this.transformResults=i}}class vt{constructor(e,i){this.updateTime=e,this.exists=i}static none(){return new vt}static exists(e){return new vt(void 0,e)}static updateTime(e){return new vt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ra(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class wl{}function Ev(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ch(t.key,vt.none()):new Co(t.key,t.data,vt.none());{const i=t.data,n=Et.empty();let s=new wt(gt.comparator);for(let r of e.fields)if(!s.has(r)){let o=i.field(r);o===null&&r.length>1&&(r=r.popLast(),o=i.field(r)),o===null?n.delete(r):n.set(r,o),s=s.add(r)}return new hn(t.key,n,new Ft(s.toArray()),vt.none())}}function M1(t,e,i){t instanceof Co?function(n,s,r){const o=n.value.clone(),a=_f(n.fieldTransforms,s,r.transformResults);o.setAll(a),s.convertToFoundDocument(r.version,o).setHasCommittedMutations()}(t,e,i):t instanceof hn?function(n,s,r){if(!ra(n.precondition,s))return void s.convertToUnknownDocument(r.version);const o=_f(n.fieldTransforms,s,r.transformResults),a=s.data;a.setAll(Sv(n)),a.setAll(o),s.convertToFoundDocument(r.version,a).setHasCommittedMutations()}(t,e,i):function(n,s,r){s.convertToNoDocument(r.version).setHasCommittedMutations()}(0,e,i)}function xr(t,e,i,n){return t instanceof Co?function(s,r,o,a){if(!ra(s.precondition,r))return o;const l=s.value.clone(),u=Cf(s.fieldTransforms,a,r);return l.setAll(u),r.convertToFoundDocument(r.version,l).setHasLocalMutations(),null}(t,e,i,n):t instanceof hn?function(s,r,o,a){if(!ra(s.precondition,r))return o;const l=Cf(s.fieldTransforms,a,r),u=r.data;return u.setAll(Sv(s)),u.setAll(l),r.convertToFoundDocument(r.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(c=>c.field))}(t,e,i,n):function(s,r,o){return ra(s.precondition,r)?(r.convertToNoDocument(r.version).setHasLocalMutations(),null):o}(t,e,i)}function L1(t,e){let i=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),r=kv(n.transform,s||null);r!=null&&(i===null&&(i=Et.empty()),i.set(n.field,r))}return i||null}function Tf(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(i,n){return i===void 0&&n===void 0||!(!i||!n)&&_s(i,n,(s,r)=>x1(s,r))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Co extends wl{constructor(e,i,n,s=[]){super(),this.key=e,this.value=i,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class hn extends wl{constructor(e,i,n,s,r=[]){super(),this.key=e,this.data=i,this.fieldMask=n,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Sv(t){const e=new Map;return t.fieldMask.fields.forEach(i=>{if(!i.isEmpty()){const n=t.data.field(i);e.set(i,n)}}),e}function _f(t,e,i){const n=new Map;ye(t.length===i.length);for(let s=0;s<i.length;s++){const r=t[s],o=r.transform,a=e.data.field(r.field);n.set(r.field,P1(o,a,i[s]))}return n}function Cf(t,e,i){const n=new Map;for(const s of t){const r=s.transform,o=i.data.field(s.field);n.set(s.field,A1(r,o,e))}return n}class Ch extends wl{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Iv extends wl{constructor(e,i){super(),this.key=e,this.precondition=i,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(e,i,n,s){this.batchId=e,this.localWriteTime=i,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,i){const n=i.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(e.key)&&M1(r,e,n[s])}}applyToLocalView(e,i){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(i=xr(n,e,i,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(i=xr(n,e,i,this.localWriteTime));return i}applyToLocalDocumentSet(e,i){const n=yv();return this.mutations.forEach(s=>{const r=e.get(s.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=i.has(s.key)?null:a;const l=Ev(o,a);l!==null&&n.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(J.min())}),n}keys(){return this.mutations.reduce((e,i)=>e.add(i.key),le())}isEqual(e){return this.batchId===e.batchId&&_s(this.mutations,e.mutations,(i,n)=>Tf(i,n))&&_s(this.baseMutations,e.baseMutations,(i,n)=>Tf(i,n))}}class Eh{constructor(e,i,n,s){this.batch=e,this.commitVersion=i,this.mutationResults=n,this.docVersions=s}static from(e,i,n){ye(e.mutations.length===n.length);let s=_1;const r=e.mutations;for(let o=0;o<r.length;o++)s=s.insert(r[o].key,n[o].version);return new Eh(e,i,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e,i){this.largestBatchId=e,this.mutation=i}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,i){this.count=e,this.unchangedNames=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var je,ce;function Av(t){switch(t){default:return K();case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0}}function Pv(t){if(t===void 0)return Fi("GRPC error has no .code"),E.UNKNOWN;switch(t){case je.OK:return E.OK;case je.CANCELLED:return E.CANCELLED;case je.UNKNOWN:return E.UNKNOWN;case je.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case je.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case je.INTERNAL:return E.INTERNAL;case je.UNAVAILABLE:return E.UNAVAILABLE;case je.UNAUTHENTICATED:return E.UNAUTHENTICATED;case je.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case je.NOT_FOUND:return E.NOT_FOUND;case je.ALREADY_EXISTS:return E.ALREADY_EXISTS;case je.PERMISSION_DENIED:return E.PERMISSION_DENIED;case je.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case je.ABORTED:return E.ABORTED;case je.OUT_OF_RANGE:return E.OUT_OF_RANGE;case je.UNIMPLEMENTED:return E.UNIMPLEMENTED;case je.DATA_LOSS:return E.DATA_LOSS;default:return K()}}(ce=je||(je={}))[ce.OK=0]="OK",ce[ce.CANCELLED=1]="CANCELLED",ce[ce.UNKNOWN=2]="UNKNOWN",ce[ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ce[ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ce[ce.NOT_FOUND=5]="NOT_FOUND",ce[ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",ce[ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",ce[ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",ce[ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ce[ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ce[ce.ABORTED=10]="ABORTED",ce[ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",ce[ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",ce[ce.INTERNAL=13]="INTERNAL",ce[ce.UNAVAILABLE=14]="UNAVAILABLE",ce[ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Wo}static getOrCreateInstance(){return Wo===null&&(Wo=new Sh),Wo}onExistenceFilterMismatch(e){const i=Symbol();return this.onExistenceFilterMismatchCallbacks.set(i,e),()=>this.onExistenceFilterMismatchCallbacks.delete(i)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(i=>i(e))}}let Wo=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U1=new ms([4294967295,4294967295],0);function Ef(t){const e=F1().encode(t),i=new j_;return i.update(e),new Uint8Array(i.digest())}function Sf(t){const e=new DataView(t.buffer),i=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new ms([i,n],0),new ms([s,r],0)]}class Ih{constructor(e,i,n){if(this.bitmap=e,this.padding=i,this.hashCount=n,i<0||i>=8)throw new _r(`Invalid padding: ${i}`);if(n<0)throw new _r(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new _r(`Invalid hash count: ${n}`);if(e.length===0&&i!==0)throw new _r(`Invalid padding when bitmap length is 0: ${i}`);this.It=8*e.length-i,this.Tt=ms.fromNumber(this.It)}Et(e,i,n){let s=e.add(i.multiply(ms.fromNumber(n)));return s.compare(U1)===1&&(s=new ms([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Tt).toNumber()}At(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}vt(e){if(this.It===0)return!1;const i=Ef(e),[n,s]=Sf(i);for(let r=0;r<this.hashCount;r++){const o=this.Et(n,s,r);if(!this.At(o))return!1}return!0}static create(e,i,n){const s=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new Ih(r,s,i);return n.forEach(a=>o.insert(a)),o}insert(e){if(this.It===0)return;const i=Ef(e),[n,s]=Sf(i);for(let r=0;r<this.hashCount;r++){const o=this.Et(n,s,r);this.Rt(o)}}Rt(e){const i=Math.floor(e/8),n=e%8;this.bitmap[i]|=1<<n}}class _r extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,i,n,s,r){this.snapshotVersion=e,this.targetChanges=i,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,i,n){const s=new Map;return s.set(e,Eo.createSynthesizedTargetChangeForCurrentChange(e,i,n)),new kl(J.min(),s,new Ve(pe),Hi(),le())}}class Eo{constructor(e,i,n,s,r){this.resumeToken=e,this.current=i,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,i,n){return new Eo(n,i,le(),le(),le())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(e,i,n,s){this.Pt=e,this.removedTargetIds=i,this.key=n,this.bt=s}}class Rv{constructor(e,i){this.targetId=e,this.Vt=i}}class xv{constructor(e,i,n=Tt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=i,this.resumeToken=n,this.cause=s}}class If{constructor(){this.St=0,this.Dt=Pf(),this.Ct=Tt.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return this.St!==0}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=le(),i=le(),n=le();return this.Dt.forEach((s,r)=>{switch(r){case 0:e=e.add(s);break;case 2:i=i.add(s);break;case 1:n=n.add(s);break;default:K()}}),new Eo(this.Ct,this.xt,e,i,n)}Ft(){this.Nt=!1,this.Dt=Pf()}Bt(e,i){this.Nt=!0,this.Dt=this.Dt.insert(e,i)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class H1{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Hi(),this.zt=Af(),this.Wt=new Ve(pe)}Ht(e){for(const i of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(i,e.bt):this.Yt(i,e.key,e.bt);for(const i of e.removedTargetIds)this.Yt(i,e.key,e.bt)}Xt(e){this.forEachTarget(e,i=>{const n=this.Zt(i);switch(e.state){case 0:this.te(i)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(i);break;case 3:this.te(i)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(i)&&(this.ee(i),n.$t(e.resumeToken));break;default:K()}})}forEachTarget(e,i){e.targetIds.length>0?e.targetIds.forEach(i):this.Qt.forEach((n,s)=>{this.te(s)&&i(s)})}ne(e){var i;const n=e.targetId,s=e.Vt.count,r=this.se(n);if(r){const o=r.target;if(cu(o))if(s===0){const a=new z(o.path);this.Yt(n,a,it.newNoDocument(a,J.min()))}else ye(s===1);else{const a=this.ie(n);if(a!==s){const l=this.re(e,a);if(l!==0){this.ee(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,u)}(i=Sh.instance)===null||i===void 0||i.notifyOnExistenceFilterMismatch(function(u,c,h){var d,f,p,T,v,S;const O={localCacheCount:c,existenceFilterCount:h.count},I=h.unchangedNames;return I&&(O.bloomFilter={applied:u===0,hashCount:(d=I==null?void 0:I.hashCount)!==null&&d!==void 0?d:0,bitmapLength:(T=(p=(f=I==null?void 0:I.bits)===null||f===void 0?void 0:f.bitmap)===null||p===void 0?void 0:p.length)!==null&&T!==void 0?T:0,padding:(S=(v=I==null?void 0:I.bits)===null||v===void 0?void 0:v.padding)!==null&&S!==void 0?S:0}),O}(l,a,e.Vt))}}}}re(e,i){const{unchangedNames:n,count:s}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:r="",padding:o=0},hashCount:a=0}=n;let l,u;try{l=Nn(r).toUint8Array()}catch(c){if(c instanceof rv)return Ts("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw c}try{u=new Ih(l,o,a)}catch(c){return Ts(c instanceof _r?"BloomFilter error: ":"Applying bloom filter failed: ",c),1}return u.It===0?1:s!==i-this.oe(e.targetId,u)?2:0}oe(e,i){const n=this.Gt.getRemoteKeysForTarget(e);let s=0;return n.forEach(r=>{const o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;i.vt(a)||(this.Yt(e,r,null),s++)}),s}ce(e){const i=new Map;this.Qt.forEach((r,o)=>{const a=this.se(o);if(a){if(r.current&&cu(a.target)){const l=new z(a.target.path);this.jt.get(l)!==null||this.ae(o,l)||this.Yt(o,l,it.newNoDocument(l,e))}r.Mt&&(i.set(o,r.Ot()),r.Ft())}});let n=le();this.zt.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.se(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(r))}),this.jt.forEach((r,o)=>o.setReadTime(e));const s=new kl(e,i,this.Wt,this.jt,n);return this.jt=Hi(),this.zt=Af(),this.Wt=new Ve(pe),s}Jt(e,i){if(!this.te(e))return;const n=this.ae(e,i.key)?2:0;this.Zt(e).Bt(i.key,n),this.jt=this.jt.insert(i.key,i),this.zt=this.zt.insert(i.key,this.he(i.key).add(e))}Yt(e,i,n){if(!this.te(e))return;const s=this.Zt(e);this.ae(e,i)?s.Bt(i,1):s.Lt(i),this.zt=this.zt.insert(i,this.he(i).delete(e)),n&&(this.jt=this.jt.insert(i,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const i=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+i.addedDocuments.size-i.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let i=this.Qt.get(e);return i||(i=new If,this.Qt.set(e,i)),i}he(e){let i=this.zt.get(e);return i||(i=new wt(pe),this.zt=this.zt.insert(e,i)),i}te(e){const i=this.se(e)!==null;return i||H("WatchChangeAggregator","Detected inactive target",e),i}se(e){const i=this.Qt.get(e);return i&&i.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new If),this.Gt.getRemoteKeysForTarget(e).forEach(i=>{this.Yt(e,i,null)})}ae(e,i){return this.Gt.getRemoteKeysForTarget(e).has(i)}}function Af(){return new Ve(z.comparator)}function Pf(){return new Ve(z.comparator)}const B1=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),$1=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),z1=(()=>({and:"AND",or:"OR"}))();class j1{constructor(e,i){this.databaseId=e,this.useProto3Json=i}}function fu(t,e){return t.useProto3Json||_o(e)?e:{value:e}}function xa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Dv(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function q1(t,e){return xa(t,e.toTimestamp())}function Ut(t){return ye(!!t),J.fromTimestamp(function(e){const i=an(e);return new Ge(i.seconds,i.nanos)}(t))}function Ah(t,e){return function(i){return new Ie(["projects",i.projectId,"databases",i.database])}(t).child("documents").child(e).canonicalString()}function Mv(t){const e=Ie.fromString(t);return ye(Fv(e)),e}function Da(t,e){return Ah(t.databaseId,e.path)}function Dr(t,e){const i=Mv(e);if(i.get(1)!==t.databaseId.projectId)throw new L(E.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+i.get(1)+" vs "+t.databaseId.projectId);if(i.get(3)!==t.databaseId.database)throw new L(E.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+i.get(3)+" vs "+t.databaseId.database);return new z(Lv(i))}function mu(t,e){return Ah(t.databaseId,e)}function W1(t){const e=Mv(t);return e.length===4?Ie.emptyPath():Lv(e)}function no(t){return new Ie(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Lv(t){return ye(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Rf(t,e,i){return{name:Da(t,e),fields:i.value.mapValue.fields}}function K1(t,e){return"found"in e?function(i,n){ye(!!n.found),n.found.name,n.found.updateTime;const s=Dr(i,n.found.name),r=Ut(n.found.updateTime),o=n.found.createTime?Ut(n.found.createTime):J.min(),a=new Et({mapValue:{fields:n.found.fields}});return it.newFoundDocument(s,r,o,a)}(t,e):"missing"in e?function(i,n){ye(!!n.missing),ye(!!n.readTime);const s=Dr(i,n.missing),r=Ut(n.readTime);return it.newNoDocument(s,r)}(t,e):K()}function G1(t,e){let i;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:K()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],r=function(l,u){return l.useProto3Json?(ye(u===void 0||typeof u=="string"),Tt.fromBase64String(u||"")):(ye(u===void 0||u instanceof Uint8Array),Tt.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const u=l.code===void 0?E.UNKNOWN:Pv(l.code);return new L(u,l.message||"")}(o);i=new xv(n,s,r,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Dr(t,n.document.name),r=Ut(n.document.updateTime),o=n.document.createTime?Ut(n.document.createTime):J.min(),a=new Et({mapValue:{fields:n.document.fields}}),l=it.newFoundDocument(s,r,o,a),u=n.targetIds||[],c=n.removedTargetIds||[];i=new oa(u,c,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Dr(t,n.document),r=n.readTime?Ut(n.readTime):J.min(),o=it.newNoDocument(s,r),a=n.removedTargetIds||[];i=new oa([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Dr(t,n.document),r=n.removedTargetIds||[];i=new oa([],r,s,null)}else{if(!("filter"in e))return K();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:r}=n,o=new V1(s,r),a=n.targetId;i=new Rv(a,o)}}return i}function Nv(t,e){let i;if(e instanceof Co)i={update:Rf(t,e.key,e.value)};else if(e instanceof Ch)i={delete:Da(t,e.key)};else if(e instanceof hn)i={update:Rf(t,e.key,e.data),updateMask:nC(e.fieldMask)};else{if(!(e instanceof Iv))return K();i={verify:Da(t,e.key)}}return e.fieldTransforms.length>0&&(i.updateTransforms=e.fieldTransforms.map(n=>function(s,r){const o=r.transform;if(o instanceof eo)return{fieldPath:r.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof to)return{fieldPath:r.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof io)return{fieldPath:r.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Ra)return{fieldPath:r.field.canonicalString(),increment:o.gt};throw K()}(0,n))),e.precondition.isNone||(i.currentDocument=function(n,s){return s.updateTime!==void 0?{updateTime:q1(n,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:K()}(t,e.precondition)),i}function Q1(t,e){return t&&t.length>0?(ye(e!==void 0),t.map(i=>function(n,s){let r=n.updateTime?Ut(n.updateTime):Ut(s);return r.isEqual(J.min())&&(r=Ut(s)),new D1(r,n.transformResults||[])}(i,e))):[]}function Y1(t,e){return{documents:[mu(t,e.path)]}}function J1(t,e){const i={structuredQuery:{}},n=e.path;e.collectionGroup!==null?(i.parent=mu(t,n),i.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i.parent=mu(t,n.popLast()),i.structuredQuery.from=[{collectionId:n.lastSegment()}]);const s=function(l){if(l.length!==0)return Vv(si.create(l,"and"))}(e.filters);s&&(i.structuredQuery.where=s);const r=function(l){if(l.length!==0)return l.map(u=>function(c){return{field:es(c.field),direction:eC(c.dir)}}(u))}(e.orderBy);r&&(i.structuredQuery.orderBy=r);const o=fu(t,e.limit);var a;return o!==null&&(i.structuredQuery.limit=o),e.startAt&&(i.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(i.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),i}function X1(t){let e=W1(t.parent);const i=t.structuredQuery,n=i.from?i.from.length:0;let s=null;if(n>0){ye(n===1);const c=i.from[0];c.allDescendants?s=c.collectionId:e=e.child(c.collectionId)}let r=[];i.where&&(r=function(c){const h=Ov(c);return h instanceof si&&cv(h)?h.getFilters():[h]}(i.where));let o=[];i.orderBy&&(o=i.orderBy.map(c=>function(h){return new ps(ts(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(c)));let a=null;i.limit&&(a=function(c){let h;return h=typeof c=="object"?c.value:c,_o(h)?null:h}(i.limit));let l=null;i.startAt&&(l=function(c){const h=!!c.before,d=c.values||[];return new Pa(d,h)}(i.startAt));let u=null;return i.endAt&&(u=function(c){const h=!c.before,d=c.values||[];return new Pa(d,h)}(i.endAt)),b1(e,s,o,r,a,"F",l,u)}function Z1(t,e){const i=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return K()}}(e.purpose);return i==null?null:{"goog-listen-tags":i}}function Ov(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=ts(e.unaryFilter.field);return We.create(i,"==",{doubleValue:NaN});case"IS_NULL":const n=ts(e.unaryFilter.field);return We.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ts(e.unaryFilter.field);return We.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=ts(e.unaryFilter.field);return We.create(r,"!=",{nullValue:"NULL_VALUE"});default:return K()}}(t):t.fieldFilter!==void 0?function(e){return We.create(ts(e.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return K()}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return si.create(e.compositeFilter.filters.map(i=>Ov(i)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return K()}}(e.compositeFilter.op))}(t):K()}function eC(t){return B1[t]}function tC(t){return $1[t]}function iC(t){return z1[t]}function es(t){return{fieldPath:t.canonicalString()}}function ts(t){return gt.fromServerFormat(t.fieldPath)}function Vv(t){return t instanceof We?function(e){if(e.op==="=="){if(gf(e.value))return{unaryFilter:{field:es(e.field),op:"IS_NAN"}};if(pf(e.value))return{unaryFilter:{field:es(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(gf(e.value))return{unaryFilter:{field:es(e.field),op:"IS_NOT_NAN"}};if(pf(e.value))return{unaryFilter:{field:es(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:es(e.field),op:tC(e.op),value:e.value}}}(t):t instanceof si?function(e){const i=e.getFilters().map(n=>Vv(n));return i.length===1?i[0]:{compositeFilter:{op:iC(e.op),filters:i}}}(t):K()}function nC(t){const e=[];return t.fields.forEach(i=>e.push(i.canonicalString())),{fieldPaths:e}}function Fv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,i,n,s,r=J.min(),o=J.min(),a=Tt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=i,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,i){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,i,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(e){this.fe=e}}function rC(t){const e=X1({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?hu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(){this.rn=new aC}addToCollectionParentIndex(e,i){return this.rn.add(i),A.resolve()}getCollectionParents(e,i){return A.resolve(this.rn.getEntries(i))}addFieldIndex(e,i){return A.resolve()}deleteFieldIndex(e,i){return A.resolve()}getDocumentsMatchingTarget(e,i){return A.resolve(null)}getIndexType(e,i){return A.resolve(0)}getFieldIndexes(e,i){return A.resolve([])}getNextCollectionGroupToUpdate(e){return A.resolve(null)}getMinOffset(e,i){return A.resolve(on.min())}getMinOffsetFromCollectionGroup(e,i){return A.resolve(on.min())}updateCollectionGroup(e,i,n){return A.resolve()}updateIndexEntries(e,i){return A.resolve()}}class aC{constructor(){this.index={}}add(e){const i=e.lastSegment(),n=e.popLast(),s=this.index[i]||new wt(Ie.comparator),r=!s.has(n);return this.index[i]=s.add(n),r}has(e){const i=e.lastSegment(),n=e.popLast(),s=this.index[i];return s&&s.has(n)}getEntries(e){return(this.index[e]||new wt(Ie.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Ss(0)}static Mn(){return new Ss(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(){this.changes=new Fs(e=>e.toString(),(e,i)=>e.isEqual(i)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,i){this.assertNotApplied(),this.changes.set(e,it.newInvalidDocument(e).setReadTime(i))}getEntry(e,i){this.assertNotApplied();const n=this.changes.get(i);return n!==void 0?A.resolve(n):this.getFromCache(e,i)}getEntries(e,i){return this.getAllFromCache(e,i)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(e,i){this.overlayedDocument=e,this.mutatedFields=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e,i,n,s){this.remoteDocumentCache=e,this.mutationQueue=i,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,i){let n=null;return this.documentOverlayCache.getOverlay(e,i).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,i))).next(s=>(n!==null&&xr(n.mutation,s,Ft.empty(),Ge.now()),s))}getDocuments(e,i){return this.remoteDocumentCache.getEntries(e,i).next(n=>this.getLocalViewOfDocuments(e,n,le()).next(()=>n))}getLocalViewOfDocuments(e,i,n=le()){const s=Cn();return this.populateOverlays(e,s,i).next(()=>this.computeViews(e,i,s,n).next(r=>{let o=Tr();return r.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,i){const n=Cn();return this.populateOverlays(e,n,i).next(()=>this.computeViews(e,i,n,le()))}populateOverlays(e,i,n){const s=[];return n.forEach(r=>{i.has(r)||s.push(r)}),this.documentOverlayCache.getOverlays(e,s).next(r=>{r.forEach((o,a)=>{i.set(o,a)})})}computeViews(e,i,n,s){let r=Hi();const o=Rr(),a=Rr();return i.forEach((l,u)=>{const c=n.get(u.key);s.has(u.key)&&(c===void 0||c.mutation instanceof hn)?r=r.insert(u.key,u):c!==void 0?(o.set(u.key,c.mutation.getFieldMask()),xr(c.mutation,u,c.mutation.getFieldMask(),Ge.now())):o.set(u.key,Ft.empty())}),this.recalculateAndSaveOverlays(e,r).next(l=>(l.forEach((u,c)=>o.set(u,c)),i.forEach((u,c)=>{var h;return a.set(u,new cC(c,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,i){const n=Rr();let s=new Ve((o,a)=>o-a),r=le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,i).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=i.get(l);if(u===null)return;let c=n.get(l)||Ft.empty();c=a.applyToLocalView(u,c),n.set(l,c);const h=(s.get(a.batchId)||le()).add(l);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,c=l.value,h=yv();c.forEach(d=>{if(!r.has(d)){const f=Ev(i.get(d),n.get(d));f!==null&&h.set(d,f),r=r.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return A.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,i){return this.remoteDocumentCache.getEntries(e,i).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,i,n){return function(s){return z.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(i)?this.getDocumentsMatchingDocumentQuery(e,i.path):fv(i)?this.getDocumentsMatchingCollectionGroupQuery(e,i,n):this.getDocumentsMatchingCollectionQuery(e,i,n)}getNextDocuments(e,i,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,i,n,s).next(r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,i,n.largestBatchId,s-r.size):A.resolve(Cn());let a=-1,l=r;return o.next(u=>A.forEach(u,(c,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),r.get(c)?A.resolve():this.remoteDocumentCache.getEntry(e,c).next(d=>{l=l.insert(c,d)}))).next(()=>this.populateOverlays(e,u,r)).next(()=>this.computeViews(e,l,u,le())).next(c=>({batchId:a,changes:vv(c)})))})}getDocumentsMatchingDocumentQuery(e,i){return this.getDocument(e,new z(i)).next(n=>{let s=Tr();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,i,n){const s=i.collectionGroup;let r=Tr();return this.indexManager.getCollectionParents(e,s).next(o=>A.forEach(o,a=>{const l=function(u,c){return new Vs(c,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(i,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,n).next(u=>{u.forEach((c,h)=>{r=r.insert(c,h)})})}).next(()=>r))}getDocumentsMatchingCollectionQuery(e,i,n){let s;return this.documentOverlayCache.getOverlaysForCollection(e,i.path,n.largestBatchId).next(r=>(s=r,this.remoteDocumentCache.getDocumentsMatchingQuery(e,i,n,s))).next(r=>{s.forEach((a,l)=>{const u=l.getKey();r.get(u)===null&&(r=r.insert(u,it.newInvalidDocument(u)))});let o=Tr();return r.forEach((a,l)=>{const u=s.get(a);u!==void 0&&xr(u.mutation,l,Ft.empty(),Ge.now()),yl(i,l)&&(o=o.insert(a,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,i){return A.resolve(this.cs.get(i))}saveBundleMetadata(e,i){var n;return this.cs.set(i.id,{id:(n=i).id,version:n.version,createTime:Ut(n.createTime)}),A.resolve()}getNamedQuery(e,i){return A.resolve(this.hs.get(i))}saveNamedQuery(e,i){return this.hs.set(i.name,function(n){return{name:n.name,query:rC(n.bundledQuery),readTime:Ut(n.readTime)}}(i)),A.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(){this.overlays=new Ve(z.comparator),this.ls=new Map}getOverlay(e,i){return A.resolve(this.overlays.get(i))}getOverlays(e,i){const n=Cn();return A.forEach(i,s=>this.getOverlay(e,s).next(r=>{r!==null&&n.set(s,r)})).next(()=>n)}saveOverlays(e,i,n){return n.forEach((s,r)=>{this.we(e,i,r)}),A.resolve()}removeOverlaysForBatchId(e,i,n){const s=this.ls.get(n);return s!==void 0&&(s.forEach(r=>this.overlays=this.overlays.remove(r)),this.ls.delete(n)),A.resolve()}getOverlaysForCollection(e,i,n){const s=Cn(),r=i.length+1,o=new z(i.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!i.isPrefixOf(u.path))break;u.path.length===r&&l.largestBatchId>n&&s.set(l.getKey(),l)}return A.resolve(s)}getOverlaysForCollectionGroup(e,i,n,s){let r=new Ve((u,c)=>u-c);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===i&&u.largestBatchId>n){let c=r.get(u.largestBatchId);c===null&&(c=Cn(),r=r.insert(u.largestBatchId,c)),c.set(u.getKey(),u)}}const a=Cn(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,c)=>a.set(u,c)),!(a.size()>=s)););return A.resolve(a)}we(e,i,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.ls.get(s.largestBatchId).delete(n.key);this.ls.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new O1(i,n));let r=this.ls.get(i);r===void 0&&(r=le(),this.ls.set(i,r)),this.ls.set(i,r.add(n.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(){this.fs=new wt(tt.ds),this.ws=new wt(tt._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,i){const n=new tt(e,i);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,i){e.forEach(n=>this.addReference(n,i))}removeReference(e,i){this.ys(new tt(e,i))}ps(e,i){e.forEach(n=>this.removeReference(n,i))}Is(e){const i=new z(new Ie([])),n=new tt(i,e),s=new tt(i,e+1),r=[];return this.ws.forEachInRange([n,s],o=>{this.ys(o),r.push(o.key)}),r}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const i=new z(new Ie([])),n=new tt(i,e),s=new tt(i,e+1);let r=le();return this.ws.forEachInRange([n,s],o=>{r=r.add(o.key)}),r}containsKey(e){const i=new tt(e,0),n=this.fs.firstAfterOrEqual(i);return n!==null&&e.isEqual(n.key)}}class tt{constructor(e,i){this.key=e,this.As=i}static ds(e,i){return z.comparator(e.key,i.key)||pe(e.As,i.As)}static _s(e,i){return pe(e.As,i.As)||z.comparator(e.key,i.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(e,i){this.indexManager=e,this.referenceDelegate=i,this.mutationQueue=[],this.vs=1,this.Rs=new wt(tt.ds)}checkEmpty(e){return A.resolve(this.mutationQueue.length===0)}addMutationBatch(e,i,n,s){const r=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new N1(r,i,n,s);this.mutationQueue.push(o);for(const a of s)this.Rs=this.Rs.add(new tt(a.key,r)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return A.resolve(o)}lookupMutationBatch(e,i){return A.resolve(this.Ps(i))}getNextMutationBatchAfterBatchId(e,i){const n=i+1,s=this.bs(n),r=s<0?0:s;return A.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return A.resolve(this.mutationQueue.length===0?-1:this.vs-1)}getAllMutationBatches(e){return A.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,i){const n=new tt(i,0),s=new tt(i,Number.POSITIVE_INFINITY),r=[];return this.Rs.forEachInRange([n,s],o=>{const a=this.Ps(o.As);r.push(a)}),A.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,i){let n=new wt(pe);return i.forEach(s=>{const r=new tt(s,0),o=new tt(s,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([r,o],a=>{n=n.add(a.As)})}),A.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,i){const n=i.path,s=n.length+1;let r=n;z.isDocumentKey(r)||(r=r.child(""));const o=new tt(new z(r),0);let a=new wt(pe);return this.Rs.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===s&&(a=a.add(l.As)),!0)},o),A.resolve(this.Vs(a))}Vs(e){const i=[];return e.forEach(n=>{const s=this.Ps(n);s!==null&&i.push(s)}),i}removeMutationBatch(e,i){ye(this.Ss(i.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Rs;return A.forEach(i.mutations,s=>{const r=new tt(s.key,i.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,i){const n=new tt(i,0),s=this.Rs.firstAfterOrEqual(n);return A.resolve(i.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,A.resolve()}Ss(e,i){return this.bs(e)}bs(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Ps(e){const i=this.bs(e);return i<0||i>=this.mutationQueue.length?null:this.mutationQueue[i]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e){this.Ds=e,this.docs=new Ve(z.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,i){const n=i.key,s=this.docs.get(n),r=s?s.size:0,o=this.Ds(i);return this.docs=this.docs.insert(n,{document:i.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const i=this.docs.get(e);i&&(this.docs=this.docs.remove(e),this.size-=i.size)}getEntry(e,i){const n=this.docs.get(i);return A.resolve(n?n.document.mutableCopy():it.newInvalidDocument(i))}getEntries(e,i){let n=Hi();return i.forEach(s=>{const r=this.docs.get(s);n=n.insert(s,r?r.document.mutableCopy():it.newInvalidDocument(s))}),A.resolve(n)}getDocumentsMatchingQuery(e,i,n,s){let r=Hi();const o=i.path,a=new z(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:c}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||i1(t1(c),n)<=0||(s.has(c.key)||yl(i,c))&&(r=r.insert(c.key,c.mutableCopy()))}return A.resolve(r)}getAllFromCollectionGroup(e,i,n,s){K()}Cs(e,i){return A.forEach(this.docs,n=>i(n))}newChangeBuffer(e){return new pC(this)}getSize(e){return A.resolve(this.size)}}class pC extends lC{constructor(e){super(),this.os=e}applyChanges(e){const i=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?i.push(this.os.addEntry(e,s)):this.os.removeEntry(n)}),A.waitFor(i)}getFromCache(e,i){return this.os.getEntry(e,i)}getAllFromCache(e,i){return this.os.getEntries(e,i)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e){this.persistence=e,this.xs=new Fs(i=>kh(i),Th),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Ph,this.targetCount=0,this.Ms=Ss.kn()}forEachTarget(e,i){return this.xs.forEach((n,s)=>i(s)),A.resolve()}getLastRemoteSnapshotVersion(e){return A.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return A.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),A.resolve(this.highestTargetId)}setTargetsMetadata(e,i,n){return n&&(this.lastRemoteSnapshotVersion=n),i>this.Ns&&(this.Ns=i),A.resolve()}Fn(e){this.xs.set(e.target,e);const i=e.targetId;i>this.highestTargetId&&(this.Ms=new Ss(i),this.highestTargetId=i),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,i){return this.Fn(i),this.targetCount+=1,A.resolve()}updateTargetData(e,i){return this.Fn(i),A.resolve()}removeTargetData(e,i){return this.xs.delete(i.target),this.ks.Is(i.targetId),this.targetCount-=1,A.resolve()}removeTargets(e,i,n){let s=0;const r=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=i&&n.get(a.targetId)===null&&(this.xs.delete(o),r.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),A.waitFor(r).next(()=>s)}getTargetCount(e){return A.resolve(this.targetCount)}getTargetData(e,i){const n=this.xs.get(i)||null;return A.resolve(n)}addMatchingKeys(e,i,n){return this.ks.gs(i,n),A.resolve()}removeMatchingKeys(e,i,n){this.ks.ps(i,n);const s=this.persistence.referenceDelegate,r=[];return s&&i.forEach(o=>{r.push(s.markPotentiallyOrphaned(e,o))}),A.waitFor(r)}removeMatchingKeysForTargetId(e,i){return this.ks.Is(i),A.resolve()}getMatchingKeysForTargetId(e,i){const n=this.ks.Es(i);return A.resolve(n)}containsKey(e,i){return A.resolve(this.ks.containsKey(i))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,i){this.$s={},this.overlays={},this.Os=new vh(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new gC(this),this.indexManager=new oC,this.remoteDocumentCache=function(n){return new mC(n)}(n=>this.referenceDelegate.Ls(n)),this.serializer=new sC(i),this.qs=new hC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let i=this.overlays[e.toKey()];return i||(i=new dC,this.overlays[e.toKey()]=i),i}getMutationQueue(e,i){let n=this.$s[e.toKey()];return n||(n=new fC(i,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,i,n){H("MemoryPersistence","Starting transaction:",e);const s=new yC(this.Os.next());return this.referenceDelegate.Us(),n(s).next(r=>this.referenceDelegate.Ks(s).next(()=>r)).toPromise().then(r=>(s.raiseOnCommittedEvent(),r))}Gs(e,i){return A.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,i)))}}class yC extends s1{constructor(e){super(),this.currentSequenceNumber=e}}class Rh{constructor(e){this.persistence=e,this.Qs=new Ph,this.js=null}static zs(e){return new Rh(e)}get Ws(){if(this.js)return this.js;throw K()}addReference(e,i,n){return this.Qs.addReference(n,i),this.Ws.delete(n.toString()),A.resolve()}removeReference(e,i,n){return this.Qs.removeReference(n,i),this.Ws.add(n.toString()),A.resolve()}markPotentiallyOrphaned(e,i){return this.Ws.add(i.toString()),A.resolve()}removeTarget(e,i){this.Qs.Is(i.targetId).forEach(s=>this.Ws.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,i.targetId).next(s=>{s.forEach(r=>this.Ws.add(r.toString()))}).next(()=>n.removeTargetData(e,i))}Us(){this.js=new Set}Ks(e){const i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return A.forEach(this.Ws,n=>{const s=z.fromPath(n);return this.Hs(e,s).next(r=>{r||i.removeEntry(s,J.min())})}).next(()=>(this.js=null,i.apply(e)))}updateLimboDocument(e,i){return this.Hs(e,i).next(n=>{n?this.Ws.delete(i.toString()):this.Ws.add(i.toString())})}Ls(e){return 0}Hs(e,i){return A.or([()=>A.resolve(this.Qs.containsKey(i)),()=>this.persistence.getTargetCache().containsKey(e,i),()=>this.persistence.Gs(e,i)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,i,n,s){this.targetId=e,this.fromCache=i,this.Fi=n,this.Bi=s}static Li(e,i){let n=le(),s=le();for(const r of i.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new xh(e,i.fromCache,n,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(){this.qi=!1}initialize(e,i){this.Ui=e,this.indexManager=i,this.qi=!0}getDocumentsMatchingQuery(e,i,n,s){return this.Ki(e,i).next(r=>r||this.Gi(e,i,s,n)).next(r=>r||this.Qi(e,i))}Ki(e,i){if(wf(i))return A.resolve(null);let n=Ui(i);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(i.limit!==null&&s===1&&(i=hu(i,null,"F"),n=Ui(i)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const o=le(...r);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.ji(i,a);return this.zi(i,u,o,l.readTime)?this.Ki(e,hu(i,null,"F")):this.Wi(e,u,i,l)}))})))}Gi(e,i,n,s){return wf(i)||s.isEqual(J.min())?this.Qi(e,i):this.Ui.getDocuments(e,n).next(r=>{const o=this.ji(i,r);return this.zi(i,o,n,s)?this.Qi(e,i):(uf()<=fe.DEBUG&&H("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),du(i)),this.Wi(e,o,i,e1(s,-1)))})}ji(e,i){let n=new wt(pv(e));return i.forEach((s,r)=>{yl(e,r)&&(n=n.add(r))}),n}zi(e,i,n,s){if(e.limit===null)return!1;if(n.size!==i.size)return!0;const r=e.limitType==="F"?i.last():i.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}Qi(e,i){return uf()<=fe.DEBUG&&H("QueryEngine","Using full collection scan to execute query:",du(i)),this.Ui.getDocumentsMatchingQuery(e,i,on.min())}Wi(e,i,n,s){return this.Ui.getDocumentsMatchingQuery(e,n,s).next(r=>(i.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,i,n,s){this.persistence=e,this.Hi=i,this.serializer=s,this.Ji=new Ve(pe),this.Yi=new Fs(r=>kh(r),Th),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uC(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",i=>e.collect(i,this.Ji))}}function kC(t,e,i,n){return new wC(t,e,i,n)}async function Uv(t,e){const i=ne(t);return await i.persistence.runTransaction("Handle user change","readonly",n=>{let s;return i.mutationQueue.getAllMutationBatches(n).next(r=>(s=r,i.tr(e),i.mutationQueue.getAllMutationBatches(n))).next(r=>{const o=[],a=[];let l=le();for(const u of s){o.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}for(const u of r){a.push(u.batchId);for(const c of u.mutations)l=l.add(c.key)}return i.localDocuments.getDocuments(n,l).next(u=>({er:u,removedBatchIds:o,addedBatchIds:a}))})})}function TC(t,e){const i=ne(t);return i.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),r=i.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,l,u){const c=l.batch,h=c.keys();let d=A.resolve();return h.forEach(f=>{d=d.next(()=>u.getEntry(a,f)).next(p=>{const T=l.docVersions.get(f);ye(T!==null),p.version.compareTo(T)<0&&(c.applyToRemoteDocument(p,l),p.isValidDocument()&&(p.setReadTime(l.commitVersion),u.addEntry(p)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,c))}(i,n,e,r).next(()=>r.apply(n)).next(()=>i.mutationQueue.performConsistencyCheck(n)).next(()=>i.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>i.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let a=le();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>i.localDocuments.getDocuments(n,s))})}function Hv(t){const e=ne(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",i=>e.Bs.getLastRemoteSnapshotVersion(i))}function _C(t,e){const i=ne(t),n=e.snapshotVersion;let s=i.Ji;return i.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=i.Zi.newChangeBuffer({trackRemovals:!0});s=i.Ji;const a=[];e.targetChanges.forEach((c,h)=>{const d=s.get(h);if(!d)return;a.push(i.Bs.removeMatchingKeys(r,c.removedDocuments,h).next(()=>i.Bs.addMatchingKeys(r,c.addedDocuments,h)));let f=d.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(h)!==null?f=f.withResumeToken(Tt.EMPTY_BYTE_STRING,J.min()).withLastLimboFreeSnapshotVersion(J.min()):c.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(c.resumeToken,n)),s=s.insert(h,f),function(p,T,v){return p.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(d,f,c)&&a.push(i.Bs.updateTargetData(r,f))});let l=Hi(),u=le();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&a.push(i.persistence.referenceDelegate.updateLimboDocument(r,c))}),a.push(CC(r,o,e.documentUpdates).next(c=>{l=c.nr,u=c.sr})),!n.isEqual(J.min())){const c=i.Bs.getLastRemoteSnapshotVersion(r).next(h=>i.Bs.setTargetsMetadata(r,r.currentSequenceNumber,n));a.push(c)}return A.waitFor(a).next(()=>o.apply(r)).next(()=>i.localDocuments.getLocalViewOfDocuments(r,l,u)).next(()=>l)}).then(r=>(i.Ji=s,r))}function CC(t,e,i){let n=le(),s=le();return i.forEach(r=>n=n.add(r)),e.getEntries(t,n).next(r=>{let o=Hi();return i.forEach((a,l)=>{const u=r.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(J.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):H("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{nr:o,sr:s}})}function EC(t,e){const i=ne(t);return i.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),i.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function SC(t,e){const i=ne(t);return i.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return i.Bs.getTargetData(n,e).next(r=>r?(s=r,A.resolve(s)):i.Bs.allocateTargetId(n).next(o=>(s=new Zi(e,o,"TargetPurposeListen",n.currentSequenceNumber),i.Bs.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=i.Ji.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(i.Ji=i.Ji.insert(n.targetId,n),i.Yi.set(e,n.targetId)),n})}async function pu(t,e,i){const n=ne(t),s=n.Ji.get(e),r=i?"readwrite":"readwrite-primary";try{i||await n.persistence.runTransaction("Release target",r,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!To(o))throw o;H("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ji=n.Ji.remove(e),n.Yi.delete(s.target)}function xf(t,e,i){const n=ne(t);let s=J.min(),r=le();return n.persistence.runTransaction("Execute query","readonly",o=>function(a,l,u){const c=ne(a),h=c.Yi.get(u);return h!==void 0?A.resolve(c.Ji.get(h)):c.Bs.getTargetData(l,u)}(n,o,Ui(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,n.Bs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>n.Hi.getDocumentsMatchingQuery(o,e,i?s:J.min(),i?r:le())).next(a=>(IC(n,w1(e),a),{documents:a,ir:r})))}function IC(t,e,i){let n=t.Xi.get(e)||J.min();i.forEach((s,r)=>{r.readTime.compareTo(n)>0&&(n=r.readTime)}),t.Xi.set(e,n)}class Df{constructor(){this.activeTargetIds=S1()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class AC{constructor(){this.Hr=new Df,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,i,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,i,n){this.Jr[e]=i}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Df,Promise.resolve()}handleUserChange(e,i,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{Yr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){H("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){H("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ko=null;function yc(){return Ko===null?Ko=268435456+Math.round(2147483648*Math.random()):Ko++,"0x"+Ko.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mt="WebChannelConnection";class DC extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const i=e.ssl?"https":"http";this.mo=i+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,i,n,s,r){const o=yc(),a=this.To(e,i);H("RestConnection",`Sending RPC '${e}' ${o}:`,a,n);const l={};return this.Eo(l,s,r),this.Ao(e,a,l,n).then(u=>(H("RestConnection",`Received RPC '${e}' ${o}: `,u),u),u=>{throw Ts("RestConnection",`RPC '${e}' ${o} failed with error: `,u,"url: ",a,"request:",n),u})}vo(e,i,n,s,r,o){return this.Io(e,i,n,s,r)}Eo(e,i,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Os,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,r)=>e[r]=s),n&&n.headers.forEach((s,r)=>e[r]=s)}To(e,i){const n=RC[e];return`${this.mo}/v1/${i}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,i,n,s){const r=yc();return new Promise((o,a)=>{const l=new z_;l.setWithCredentials(!0),l.listenOnce(H_.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case vc.NO_ERROR:const c=l.getResponseJson();H(mt,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(c)),o(c);break;case vc.TIMEOUT:H(mt,`RPC '${e}' ${r} timed out`),a(new L(E.DEADLINE_EXCEEDED,"Request time out"));break;case vc.HTTP_ERROR:const h=l.getStatus();if(H(mt,`RPC '${e}' ${r} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const f=d==null?void 0:d.error;if(f&&f.status&&f.message){const p=function(T){const v=T.toLowerCase().replace(/_/g,"-");return Object.values(E).indexOf(v)>=0?v:E.UNKNOWN}(f.status);a(new L(p,f.message))}else a(new L(E.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new L(E.UNAVAILABLE,"Connection failed."));break;default:K()}}finally{H(mt,`RPC '${e}' ${r} completed.`)}});const u=JSON.stringify(s);H(mt,`RPC '${e}' ${r} sending request:`,s),l.send(i,"POST",u,n,15)})}Ro(e,i,n){const s=yc(),r=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=F_(),a=U_(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.xmlHttpFactory=new $_({})),this.Eo(l.initMessageHeaders,i,n),l.encodeInitMessageHeaders=!0;const c=r.join("");H(mt,`Creating RPC '${e}' stream ${s}: ${c}`,l);const h=o.createWebChannel(c,l);let d=!1,f=!1;const p=new xC({ro:v=>{f?H(mt,`Not sending because RPC '${e}' stream ${s} is closed:`,v):(d||(H(mt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),H(mt,`RPC '${e}' stream ${s} sending:`,v),h.send(v))},oo:()=>h.close()}),T=(v,S,O)=>{v.listen(S,I=>{try{O(I)}catch(V){setTimeout(()=>{throw V},0)}})};return T(h,zo.EventType.OPEN,()=>{f||H(mt,`RPC '${e}' stream ${s} transport opened.`)}),T(h,zo.EventType.CLOSE,()=>{f||(f=!0,H(mt,`RPC '${e}' stream ${s} transport closed`),p.wo())}),T(h,zo.EventType.ERROR,v=>{f||(f=!0,Ts(mt,`RPC '${e}' stream ${s} transport errored:`,v),p.wo(new L(E.UNAVAILABLE,"The operation could not be completed")))}),T(h,zo.EventType.MESSAGE,v=>{var S;if(!f){const O=v.data[0];ye(!!O);const I=O,V=I.error||((S=I[0])===null||S===void 0?void 0:S.error);if(V){H(mt,`RPC '${e}' stream ${s} received error:`,V);const G=V.status;let P=function(oe){const D=je[oe];if(D!==void 0)return Pv(D)}(G),ue=V.message;P===void 0&&(P=E.INTERNAL,ue="Unknown error status: "+G+" with message "+V.message),f=!0,p.wo(new L(P,ue)),h.close()}else H(mt,`RPC '${e}' stream ${s} received:`,O),p._o(O)}}),T(a,B_.STAT_EVENT,v=>{v.stat===lf.PROXY?H(mt,`RPC '${e}' stream ${s} detected buffering proxy`):v.stat===lf.NOPROXY&&H(mt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{p.fo()},0),p}}function bc(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tl(t){return new j1(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e,i,n=1e3,s=1.5,r=6e4){this.ii=e,this.timerId=i,this.Po=n,this.bo=s,this.Vo=r,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const i=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),s=Math.max(0,i-n);s>0&&H("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.So} ms, delay with jitter: ${i} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,s,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){this.Do!==null&&(this.Do.skipDelay(),this.Do=null)}cancel(){this.Do!==null&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e,i,n,s,r,o,a,l){this.ii=e,this.$o=n,this.Oo=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Dh(e,i)}Uo(){return this.state===1||this.state===5||this.Ko()}Ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&this.Bo===null&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,i){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,e!==4?this.qo.reset():i&&i.code===E.RESOURCE_EXHAUSTED?(Fi(i.toString()),Fi("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):i&&i.code===E.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(i)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),i=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Fo===i&&this.Zo(n,s)},n=>{e(()=>{const s=new L(E.UNKNOWN,"Fetching auth token failed: "+n.message);return this.tu(s)})})}Zo(e,i){const n=this.Xo(this.Fo);this.stream=this.eu(e,i),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(s=>{n(()=>this.tu(s))}),this.stream.onMessage(s=>{n(()=>this.onMessage(s))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return H("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return i=>{this.ii.enqueueAndForget(()=>this.Fo===e?i():(H("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class MC extends Bv{constructor(e,i,n,s,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,n,s,o),this.serializer=r}eu(e,i){return this.connection.Ro("Listen",e,i)}onMessage(e){this.qo.reset();const i=G1(this.serializer,e),n=function(s){if(!("targetChange"in s))return J.min();const r=s.targetChange;return r.targetIds&&r.targetIds.length?J.min():r.readTime?Ut(r.readTime):J.min()}(e);return this.listener.nu(i,n)}su(e){const i={};i.database=no(this.serializer),i.addTarget=function(s,r){let o;const a=r.target;if(o=cu(a)?{documents:Y1(s,a)}:{query:J1(s,a)},o.targetId=r.targetId,r.resumeToken.approximateByteSize()>0){o.resumeToken=Dv(s,r.resumeToken);const l=fu(s,r.expectedCount);l!==null&&(o.expectedCount=l)}else if(r.snapshotVersion.compareTo(J.min())>0){o.readTime=xa(s,r.snapshotVersion.toTimestamp());const l=fu(s,r.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const n=Z1(this.serializer,e);n&&(i.labels=n),this.Wo(i)}iu(e){const i={};i.database=no(this.serializer),i.removeTarget=e,this.Wo(i)}}class LC extends Bv{constructor(e,i,n,s,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,n,s,o),this.serializer=r,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,i){return this.connection.Ro("Write",e,i)}onMessage(e){if(ye(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const i=Q1(e.writeResults,e.commitTime),n=Ut(e.commitTime);return this.listener.cu(n,i)}return ye(!e.writeResults||e.writeResults.length===0),this.ru=!0,this.listener.au()}hu(){const e={};e.database=no(this.serializer),this.Wo(e)}uu(e){const i={streamToken:this.lastStreamToken,writes:e.map(n=>Nv(this.serializer,n))};this.Wo(i)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC extends class{}{constructor(e,i,n,s){super(),this.authCredentials=e,this.appCheckCredentials=i,this.connection=n,this.serializer=s,this.lu=!1}fu(){if(this.lu)throw new L(E.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,i,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,r])=>this.connection.Io(e,i,n,s,r)).catch(s=>{throw s.name==="FirebaseError"?(s.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(E.UNKNOWN,s.toString())})}vo(e,i,n,s){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.vo(e,i,n,r,o,s)).catch(r=>{throw r.name==="FirebaseError"?(r.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new L(E.UNKNOWN,r.toString())})}terminate(){this.lu=!0}}class OC{constructor(e,i){this.asyncQueue=e,this.onlineStateHandler=i,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){this.wu===0&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){this.state==="Online"?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,e==="Online"&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const i=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Fi(i),this.mu=!1):H("OnlineStateTracker",i)}Tu(){this._u!==null&&(this._u.cancel(),this._u=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e,i,n,s,r){this.localStore=e,this.datastore=i,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=r,this.Pu.Yr(o=>{n.enqueueAndForget(async()=>{zn(this)&&(H("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=ne(a);l.vu.add(4),await So(l),l.bu.set("Unknown"),l.vu.delete(4),await _l(l)}(this))})}),this.bu=new OC(n,s)}}async function _l(t){if(zn(t))for(const e of t.Ru)await e(!0)}async function So(t){for(const e of t.Ru)await e(!1)}function $v(t,e){const i=ne(t);i.Au.has(e.targetId)||(i.Au.set(e.targetId,e),Nh(i)?Lh(i):Us(i).Ko()&&Mh(i,e))}function zv(t,e){const i=ne(t),n=Us(i);i.Au.delete(e),n.Ko()&&jv(i,e),i.Au.size===0&&(n.Ko()?n.jo():zn(i)&&i.bu.set("Unknown"))}function Mh(t,e){if(t.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(J.min())>0){const i=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(i)}Us(t).su(e)}function jv(t,e){t.Vu.qt(e),Us(t).iu(e)}function Lh(t){t.Vu=new H1({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),le:e=>t.Au.get(e)||null,ue:()=>t.datastore.serializer.databaseId}),Us(t).start(),t.bu.gu()}function Nh(t){return zn(t)&&!Us(t).Uo()&&t.Au.size>0}function zn(t){return ne(t).vu.size===0}function qv(t){t.Vu=void 0}async function FC(t){t.Au.forEach((e,i)=>{Mh(t,e)})}async function UC(t,e){qv(t),Nh(t)?(t.bu.Iu(e),Lh(t)):t.bu.set("Unknown")}async function HC(t,e,i){if(t.bu.set("Online"),e instanceof xv&&e.state===2&&e.cause)try{await async function(n,s){const r=s.cause;for(const o of s.targetIds)n.Au.has(o)&&(await n.remoteSyncer.rejectListen(o,r),n.Au.delete(o),n.Vu.removeTarget(o))}(t,e)}catch(n){H("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Ma(t,n)}else if(e instanceof oa?t.Vu.Ht(e):e instanceof Rv?t.Vu.ne(e):t.Vu.Xt(e),!i.isEqual(J.min()))try{const n=await Hv(t.localStore);i.compareTo(n)>=0&&await function(s,r){const o=s.Vu.ce(r);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const u=s.Au.get(l);u&&s.Au.set(l,u.withResumeToken(a.resumeToken,r))}}),o.targetMismatches.forEach((a,l)=>{const u=s.Au.get(a);if(!u)return;s.Au.set(a,u.withResumeToken(Tt.EMPTY_BYTE_STRING,u.snapshotVersion)),jv(s,a);const c=new Zi(u.target,a,l,u.sequenceNumber);Mh(s,c)}),s.remoteSyncer.applyRemoteEvent(o)}(t,i)}catch(n){H("RemoteStore","Failed to raise snapshot:",n),await Ma(t,n)}}async function Ma(t,e,i){if(!To(e))throw e;t.vu.add(1),await So(t),t.bu.set("Offline"),i||(i=()=>Hv(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{H("RemoteStore","Retrying IndexedDB access"),await i(),t.vu.delete(1),await _l(t)})}function Wv(t,e){return e().catch(i=>Ma(t,i,e))}async function Cl(t){const e=ne(t),i=ln(e);let n=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;BC(e);)try{const s=await EC(e.localStore,n);if(s===null){e.Eu.length===0&&i.jo();break}n=s.batchId,$C(e,s)}catch(s){await Ma(e,s)}Kv(e)&&Gv(e)}function BC(t){return zn(t)&&t.Eu.length<10}function $C(t,e){t.Eu.push(e);const i=ln(t);i.Ko()&&i.ou&&i.uu(e.mutations)}function Kv(t){return zn(t)&&!ln(t).Uo()&&t.Eu.length>0}function Gv(t){ln(t).start()}async function zC(t){ln(t).hu()}async function jC(t){const e=ln(t);for(const i of t.Eu)e.uu(i.mutations)}async function qC(t,e,i){const n=t.Eu.shift(),s=Eh.from(n,e,i);await Wv(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Cl(t)}async function WC(t,e){e&&ln(t).ou&&await async function(i,n){if(s=n.code,Av(s)&&s!==E.ABORTED){const r=i.Eu.shift();ln(i).Qo(),await Wv(i,()=>i.remoteSyncer.rejectFailedWrite(r.batchId,n)),await Cl(i)}var s}(t,e),Kv(t)&&Gv(t)}async function Lf(t,e){const i=ne(t);i.asyncQueue.verifyOperationInProgress(),H("RemoteStore","RemoteStore received new credentials");const n=zn(i);i.vu.add(3),await So(i),n&&i.bu.set("Unknown"),await i.remoteSyncer.handleCredentialChange(e),i.vu.delete(3),await _l(i)}async function KC(t,e){const i=ne(t);e?(i.vu.delete(2),await _l(i)):e||(i.vu.add(2),await So(i),i.bu.set("Unknown"))}function Us(t){return t.Su||(t.Su=function(e,i,n){const s=ne(e);return s.fu(),new MC(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(t.datastore,t.asyncQueue,{uo:FC.bind(null,t),ao:UC.bind(null,t),nu:HC.bind(null,t)}),t.Ru.push(async e=>{e?(t.Su.Qo(),Nh(t)?Lh(t):t.bu.set("Unknown")):(await t.Su.stop(),qv(t))})),t.Su}function ln(t){return t.Du||(t.Du=function(e,i,n){const s=ne(e);return s.fu(),new LC(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(t.datastore,t.asyncQueue,{uo:zC.bind(null,t),ao:WC.bind(null,t),au:jC.bind(null,t),cu:qC.bind(null,t)}),t.Ru.push(async e=>{e?(t.Du.Qo(),await Cl(t)):(await t.Du.stop(),t.Eu.length>0&&(H("RemoteStore",`Stopping write stream with ${t.Eu.length} pending writes`),t.Eu=[]))})),t.Du}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e,i,n,s,r){this.asyncQueue=e,this.timerId=i,this.targetTimeMs=n,this.op=s,this.removalCallback=r,this.deferred=new vi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,i,n,s,r){const o=Date.now()+n,a=new Oh(e,i,o,s,r);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(E.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vh(t,e){if(Fi("AsyncQueue",`${e}: ${t}`),To(t))return new L(E.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this.comparator=e?(i,n)=>e(i,n)||z.comparator(i.key,n.key):(i,n)=>z.comparator(i.key,n.key),this.keyedMap=Tr(),this.sortedSet=new Ve(this.comparator)}static emptySet(e){return new vs(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const i=this.keyedMap.get(e);return i?this.sortedSet.indexOf(i):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((i,n)=>(e(i),!1))}add(e){const i=this.delete(e.key);return i.copy(i.keyedMap.insert(e.key,e),i.sortedSet.insert(e,null))}delete(e){const i=this.get(e);return i?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(i)):this}isEqual(e){if(!(e instanceof vs)||this.size!==e.size)return!1;const i=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;i.hasNext();){const s=i.getNext().key,r=n.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(i=>{e.push(i.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,i){const n=new vs;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=i,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(){this.Cu=new Ve(z.comparator)}track(e){const i=e.doc.key,n=this.Cu.get(i);n?e.type!==0&&n.type===3?this.Cu=this.Cu.insert(i,e):e.type===3&&n.type!==1?this.Cu=this.Cu.insert(i,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Cu=this.Cu.insert(i,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Cu=this.Cu.insert(i,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Cu=this.Cu.remove(i):e.type===1&&n.type===2?this.Cu=this.Cu.insert(i,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Cu=this.Cu.insert(i,{type:2,doc:e.doc}):K():this.Cu=this.Cu.insert(i,e)}xu(){const e=[];return this.Cu.inorderTraversal((i,n)=>{e.push(n)}),e}}class Is{constructor(e,i,n,s,r,o,a,l,u){this.query=e,this.docs=i,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,i,n,s,r){const o=[];return i.forEach(a=>{o.push({type:0,doc:a})}),new Is(e,i,vs.emptySet(i),o,n,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const i=this.docChanges,n=e.docChanges;if(i.length!==n.length)return!1;for(let s=0;s<i.length;s++)if(i[s].type!==n[s].type||!i[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(){this.Nu=void 0,this.listeners=[]}}class QC{constructor(){this.queries=new Fs(e=>mv(e),vl),this.onlineState="Unknown",this.ku=new Set}}async function Fh(t,e){const i=ne(t),n=e.query;let s=!1,r=i.queries.get(n);if(r||(s=!0,r=new GC),s)try{r.Nu=await i.onListen(n)}catch(o){const a=Vh(o,`Initialization of query '${du(e.query)}' failed`);return void e.onError(a)}i.queries.set(n,r),r.listeners.push(e),e.Mu(i.onlineState),r.Nu&&e.$u(r.Nu)&&Hh(i)}async function Uh(t,e){const i=ne(t),n=e.query;let s=!1;const r=i.queries.get(n);if(r){const o=r.listeners.indexOf(e);o>=0&&(r.listeners.splice(o,1),s=r.listeners.length===0)}if(s)return i.queries.delete(n),i.onUnlisten(n)}function YC(t,e){const i=ne(t);let n=!1;for(const s of e){const r=s.query,o=i.queries.get(r);if(o){for(const a of o.listeners)a.$u(s)&&(n=!0);o.Nu=s}}n&&Hh(i)}function JC(t,e,i){const n=ne(t),s=n.queries.get(e);if(s)for(const r of s.listeners)r.onError(i);n.queries.delete(e)}function Hh(t){t.ku.forEach(e=>{e.next()})}class Bh{constructor(e,i,n){this.query=e,this.Ou=i,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Is(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let i=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),i=!0):this.qu(e,this.onlineState)&&(this.Uu(e),i=!0),this.Bu=e,i}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let i=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),i=!0),i}qu(e,i){if(!e.fromCache)return!0;const n=i!=="Offline";return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||i==="Offline")}Lu(e){if(e.docChanges.length>0)return!0;const i=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!i)&&this.options.includeMetadataChanges===!0}Uu(e){e=Is.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(e){this.key=e}}class Yv{constructor(e){this.key=e}}class XC{constructor(e,i){this.query=e,this.Yu=i,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=le(),this.mutatedKeys=le(),this.tc=pv(e),this.ec=new vs(this.tc)}get nc(){return this.Yu}sc(e,i){const n=i?i.ic:new Nf,s=i?i.ec:this.ec;let r=i?i.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((c,h)=>{const d=s.get(c),f=yl(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),T=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let v=!1;d&&f?d.data.isEqual(f.data)?p!==T&&(n.track({type:3,doc:f}),v=!0):this.rc(d,f)||(n.track({type:2,doc:f}),v=!0,(l&&this.tc(f,l)>0||u&&this.tc(f,u)<0)&&(a=!0)):!d&&f?(n.track({type:0,doc:f}),v=!0):d&&!f&&(n.track({type:1,doc:d}),v=!0,(l||u)&&(a=!0)),v&&(f?(o=o.add(f),r=T?r.add(c):r.delete(c)):(o=o.delete(c),r=r.delete(c)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const c=this.query.limitType==="F"?o.last():o.first();o=o.delete(c.key),r=r.delete(c.key),n.track({type:1,doc:c})}return{ec:o,ic:n,zi:a,mutatedKeys:r}}rc(e,i){return e.hasLocalMutations&&i.hasCommittedMutations&&!i.hasLocalMutations}applyChanges(e,i,n){const s=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const r=e.ic.xu();r.sort((u,c)=>function(h,d){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return K()}};return f(h)-f(d)}(u.type,c.type)||this.tc(u.doc,c.doc)),this.oc(n);const o=i?this.uc():[],a=this.Zu.size===0&&this.current?1:0,l=a!==this.Xu;return this.Xu=a,r.length!==0||l?{snapshot:new Is(this.query,e.ec,s,r,e.mutatedKeys,a===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Nf,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(i=>this.Yu=this.Yu.add(i)),e.modifiedDocuments.forEach(i=>{}),e.removedDocuments.forEach(i=>this.Yu=this.Yu.delete(i)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=le(),this.ec.forEach(n=>{this.ac(n.key)&&(this.Zu=this.Zu.add(n.key))});const i=[];return e.forEach(n=>{this.Zu.has(n)||i.push(new Yv(n))}),this.Zu.forEach(n=>{e.has(n)||i.push(new Qv(n))}),i}hc(e){this.Yu=e.ir,this.Zu=le();const i=this.sc(e.documents);return this.applyChanges(i,!0)}lc(){return Is.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,this.Xu===0,this.hasCachedResults)}}class ZC{constructor(e,i,n){this.query=e,this.targetId=i,this.view=n}}class eE{constructor(e){this.key=e,this.fc=!1}}class tE{constructor(e,i,n,s,r,o){this.localStore=e,this.remoteStore=i,this.eventManager=n,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new Fs(a=>mv(a),vl),this._c=new Map,this.mc=new Set,this.gc=new Ve(z.comparator),this.yc=new Map,this.Ic=new Ph,this.Tc={},this.Ec=new Map,this.Ac=Ss.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return this.vc===!0}}async function iE(t,e){const i=dE(t);let n,s;const r=i.wc.get(e);if(r)n=r.targetId,i.sharedClientState.addLocalQueryTarget(n),s=r.view.lc();else{const o=await SC(i.localStore,Ui(e)),a=i.sharedClientState.addLocalQueryTarget(o.targetId);n=o.targetId,s=await nE(i,e,n,a==="current",o.resumeToken),i.isPrimaryClient&&$v(i.remoteStore,o)}return s}async function nE(t,e,i,n,s){t.Rc=(h,d,f)=>async function(p,T,v,S){let O=T.view.sc(v);O.zi&&(O=await xf(p.localStore,T.query,!1).then(({documents:G})=>T.view.sc(G,O)));const I=S&&S.targetChanges.get(T.targetId),V=T.view.applyChanges(O,p.isPrimaryClient,I);return Vf(p,T.targetId,V.cc),V.snapshot}(t,h,d,f);const r=await xf(t.localStore,e,!0),o=new XC(e,r.ir),a=o.sc(r.documents),l=Eo.createSynthesizedTargetChangeForCurrentChange(i,n&&t.onlineState!=="Offline",s),u=o.applyChanges(a,t.isPrimaryClient,l);Vf(t,i,u.cc);const c=new ZC(e,i,o);return t.wc.set(e,c),t._c.has(i)?t._c.get(i).push(e):t._c.set(i,[e]),u.snapshot}async function sE(t,e){const i=ne(t),n=i.wc.get(e),s=i._c.get(n.targetId);if(s.length>1)return i._c.set(n.targetId,s.filter(r=>!vl(r,e))),void i.wc.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(n.targetId),i.sharedClientState.isActiveQueryTarget(n.targetId)||await pu(i.localStore,n.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(n.targetId),zv(i.remoteStore,n.targetId),gu(i,n.targetId)}).catch(ko)):(gu(i,n.targetId),await pu(i.localStore,n.targetId,!0))}async function rE(t,e,i){const n=fE(t);try{const s=await function(r,o){const a=ne(r),l=Ge.now(),u=o.reduce((d,f)=>d.add(f.key),le());let c,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=Hi(),p=le();return a.Zi.getEntries(d,u).next(T=>{f=T,f.forEach((v,S)=>{S.isValidDocument()||(p=p.add(v))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(T=>{c=T;const v=[];for(const S of o){const O=L1(S,c.get(S.key).overlayedDocument);O!=null&&v.push(new hn(S.key,O,ov(O.value.mapValue),vt.exists(!0)))}return a.mutationQueue.addMutationBatch(d,l,v,o)}).next(T=>{h=T;const v=T.applyToLocalDocumentSet(c,p);return a.documentOverlayCache.saveOverlays(d,T.batchId,v)})}).then(()=>({batchId:h.batchId,changes:vv(c)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(r,o,a){let l=r.Tc[r.currentUser.toKey()];l||(l=new Ve(pe)),l=l.insert(o,a),r.Tc[r.currentUser.toKey()]=l}(n,s.batchId,i),await Io(n,s.changes),await Cl(n.remoteStore)}catch(s){const r=Vh(s,"Failed to persist write");i.reject(r)}}async function Jv(t,e){const i=ne(t);try{const n=await _C(i.localStore,e);e.targetChanges.forEach((s,r)=>{const o=i.yc.get(r);o&&(ye(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.fc=!0:s.modifiedDocuments.size>0?ye(o.fc):s.removedDocuments.size>0&&(ye(o.fc),o.fc=!1))}),await Io(i,n,e)}catch(n){await ko(n)}}function Of(t,e,i){const n=ne(t);if(n.isPrimaryClient&&i===0||!n.isPrimaryClient&&i===1){const s=[];n.wc.forEach((r,o)=>{const a=o.view.Mu(e);a.snapshot&&s.push(a.snapshot)}),function(r,o){const a=ne(r);a.onlineState=o;let l=!1;a.queries.forEach((u,c)=>{for(const h of c.listeners)h.Mu(o)&&(l=!0)}),l&&Hh(a)}(n.eventManager,e),s.length&&n.dc.nu(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function oE(t,e,i){const n=ne(t);n.sharedClientState.updateQueryState(e,"rejected",i);const s=n.yc.get(e),r=s&&s.key;if(r){let o=new Ve(z.comparator);o=o.insert(r,it.newNoDocument(r,J.min()));const a=le().add(r),l=new kl(J.min(),new Map,new Ve(pe),o,a);await Jv(n,l),n.gc=n.gc.remove(r),n.yc.delete(e),$h(n)}else await pu(n.localStore,e,!1).then(()=>gu(n,e,i)).catch(ko)}async function aE(t,e){const i=ne(t),n=e.batch.batchId;try{const s=await TC(i.localStore,e);Zv(i,n,null),Xv(i,n),i.sharedClientState.updateMutationState(n,"acknowledged"),await Io(i,s)}catch(s){await ko(s)}}async function lE(t,e,i){const n=ne(t);try{const s=await function(r,o){const a=ne(r);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return a.mutationQueue.lookupMutationBatch(l,o).next(c=>(ye(c!==null),u=c.keys(),a.mutationQueue.removeMutationBatch(l,c))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,u,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>a.localDocuments.getDocuments(l,u))})}(n.localStore,e);Zv(n,e,i),Xv(n,e),n.sharedClientState.updateMutationState(e,"rejected",i),await Io(n,s)}catch(s){await ko(s)}}function Xv(t,e){(t.Ec.get(e)||[]).forEach(i=>{i.resolve()}),t.Ec.delete(e)}function Zv(t,e,i){const n=ne(t);let s=n.Tc[n.currentUser.toKey()];if(s){const r=s.get(e);r&&(i?r.reject(i):r.resolve(),s=s.remove(e)),n.Tc[n.currentUser.toKey()]=s}}function gu(t,e,i=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t._c.get(e))t.wc.delete(n),i&&t.dc.Pc(n,i);t._c.delete(e),t.isPrimaryClient&&t.Ic.Is(e).forEach(n=>{t.Ic.containsKey(n)||ey(t,n)})}function ey(t,e){t.mc.delete(e.path.canonicalString());const i=t.gc.get(e);i!==null&&(zv(t.remoteStore,i),t.gc=t.gc.remove(e),t.yc.delete(i),$h(t))}function Vf(t,e,i){for(const n of i)n instanceof Qv?(t.Ic.addReference(n.key,e),cE(t,n)):n instanceof Yv?(H("SyncEngine","Document no longer in limbo: "+n.key),t.Ic.removeReference(n.key,e),t.Ic.containsKey(n.key)||ey(t,n.key)):K()}function cE(t,e){const i=e.key,n=i.path.canonicalString();t.gc.get(i)||t.mc.has(n)||(H("SyncEngine","New document in limbo: "+i),t.mc.add(n),$h(t))}function $h(t){for(;t.mc.size>0&&t.gc.size<t.maxConcurrentLimboResolutions;){const e=t.mc.values().next().value;t.mc.delete(e);const i=new z(Ie.fromString(e)),n=t.Ac.next();t.yc.set(n,new eE(i)),t.gc=t.gc.insert(i,n),$v(t.remoteStore,new Zi(Ui(pl(i.path)),n,"TargetPurposeLimboResolution",vh.ct))}}async function Io(t,e,i){const n=ne(t),s=[],r=[],o=[];n.wc.isEmpty()||(n.wc.forEach((a,l)=>{o.push(n.Rc(l,e,i).then(u=>{if((u||i)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(l.targetId,u!=null&&u.fromCache?"not-current":"current"),u){s.push(u);const c=xh.Li(l.targetId,u);r.push(c)}}))}),await Promise.all(o),n.dc.nu(s),await async function(a,l){const u=ne(a);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",c=>A.forEach(l,h=>A.forEach(h.Fi,d=>u.persistence.referenceDelegate.addReference(c,h.targetId,d)).next(()=>A.forEach(h.Bi,d=>u.persistence.referenceDelegate.removeReference(c,h.targetId,d)))))}catch(c){if(!To(c))throw c;H("LocalStore","Failed to update sequence numbers: "+c)}for(const c of l){const h=c.targetId;if(!c.fromCache){const d=u.Ji.get(h),f=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(f);u.Ji=u.Ji.insert(h,p)}}}(n.localStore,r))}async function uE(t,e){const i=ne(t);if(!i.currentUser.isEqual(e)){H("SyncEngine","User change. New user:",e.toKey());const n=await Uv(i.localStore,e);i.currentUser=e,function(s,r){s.Ec.forEach(o=>{o.forEach(a=>{a.reject(new L(E.CANCELLED,r))})}),s.Ec.clear()}(i,"'waitForPendingWrites' promise is rejected due to a user change."),i.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Io(i,n.er)}}function hE(t,e){const i=ne(t),n=i.yc.get(e);if(n&&n.fc)return le().add(n.key);{let s=le();const r=i._c.get(e);if(!r)return s;for(const o of r){const a=i.wc.get(o);s=s.unionWith(a.view.nc)}return s}}function dE(t){const e=ne(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Jv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hE.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oE.bind(null,e),e.dc.nu=YC.bind(null,e.eventManager),e.dc.Pc=JC.bind(null,e.eventManager),e}function fE(t){const e=ne(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=aE.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lE.bind(null,e),e}class Ff{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Tl(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,i){return null}createIndexBackfillerScheduler(e,i){return null}createLocalStore(e){return kC(this.persistence,new bC,e.initialUser,this.serializer)}createPersistence(e){return new vC(Rh.zs,this.serializer)}createSharedClientState(e){return new AC}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class mE{async initialize(e,i){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Of(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=uE.bind(null,this.syncEngine),await KC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new QC}createDatastore(e){const i=Tl(e.databaseInfo.databaseId),n=(s=e.databaseInfo,new DC(s));var s;return function(r,o,a,l){return new NC(r,o,a,l)}(e.authCredentials,e.appCheckCredentials,n,i)}createRemoteStore(e){return i=this.localStore,n=this.datastore,s=e.asyncQueue,r=a=>Of(this.syncEngine,a,0),o=Mf.D()?new Mf:new PC,new VC(i,n,s,r,o);var i,n,s,r,o}createSyncEngine(e,i){return function(n,s,r,o,a,l,u){const c=new tE(n,s,r,o,a,l);return u&&(c.vc=!0),c}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,i)}terminate(){return async function(e){const i=ne(e);H("RemoteStore","RemoteStore shutting down."),i.vu.add(5),await So(i),i.Pu.shutdown(),i.bu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Fi("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,i){this.muted||setTimeout(()=>{this.muted||e(i)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new L(E.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const i=await async function(n,s){const r=ne(n),o=no(r.serializer)+"/documents",a={documents:s.map(h=>Da(r.serializer,h))},l=await r.vo("BatchGetDocuments",o,a,s.length),u=new Map;l.forEach(h=>{const d=K1(r.serializer,h);u.set(d.key.toString(),d)});const c=[];return s.forEach(h=>{const d=u.get(h.toString());ye(!!d),c.push(d)}),c}(this.datastore,e);return i.forEach(n=>this.recordVersion(n)),i}set(e,i){this.write(i.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,i){try{this.write(i.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ch(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(i=>{e.delete(i.key.toString())}),e.forEach((i,n)=>{const s=z.fromPath(n);this.mutations.push(new Iv(s,this.precondition(s)))}),await async function(i,n){const s=ne(i),r=no(s.serializer)+"/documents",o={writes:n.map(a=>Nv(s.serializer,a))};await s.Io("Commit",r,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let i;if(e.isFoundDocument())i=e.version;else{if(!e.isNoDocument())throw K();i=J.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!i.isEqual(n))throw new L(E.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),i)}precondition(e){const i=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&i?i.isEqual(J.min())?vt.exists(!1):vt.updateTime(i):vt.none()}preconditionForUpdate(e){const i=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&i){if(i.isEqual(J.min()))throw new L(E.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vt.updateTime(i)}return vt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e,i,n,s,r){this.asyncQueue=e,this.datastore=i,this.options=n,this.updateFunction=s,this.deferred=r,this.Bc=n.maxAttempts,this.qo=new Dh(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){this.qo.No(async()=>{const e=new pE(this.datastore),i=this.qc(e);i&&i.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(s=>{this.Uc(s)}))}).catch(n=>{this.Uc(n)})})}qc(e){try{const i=this.updateFunction(e);return!_o(i)&&i.catch&&i.then?i:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(i){return this.deferred.reject(i),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if(e.name==="FirebaseError"){const i=e.code;return i==="aborted"||i==="failed-precondition"||i==="already-exists"||!Av(i)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(e,i,n,s){this.authCredentials=e,this.appCheckCredentials=i,this.asyncQueue=n,this.databaseInfo=s,this.user=pt.UNAUTHENTICATED,this.clientId=nv.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async r=>{H("FirestoreClient","Received user=",r.uid),await this.authCredentialListener(r),this.user=r}),this.appCheckCredentials.start(n,r=>(H("FirestoreClient","Received new app check token=",r),this.appCheckCredentialListener(r,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new L(E.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(i){const n=Vh(i,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function wc(t,e){t.asyncQueue.verifyOperationInProgress(),H("FirestoreClient","Initializing OfflineComponentProvider");const i=await t.getConfiguration();await e.initialize(i);let n=i.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await Uv(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Uf(t,e){t.asyncQueue.verifyOperationInProgress();const i=await bE(t);H("FirestoreClient","Initializing OnlineComponentProvider");const n=await t.getConfiguration();await e.initialize(i,n),t.setCredentialChangeListener(s=>Lf(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,r)=>Lf(e.remoteStore,r)),t._onlineComponents=e}function yE(t){return t.name==="FirebaseError"?t.code===E.FAILED_PRECONDITION||t.code===E.UNIMPLEMENTED:!(typeof DOMException!="undefined"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function bE(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){H("FirestoreClient","Using user provided OfflineComponentProvider");try{await wc(t,t._uninitializedComponentsProvider._offline)}catch(e){const i=e;if(!yE(i))throw i;Ts("Error using user provided cache. Falling back to memory cache: "+i),await wc(t,new Ff)}}else H("FirestoreClient","Using default OfflineComponentProvider"),await wc(t,new Ff);return t._offlineComponents}async function jh(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(H("FirestoreClient","Using user provided OnlineComponentProvider"),await Uf(t,t._uninitializedComponentsProvider._online)):(H("FirestoreClient","Using default OnlineComponentProvider"),await Uf(t,new mE))),t._onlineComponents}function wE(t){return jh(t).then(e=>e.syncEngine)}function kE(t){return jh(t).then(e=>e.datastore)}async function La(t){const e=await jh(t),i=e.eventManager;return i.onListen=iE.bind(null,e.syncEngine),i.onUnlisten=sE.bind(null,e.syncEngine),i}function TE(t,e,i={}){const n=new vi;return t.asyncQueue.enqueueAndForget(async()=>function(s,r,o,a,l){const u=new zh({next:h=>{r.enqueueAndForget(()=>Uh(s,c));const d=h.docs.has(o);!d&&h.fromCache?l.reject(new L(E.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?l.reject(new L(E.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(h)},error:h=>l.reject(h)}),c=new Bh(pl(o.path),u,{includeMetadataChanges:!0,Ku:!0});return Fh(s,c)}(await La(t),t.asyncQueue,e,i,n)),n.promise}function _E(t,e,i={}){const n=new vi;return t.asyncQueue.enqueueAndForget(async()=>function(s,r,o,a,l){const u=new zh({next:h=>{r.enqueueAndForget(()=>Uh(s,c)),h.fromCache&&a.source==="server"?l.reject(new L(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(h)},error:h=>l.reject(h)}),c=new Bh(o,u,{includeMetadataChanges:!0,Ku:!0});return Fh(s,c)}(await La(t),t.asyncQueue,e,i,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(t,e,i){if(!i)throw new L(E.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function CE(t,e,i,n){if(e===!0&&n===!0)throw new L(E.INVALID_ARGUMENT,`${t} and ${i} cannot be used together.`)}function Bf(t){if(!z.isDocumentKey(t))throw new L(E.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $f(t){if(z.isDocumentKey(t))throw new L(E.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function El(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":K()}function Lt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new L(E.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const i=El(t);throw new L(E.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${i}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e){var i,n;if(e.host===void 0){if(e.ssl!==void 0)throw new L(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(i=e.ssl)===null||i===void 0||i;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new L(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}CE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ty((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(E.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(i=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,i.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var i,n}}class Sl{constructor(e,i,n,s){this._authCredentials=e,this._appCheckCredentials=i,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zf({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new L(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new L(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zf(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new q_;switch(i.type){case"firstParty":return new Q_(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new L(E.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const i=Hf.get(e);i&&(H("ComponentProvider","Removing Datastore"),Hf.delete(e),i.terminate())}(this),Promise.resolve()}}function EE(t,e,i,n={}){var s;const r=(t=Lt(t,Sl))._getSettings(),o=`${e}:${i}`;if(r.host!=="firestore.googleapis.com"&&r.host!==o&&Ts("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},r),{host:o,ssl:!1})),n.mockUserToken){let a,l;if(typeof n.mockUserToken=="string")a=n.mockUserToken,l=pt.MOCK_USER;else{a=pp(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new L(E.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new pt(u)}t._authCredentials=new W_(new iv(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,i,n){this.converter=i,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new nn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ft(this.firestore,e,this._key)}}class dn{constructor(e,i,n){this.converter=i,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new dn(this.firestore,e,this._query)}}class nn extends dn{constructor(e,i,n){super(e,i,pl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ft(this.firestore,null,new z(e))}withConverter(e){return new nn(this.firestore,e,this._path)}}function ny(t,e,...i){if(t=Ue(t),iy("collection","path",e),t instanceof Sl){const n=Ie.fromString(e,...i);return $f(n),new nn(t,null,n)}{if(!(t instanceof ft||t instanceof nn))throw new L(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ie.fromString(e,...i));return $f(n),new nn(t.firestore,null,n)}}function At(t,e,...i){if(t=Ue(t),arguments.length===1&&(e=nv.A()),iy("doc","path",e),t instanceof Sl){const n=Ie.fromString(e,...i);return Bf(n),new ft(t,null,new z(n))}{if(!(t instanceof ft||t instanceof nn))throw new L(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ie.fromString(e,...i));return Bf(n),new ft(t.firestore,t instanceof nn?t.converter:null,new z(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Dh(this,"async_queue_retry"),this.Xc=()=>{const i=bc();i&&H("AsyncQueue","Visibility state changed to "+i.visibilityState),this.qo.Mo()};const e=bc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const i=bc();i&&typeof i.removeEventListener=="function"&&i.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const i=new vi;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(i.resolve,i.reject),i.promise)).then(()=>i.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(this.Qc.length!==0){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!To(e))throw e;H("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const i=this.Gc.then(()=>(this.Hc=!0,e().catch(n=>{this.Wc=n,this.Hc=!1;const s=function(r){let o=r.message||"";return r.stack&&(o=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),o}(n);throw Fi("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.Hc=!1,n))));return this.Gc=i,i}enqueueAfterDelay(e,i,n){this.Zc(),this.Yc.indexOf(e)>-1&&(i=0);const s=Oh.createAndSchedule(this,e,i,n,r=>this.na(r));return this.zc.push(s),s}Zc(){this.Wc&&K()}verifyOperationInProgress(){}async sa(){let e;do e=this.Gc,await e;while(e!==this.Gc)}ia(e){for(const i of this.zc)if(i.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((i,n)=>i.targetTimeMs-n.targetTimeMs);for(const i of this.zc)if(i.skipDelay(),e!=="all"&&i.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const i=this.zc.indexOf(e);this.zc.splice(i,1)}}function jf(t){return function(e,i){if(typeof e!="object"||e===null)return!1;const n=e;for(const s of i)if(s in n&&typeof n[s]=="function")return!0;return!1}(t,["next","error","complete"])}class Bi extends Sl{constructor(e,i,n,s){super(e,i,n,s),this.type="firestore",this._queue=new SE,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||sy(this),this._firestoreClient.terminate()}}function IE(t,e){const i=typeof t=="object"?t:Vu(),n=typeof t=="string"?t:e||"(default)",s=Ya(i,"firestore").getImmediate({identifier:n});if(!s._initialized){const r=dp("firestore");r&&EE(s,...r)}return s}function Ao(t){return t._firestoreClient||sy(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function sy(t){var e,i,n;const s=t._freezeSettings(),r=function(o,a,l,u){return new a1(o,a,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,ty(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new vE(t._authCredentials,t._appCheckCredentials,t._queue,r),((i=s.cache)===null||i===void 0?void 0:i._offlineComponentProvider)&&((n=s.cache)===null||n===void 0?void 0:n._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.cache.kind,_offline:s.cache._offlineComponentProvider,_online:s.cache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vn(Tt.fromBase64String(e))}catch(i){throw new L(E.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+i)}}static fromUint8Array(e){return new Vn(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(...e){for(let i=0;i<e.length;++i)if(e[i].length===0)throw new L(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,i){if(!isFinite(e)||e<-90||e>90)throw new L(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(i)||i<-180||i>180)throw new L(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+i);this._lat=e,this._long=i}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return pe(this._lat,e._lat)||pe(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AE=/^__.*__$/;class PE{constructor(e,i,n){this.data=e,this.fieldMask=i,this.fieldTransforms=n}toMutation(e,i){return this.fieldMask!==null?new hn(e,this.data,this.fieldMask,i,this.fieldTransforms):new Co(e,this.data,i,this.fieldTransforms)}}class ry{constructor(e,i,n){this.data=e,this.fieldMask=i,this.fieldTransforms=n}toMutation(e,i){return new hn(e,this.data,this.fieldMask,i,this.fieldTransforms)}}function oy(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw K()}}class Wh{constructor(e,i,n,s,r,o){this.settings=e,this.databaseId=i,this.serializer=n,this.ignoreUndefinedProperties=s,r===void 0&&this.ua(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Wh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var i;const n=(i=this.path)===null||i===void 0?void 0:i.child(e),s=this.aa({path:n,la:!1});return s.fa(e),s}da(e){var i;const n=(i=this.path)===null||i===void 0?void 0:i.child(e),s=this.aa({path:n,la:!1});return s.ua(),s}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return Na(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return this.fieldMask.find(i=>e.isPrefixOf(i))!==void 0||this.fieldTransforms.find(i=>e.isPrefixOf(i.field))!==void 0}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(e.length===0)throw this._a("Document fields must not be empty");if(oy(this.ca)&&AE.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class RE{constructor(e,i,n){this.databaseId=e,this.ignoreUndefinedProperties=i,this.serializer=n||Tl(e)}ya(e,i,n,s=!1){return new Wh({ca:e,methodName:i,ga:n,path:gt.emptyPath(),la:!1,ma:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ro(t){const e=t._freezeSettings(),i=Tl(t._databaseId);return new RE(t._databaseId,!!e.ignoreUndefinedProperties,i)}function Kh(t,e,i,n,s,r={}){const o=t.ya(r.merge||r.mergeFields?2:0,e,i,s);Qh("Data must be an object, but it was:",o,n);const a=cy(n,o);let l,u;if(r.merge)l=new Ft(o.fieldMask),u=o.fieldTransforms;else if(r.mergeFields){const c=[];for(const h of r.mergeFields){const d=vu(e,h,i);if(!o.contains(d))throw new L(E.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);hy(c,d)||c.push(d)}l=new Ft(c),u=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,u=o.fieldTransforms;return new PE(new Et(a),l,u)}class Al extends Il{_toFieldTransform(e){if(e.ca!==2)throw e.ca===1?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Al}}class Gh extends Il{_toFieldTransform(e){return new R1(e.path,new eo)}isEqual(e){return e instanceof Gh}}function ay(t,e,i,n){const s=t.ya(1,e,i);Qh("Data must be an object, but it was:",s,n);const r=[],o=Et.empty();$n(n,(l,u)=>{const c=Yh(e,l,i);u=Ue(u);const h=s.da(c);if(u instanceof Al)r.push(c);else{const d=xo(u,h);d!=null&&(r.push(c),o.set(c,d))}});const a=new Ft(r);return new ry(o,a,s.fieldTransforms)}function ly(t,e,i,n,s,r){const o=t.ya(1,e,i),a=[vu(e,n,i)],l=[s];if(r.length%2!=0)throw new L(E.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<r.length;d+=2)a.push(vu(e,r[d])),l.push(r[d+1]);const u=[],c=Et.empty();for(let d=a.length-1;d>=0;--d)if(!hy(u,a[d])){const f=a[d];let p=l[d];p=Ue(p);const T=o.da(f);if(p instanceof Al)u.push(f);else{const v=xo(p,T);v!=null&&(u.push(f),c.set(f,v))}}const h=new Ft(u);return new ry(c,h,o.fieldTransforms)}function xE(t,e,i,n=!1){return xo(i,t.ya(n?4:3,e))}function xo(t,e){if(uy(t=Ue(t)))return Qh("Unsupported field value:",e,t),cy(t,e);if(t instanceof Il)return function(i,n){if(!oy(n.ca))throw n._a(`${i._methodName}() can only be used with update() and set()`);if(!n.path)throw n._a(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(n);s&&n.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.la&&e.ca!==4)throw e._a("Nested arrays are not supported");return function(i,n){const s=[];let r=0;for(const o of i){let a=xo(o,n.wa(r));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),r++}return{arrayValue:{values:s}}}(t,e)}return function(i,n){if((i=Ue(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return I1(n.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=Ge.fromDate(i);return{timestampValue:xa(n.serializer,s)}}if(i instanceof Ge){const s=new Ge(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:xa(n.serializer,s)}}if(i instanceof qh)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Vn)return{bytesValue:Dv(n.serializer,i._byteString)};if(i instanceof ft){const s=n.databaseId,r=i.firestore._databaseId;if(!r.isEqual(s))throw n._a(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ah(i.firestore._databaseId||n.databaseId,i._key.path)}}throw n._a(`Unsupported field value: ${El(i)}`)}(t,e)}function cy(t,e){const i={};return sv(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$n(t,(n,s)=>{const r=xo(s,e.ha(n));r!=null&&(i[n]=r)}),{mapValue:{fields:i}}}function uy(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ge||t instanceof qh||t instanceof Vn||t instanceof ft||t instanceof Il)}function Qh(t,e,i){if(!uy(i)||!function(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}(i)){const n=El(i);throw n==="an object"?e._a(t+" a custom object"):e._a(t+" "+n)}}function vu(t,e,i){if((e=Ue(e))instanceof Po)return e._internalPath;if(typeof e=="string")return Yh(t,e);throw Na("Field path arguments must be of type string or ",t,!1,void 0,i)}const DE=new RegExp("[~\\*/\\[\\]]");function Yh(t,e,i){if(e.search(DE)>=0)throw Na(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,i);try{return new Po(...e.split("."))._internalPath}catch{throw Na(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,i)}}function Na(t,e,i,n,s){const r=n&&!n.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;i&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${n}`),o&&(l+=` in document ${s}`),l+=")"),new L(E.INVALID_ARGUMENT,a+t+l)}function hy(t,e){return t.some(i=>i.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,i,n,s,r){this._firestore=e,this._userDataWriter=i,this._key=n,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ME(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const i=this._document.data.field(Jh("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i)}}}class ME extends Oa{data(){return super.data()}}function Jh(t,e){return typeof e=="string"?Yh(t,e):e instanceof Po?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dy(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new L(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Xh{}class fy extends Xh{}function LE(t,e,...i){let n=[];e instanceof Xh&&n.push(e),n=n.concat(i),function(s){const r=s.filter(a=>a instanceof ed).length,o=s.filter(a=>a instanceof Zh).length;if(r>1||r>0&&o>0)throw new L(E.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class Zh extends fy{constructor(e,i,n){super(),this._field=e,this._op=i,this._value=n,this.type="where"}static _create(e,i,n){return new Zh(e,i,n)}_apply(e){const i=this._parse(e);return my(e._query,i),new dn(e.firestore,e.converter,uu(e._query,i))}_parse(e){const i=Ro(e.firestore);return function(s,r,o,a,l,u,c){let h;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new L(E.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Wf(c,u);const d=[];for(const f of c)d.push(qf(a,s,f));h={arrayValue:{values:d}}}else h=qf(a,s,c)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Wf(c,u),h=xE(o,r,c,u==="in"||u==="not-in");return We.create(l,u,h)}(e._query,"where",i,e.firestore._databaseId,this._field,this._op,this._value)}}class ed extends Xh{constructor(e,i){super(),this.type=e,this._queryConstraints=i}static _create(e,i){return new ed(e,i)}_parse(e){const i=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return i.length===1?i[0]:si.create(i,this._getOperator())}_apply(e){const i=this._parse(e);return i.getFilters().length===0?e:(function(n,s){let r=n;const o=s.getFlattenedFilters();for(const a of o)my(r,a),r=uu(r,a)}(e._query,i),new dn(e.firestore,e.converter,uu(e._query,i)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class td extends fy{constructor(e,i){super(),this._field=e,this._direction=i,this.type="orderBy"}static _create(e,i){return new td(e,i)}_apply(e){const i=function(n,s,r){if(n.startAt!==null)throw new L(E.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(n.endAt!==null)throw new L(E.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new ps(s,r);return function(a,l){if(_h(a)===null){const u=gl(a);u!==null&&py(a,u,l.field)}}(n,o),o}(e._query,this._field,this._direction);return new dn(e.firestore,e.converter,function(n,s){const r=n.explicitOrderBy.concat([s]);return new Vs(n.path,n.collectionGroup,r,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,i))}}function NE(t,e="asc"){const i=e,n=Jh("orderBy",t);return td._create(n,i)}function qf(t,e,i){if(typeof(i=Ue(i))=="string"){if(i==="")throw new L(E.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fv(e)&&i.indexOf("/")!==-1)throw new L(E.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${i}' contains a '/' character.`);const n=e.path.child(Ie.fromString(i));if(!z.isDocumentKey(n))throw new L(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return mf(t,new z(n))}if(i instanceof ft)return mf(t,i._key);throw new L(E.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${El(i)}.`)}function Wf(t,e){if(!Array.isArray(t)||t.length===0)throw new L(E.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function my(t,e){if(e.isInequality()){const n=gl(t),s=e.field;if(n!==null&&!n.isEqual(s))throw new L(E.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${s.toString()}'`);const r=_h(t);r!==null&&py(t,s,r)}const i=function(n,s){for(const r of n)for(const o of r.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(i!==null)throw i===e.op?new L(E.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new L(E.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${i.toString()}' filters.`)}function py(t,e,i){if(!i.isEqual(e))throw new L(E.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${i.toString()}' instead.`)}class gy{convertValue(e,i="none"){switch(On(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,i);case 5:return e.stringValue;case 6:return this.convertBytes(Nn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,i);case 10:return this.convertObject(e.mapValue,i);default:throw K()}}convertObject(e,i){return this.convertObjectMap(e.fields,i)}convertObjectMap(e,i="none"){const n={};return $n(e,(s,r)=>{n[s]=this.convertValue(r,i)}),n}convertGeoPoint(e){return new qh(qe(e.latitude),qe(e.longitude))}convertArray(e,i){return(e.values||[]).map(n=>this.convertValue(n,i))}convertServerTimestamp(e,i){switch(i){case"previous":const n=bh(e);return n==null?null:this.convertValue(n,i);case"estimate":return this.convertTimestamp(Jr(e));default:return null}}convertTimestamp(e){const i=an(e);return new Ge(i.seconds,i.nanos)}convertDocumentKey(e,i){const n=Ie.fromString(e);ye(Fv(n));const s=new Xr(n.get(1),n.get(3)),r=new z(n.popFirst(5));return s.isEqual(i)||Fi(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${i.projectId}/${i.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function id(t,e,i){let n;return n=t?i&&(i.merge||i.mergeFields)?t.toFirestore(e,i):t.toFirestore(e):e,n}class OE extends gy{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vn(e)}convertReference(e){const i=this.convertDocumentKey(e,this.firestore._databaseId);return new ft(this.firestore,null,i)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,i){this.hasPendingWrites=e,this.fromCache=i}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nd extends Oa{constructor(e,i,n,s,r,o){super(e,i,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const i=new aa(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(i,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,i={}){if(this._document){const n=this._document.data.field(Jh("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,i.serverTimestamps)}}}class aa extends nd{data(e={}){return super.data(e)}}class vy{constructor(e,i,n,s){this._firestore=e,this._userDataWriter=i,this._snapshot=s,this.metadata=new as(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(i=>e.push(i)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,i){this._snapshot.docs.forEach(n=>{e.call(i,new aa(this._firestore,this._userDataWriter,n.key,n,new as(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const i=!!e.includeMetadataChanges;if(i&&this._snapshot.excludesMetadataChanges)throw new L(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===i||(this._cachedChanges=function(n,s){if(n._snapshot.oldDocs.isEmpty()){let r=0;return n._snapshot.docChanges.map(o=>{const a=new aa(n._firestore,n._userDataWriter,o.doc.key,o.doc,new as(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:r++}})}{let r=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new aa(n._firestore,n._userDataWriter,o.doc.key,o.doc,new as(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);let l=-1,u=-1;return o.type!==0&&(l=r.indexOf(o.doc.key),r=r.delete(o.doc.key)),o.type!==1&&(r=r.add(o.doc),u=r.indexOf(o.doc.key)),{type:VE(o.type),doc:a,oldIndex:l,newIndex:u}})}}(this,i),this._cachedChangesIncludeMetadataChanges=i),this._cachedChanges}}function VE(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return K()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pl(t){t=Lt(t,ft);const e=Lt(t.firestore,Bi);return TE(Ao(e),t._key).then(i=>by(e,t,i))}class Rl extends gy{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vn(e)}convertReference(e){const i=this.convertDocumentKey(e,this.firestore._databaseId);return new ft(this.firestore,null,i)}}function FE(t){t=Lt(t,dn);const e=Lt(t.firestore,Bi),i=Ao(e),n=new Rl(e);return dy(t._query),_E(i,t._query).then(s=>new vy(e,n,t,s))}function yy(t,e,i){t=Lt(t,ft);const n=Lt(t.firestore,Bi),s=id(t.converter,e,i);return sd(n,[Kh(Ro(n),"setDoc",t._key,s,t.converter!==null,i).toMutation(t._key,vt.none())])}function xl(t,e,i,...n){t=Lt(t,ft);const s=Lt(t.firestore,Bi),r=Ro(s);let o;return o=typeof(e=Ue(e))=="string"||e instanceof Po?ly(r,"updateDoc",t._key,e,i,n):ay(r,"updateDoc",t._key,e),sd(s,[o.toMutation(t._key,vt.exists(!0))])}function UE(t,e){const i=Lt(t.firestore,Bi),n=At(t),s=id(t.converter,e);return sd(i,[Kh(Ro(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,vt.exists(!1))]).then(()=>n)}function Kf(t,...e){var i,n,s;t=Ue(t);let r={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||jf(e[o])||(r=e[o],o++);const a={includeMetadataChanges:r.includeMetadataChanges};if(jf(e[o])){const h=e[o];e[o]=(i=h.next)===null||i===void 0?void 0:i.bind(h),e[o+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let l,u,c;if(t instanceof ft)u=Lt(t.firestore,Bi),c=pl(t._key.path),l={next:h=>{e[o]&&e[o](by(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=Lt(t,dn);u=Lt(h.firestore,Bi),c=h._query;const d=new Rl(u);l={next:f=>{e[o]&&e[o](new vy(u,d,h,f))},error:e[o+1],complete:e[o+2]},dy(t._query)}return function(h,d,f,p){const T=new zh(p),v=new Bh(d,T,f);return h.asyncQueue.enqueueAndForget(async()=>Fh(await La(h),v)),()=>{T.Dc(),h.asyncQueue.enqueueAndForget(async()=>Uh(await La(h),v))}}(Ao(u),c,a,l)}function sd(t,e){return function(i,n){const s=new vi;return i.asyncQueue.enqueueAndForget(async()=>rE(await wE(i),n,s)),s.promise}(Ao(t),e)}function by(t,e,i){const n=i.docs.get(e._key),s=new Rl(t);return new nd(t,s,e._key,n,new as(i.hasPendingWrites,i.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE={maxAttempts:5};function fr(t,e){if((t=Ue(t)).firestore!==e)throw new L(E.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE extends class{constructor(e,i){this._firestore=e,this._transaction=i,this._dataReader=Ro(e)}get(e){const i=fr(e,this._firestore),n=new OE(this._firestore);return this._transaction.lookup([i._key]).then(s=>{if(!s||s.length!==1)return K();const r=s[0];if(r.isFoundDocument())return new Oa(this._firestore,n,r.key,r,i.converter);if(r.isNoDocument())return new Oa(this._firestore,n,i._key,null,i.converter);throw K()})}set(e,i,n){const s=fr(e,this._firestore),r=id(s.converter,i,n),o=Kh(this._dataReader,"Transaction.set",s._key,r,s.converter!==null,n);return this._transaction.set(s._key,o),this}update(e,i,n,...s){const r=fr(e,this._firestore);let o;return o=typeof(i=Ue(i))=="string"||i instanceof Po?ly(this._dataReader,"Transaction.update",r._key,i,n,s):ay(this._dataReader,"Transaction.update",r._key,i),this._transaction.update(r._key,o),this}delete(e){const i=fr(e,this._firestore);return this._transaction.delete(i._key),this}}{constructor(e,i){super(e,i),this._firestore=e}get(e){const i=fr(e,this._firestore),n=new Rl(this._firestore);return super.get(e).then(s=>new nd(this._firestore,n,i._key,s._document,new as(!1,!1),i.converter))}}function Do(t,e,i){t=Lt(t,Bi);const n=Object.assign(Object.assign({},HE),i);return function(s){if(s.maxAttempts<1)throw new L(E.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,r,o){const a=new vi;return s.asyncQueue.enqueueAndForget(async()=>{const l=await kE(s);new gE(s.asyncQueue,l,o,r,a).run()}),a.promise}(Ao(t),s=>e(new BE(t,s)),n)}function $E(){return new Gh("serverTimestamp")}(function(t,e=!0){(function(i){Os=i})(Hn),xn(new rn("firestore",(i,{instanceIdentifier:n,options:s})=>{const r=i.getProvider("app").getImmediate(),o=new Bi(new K_(i.getProvider("auth-internal")),new J_(i.getProvider("app-check-internal")),function(a,l){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new L(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xr(a.options.projectId,l)}(r,n),r);return s=Object.assign({useFetchStreams:e},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),mi(cf,"3.13.0",t),mi(cf,"3.13.0","esm2017")})();var zE="firebase",jE="9.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mi(zE,jE,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wy="firebasestorage.googleapis.com",qE="storageBucket",WE=2*60*1e3,KE=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends Ti{constructor(e,i,n=0){super(kc(e),`Firebase Storage: ${i} (${kc(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,_i.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return kc(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var bi;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(bi||(bi={}));function kc(t){return"storage/"+t}function GE(){const t="An unknown error occurred, please check the error payload for server response.";return new _i(bi.UNKNOWN,t)}function QE(){return new _i(bi.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function YE(){return new _i(bi.CANCELED,"User canceled the upload/download.")}function JE(t){return new _i(bi.INVALID_URL,"Invalid URL '"+t+"'.")}function XE(t){return new _i(bi.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Gf(t){return new _i(bi.INVALID_ARGUMENT,t)}function ky(){return new _i(bi.APP_DELETED,"The Firebase app was deleted.")}function ZE(t){return new _i(bi.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,i){this.bucket=e,this.path_=i}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,i){let n;try{n=Zt.makeFromUrl(e,i)}catch{return new Zt(e,"")}if(n.path==="")return n;throw XE(e)}static makeFromUrl(e,i){let n=null;const s="([A-Za-z0-9.\\-_]+)";function r(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function u(V){V.path_=decodeURIComponent(V.path)}const c="v[A-Za-z0-9_]+",h=i.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${c}/b/${s}/o${d}`,"i"),p={bucket:1,path:3},T=i===wy?"(?:storage.googleapis.com|storage.cloud.google.com)":i,v="([^?#]*)",S=new RegExp(`^https?://${T}/${s}/${v}`,"i"),I=[{regex:a,indices:l,postModify:r},{regex:f,indices:p,postModify:u},{regex:S,indices:{bucket:1,path:2},postModify:u}];for(let V=0;V<I.length;V++){const G=I[V],P=G.regex.exec(e);if(P){const ue=P[G.indices.bucket];let oe=P[G.indices.path];oe||(oe=""),n=new Zt(ue,oe),G.postModify(n);break}}if(n==null)throw JE(e);return n}}class eS{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(t,e,i){let n=1,s=null,r=null,o=!1,a=0;function l(){return a===2}let u=!1;function c(...v){u||(u=!0,e.apply(null,v))}function h(v){s=setTimeout(()=>{s=null,t(f,l())},v)}function d(){r&&clearTimeout(r)}function f(v,...S){if(u){d();return}if(v){d(),c.call(null,v,...S);return}if(l()||o){d(),c.call(null,v,...S);return}n<64&&(n*=2);let I;a===1?(a=2,I=0):I=(n+Math.random())*1e3,h(I)}let p=!1;function T(v){p||(p=!0,d(),!u&&(s!==null?(v||(a=2),clearTimeout(s),h(0)):v||(a=1)))}return h(0),r=setTimeout(()=>{o=!0,T(!0)},i),T}function iS(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t){return t!==void 0}function Qf(t,e,i,n){if(n<e)throw Gf(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>i)throw Gf(`Invalid value for '${t}'. Expected ${i} or less.`)}function sS(t){const e=encodeURIComponent;let i="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);i=i+s+"&"}return i=i.slice(0,-1),i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Va;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Va||(Va={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(t,e){const i=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,r=e.indexOf(t)!==-1;return i||s||r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e,i,n,s,r,o,a,l,u,c,h,d=!0){this.url_=e,this.method_=i,this.headers_=n,this.body_=s,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=c,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,p)=>{this.resolve_=f,this.reject_=p,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new Go(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=a=>{const l=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const a=r.getErrorCode()===Va.NO_ERROR,l=r.getStatus();if(!a||rS(l,this.additionalRetryCodes_)&&this.retry){const c=r.getErrorCode()===Va.ABORT;n(!1,new Go(!1,null,c));return}const u=this.successCodes_.indexOf(l)!==-1;n(!0,new Go(u,r))})},i=(n,s)=>{const r=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());nS(l)?r(l):r()}catch(l){o(l)}else if(a!==null){const l=GE();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?ky():YE();o(l)}else{const l=QE();o(l)}};this.canceled_?i(!1,new Go(!1,null,!0)):this.backoffId_=tS(e,i,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&iS(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Go{constructor(e,i,n){this.wasSuccessCode=e,this.connection=i,this.canceled=!!n}}function aS(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function lS(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function cS(t,e){e&&(t["X-Firebase-GMPID"]=e)}function uS(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function hS(t,e,i,n,s,r,o=!0){const a=sS(t.urlParams),l=t.url+a,u=Object.assign({},t.headers);return cS(u,e),aS(u,i),lS(u,r),uS(u,n),new oS(l,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function fS(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e,i){this._service=e,i instanceof Zt?this._location=i:this._location=Zt.makeFromUrl(i,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,i){return new Fa(e,i)}get root(){const e=new Zt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return fS(this._location.path)}get storage(){return this._service}get parent(){const e=dS(this._location.path);if(e===null)return null;const i=new Zt(this._location.bucket,e);return new Fa(this._service,i)}_throwIfRoot(e){if(this._location.path==="")throw ZE(e)}}function Yf(t,e){const i=e==null?void 0:e[qE];return i==null?null:Zt.makeFromBucketSpec(i,t)}function mS(t,e,i,n={}){t.host=`${e}:${i}`,t._protocol="http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:pp(s,t.app.options.projectId))}class pS{constructor(e,i,n,s,r){this.app=e,this._authProvider=i,this._appCheckProvider=n,this._url=s,this._firebaseVersion=r,this._bucket=null,this._host=wy,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=WE,this._maxUploadRetryTime=KE,this._requests=new Set,s!=null?this._bucket=Zt.makeFromBucketSpec(s,this._host):this._bucket=Yf(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Zt.makeFromBucketSpec(this._url,e):this._bucket=Yf(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Qf("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Qf("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const i=await e.getToken();if(i!==null)return i.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Fa(this,e)}_makeRequest(e,i,n,s,r=!0){if(this._deleted)return new eS(ky());{const o=hS(e,this._appId,n,s,i,this._firebaseVersion,r);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,i){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,i,n,s).getPromise()}}const Jf="@firebase/storage",Xf="0.11.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ty="storage";function gS(t=Vu(),e){t=Ue(t);const n=Ya(t,Ty).getImmediate({identifier:e}),s=dp("storage");return s&&vS(n,...s),n}function vS(t,e,i,n={}){mS(t,e,i,n)}function yS(t,{instanceIdentifier:e}){const i=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new pS(i,n,s,e,Hn)}function bS(){xn(new rn(Ty,yS,"PUBLIC").setMultipleInstances(!0)),mi(Jf,Xf,""),mi(Jf,Xf,"esm2017")}bS();const Yn=[];function Hs(t,e=Ee){let i;const n=new Set;function s(a){if(Je(t,a)&&(t=a,i)){const l=!Yn.length;for(const u of n)u[1](),Yn.push(u,t);if(l){for(let u=0;u<Yn.length;u+=2)Yn[u][0](Yn[u+1]);Yn.length=0}}}function r(a){s(a(t))}function o(a,l=Ee){const u=[a,l];return n.add(u),n.size===1&&(i=e(s)||Ee),a(t),()=>{n.delete(u),n.size===0&&i&&(i(),i=null)}}return{set:s,update:r,subscribe:o}}const wS={apiKey:"AIzaSyDkdKO_KE0b2S6bg9CNH-yBGB-0Ph6GOXI",authDomain:"svelte-vid-sync-chat-app.firebaseapp.com",databaseURL:"https://svelte-vid-sync-chat-app-default-rtdb.firebaseio.com",projectId:"svelte-vid-sync-chat-app",storageBucket:"svelte-vid-sync-chat-app.appspot.com",messagingSenderId:"847886552871",appId:"1:847886552871:web:e858b721ad999f26696302",measurementId:"G-CC4NVFPPX7"};yp(wS);const Qe=IE();gS();const kS=Ku(),Dl="survivor-participants",Ml="survivor-groups",TS="survivor-meta",As=Hs({}),Fn=Hs({}),Mr=Hs(!1),wi=Hs(null),is=Hs(null),la=$E(),_y={maxGroupSize:4,minGroupSize:3,DEBUG_MODE:!1},_S=[{BBB:["f0055n5","f006c2v","f00563r","f0055n3"],DEV:["f004p57","dev_test_1","dev_test_2","dev_test_3"],DVBrainiac:["f004gvv","f0055kp","f0069ys","f005cj7"],EFD:["f005g15","f005g97","f0055k8","f005cn2"],"Freud's Favorites":["f0055q9","f005cyh","f005d1c","f005crp"],"Pavlov's Dawgs":["f004r11","f005cn4","f004rhy","f004msc"],"Psychiatric Trio":["f003xfx","f004r80","f004hd0","f004r1m"],"Team Luke":["f005cpx","f003pt8","f004p6r","f004ggx"],"The Psychedelics":["f006h88","f006bp5","f006hr8","f006b47"],"The Unreasonable Ocho":["f004hcz","f004ppp","f00560z","f003x6m"]}],Zf=["f0055n5","f006c2v","f00563r","f0055n3","f004p57","dev_test_1","dev_test_2","dev_test_3","f004gvv","f0055kp","f0069ys","f005cj7","f005g15","f005g97","f0055k8","f005cn2","f0055q9","f005cyh","f005d1c","f005crp","f004r11","f005cn4","f004rhy","f004msc","f003xfx","f004r80","f004hd0","f004r1m","f005cpx","f003pt8","f004p6r","f004ggx","f006h88","f006bp5","f006hr8","f006b47","f004hcz","f004ppp","f00560z","f003x6m"].sort(),em=async(t,e,i)=>{const n=At(Qe,TS,`${t}`),o=(await Pl(n)).data().members;let a=`${t}_${i}`;if(Object.values(o).includes(e))console.log(`netId ${e} is a member of ${t}`),await ES(t,e,i),await SS(a,e,i);else{let u=`netId ${e} not a member of ${t}`;throw console.log("utils -- netIdError",u),new Error(u)}},CS=t=>{if(isNaN(t))return"...";const e=Math.floor(t/60);return t=Math.floor(t%60),t<10&&(t="0"+t),`${e}:${t}`},ES=async(t,e,i)=>{try{const n=`${t}_${i}_${e}`;console.log("initUser -- userId",n);let s=`${t}_${i}_${e}@experiment.com`;console.log("initUser -- groupId",t),console.log("initUser -- netId",e),console.log("initUser -- epNum",i),console.log("initUser -- email",s);let r=`${t}_${i}`;console.log("initUser -- combinedGroupIdEpNum",r);const o=At(Qe,Dl,n);(await Pl(o)).exists()?console.log(`User doc already exists for ${n}`):(console.log(`Creating user doc for ${n}...`),await yy(o,{email:s,userId:n,groupId:t,groupDocName:r,netId:e,epNum:i,loggedIn:!0,currentVideoTime:0})),console.log(`'New user ${n} successfully created with document ID ${o.id}`)}catch{console.log(`Error adding new user ${wi} doc to survivor-participants collection`)}},SS=async(t,e,i)=>{console.log("initGroup -- groupId",t);const n=At(Qe,Ml,t);if((await Pl(n)).exists())console.log(`Group doc already exists for ${t}`);else{console.log(`Group ${t} document does not exist! Creating now...`);try{await yy(n,{counter:[e],users:[],host:e,groupId:t,epNum:i,logVideoTimestamp:!1,currentState:"request-full-screen",videoTime:0,currentVideoTimes:[]}),console.log(`New group ${t} successfully created with document ID: ${n.id}`)}catch(r){console.log(r)}}},IS=async(t,e)=>{const i=At(Qe,Dl,t);await Do(Qe,async n=>{const s=await n.get(i);if(!s.exists())throw"Document does not exist!";const{videoTime:r}=s.data();e>r&&await xl(i,{videoTime:e})})},tm=async(t,e)=>{for(let i=0;i<t.length;i++){const n=At(Qe,Dl,t[i]);await xl(n,{logVideoTimestamp:e})}},AS=async(t,e)=>{const i=At(Qe,Ml,t);await xl(i,{newMessage:e})},PS=async(t,e)=>{console.log("queryGroupTimestamps -- groupId",t),console.log("queryGroupTimestamps -- groupMembers",e);let i=[];for(let n=0;n<e.length;n++){const s=At(Qe,Dl,e[n]);await Do(Qe,async r=>{const o=await r.get(s);if(!o.exists())throw"Document does not exist!";const{videoTime:a}=o.data();i.push(a)})}return Math.max(...i)},RS=async(t,e)=>{console.log("addMessage -- groupDocName",t),console.log("addMessage -- messageObj",e),e.absolute_timestamp=la;const i=At(Qe,Ml,t),n=await Pl(i),s=ny(i,"messages");if(n.exists()){console.log(`Group doc already exists for ${t}`);try{await xl(i,{newMessage:!0}),await UE(s,e),console.log(`New message successfully added to group ${t}`)}catch(r){console.log(r)}}},Qo=async t=>{const e=At(Qe,Ml,t),i=ny(e,"messages"),n=LE(i,NE("absolute_timestamp","asc"));try{const r=(await FE(n)).docs.map(o=>o.data());return console.log(r),r}catch(s){throw console.error("Error getting messages:",s),s}},xS=async t=>{const{groupId:e}=Nr(Fn),{netId:i}=Nr(As),n=At(Qe,"survivor-groups",e);console.log("reqStateChange -- newState",t),console.log("reqStateChange -- groupId",e),console.log("reqStateChange -- userId",wi);try{await Do(Qe,async s=>{const r=await s.get(n);if(!r.exists())throw"Document does not exist!";const{counter:o,currentState:a,users:l,groupId:u,epNum:c}=r.data();console.log(`Participant: ${wi} is requesting state change: ${a} -> ${t}`);let h=`${u}_${i}`;o.includes(i)?console.log("Ignoring duplicate request"):await s.update(n,{counter:[...o,i]}),l.includes(h)?console.log("Ignoring duplicate request"):await s.update(n,{users:[...l,h]})})}catch(s){console.error(`Error updating state to ${t} for group: ${e}`,s)}await DS(t)},DS=async t=>{const{groupId:e}=Nr(Fn),i=At(Qe,"survivor-groups",e);try{await Do(Qe,async n=>{const s=await n.get(i);if(!s.exists())throw"Document does not exist!";const{counter:r}=s.data();if(r.length===_y.minGroupSize){console.log("Last request...initiating state change");const o={};o.counter=[],o.currentState=t,await n.update(i,o)}else console.log(`Still waiting for ${3-r.length} requests...`)})}catch(n){console.error("Error verifying state change",n)}},MS=async t=>{const{groupId:e}=Nr(Fn),{role:i}=Nr(As),n=At(Qe,"groups",e);try{await Do(Qe,async s=>{if(!(await s.get(n)).exists())throw"Document does not exist!";const o={debrief:{}};if(i==="decider1")o.debrief.D1=t;else if(i==="decider2")o.debrief.D2=t;else if(i==="receiver")o.debrief.R=t;else throw`${i} is an unknown role`;await s.update(n,o),console.log("Successfully saved debrief data")})}catch(s){console.error("Error saving debrief data",s)}};function LS(t){let e;return{c(){e=Oe("add text here")},m(i,n){q(i,e,n)},d(i){i&&j(e)}}}function NS(t){let e,i,n,s,r;const o=t[5].default,a=zi(o,t,t[4],null),l=a||LS();return{c(){e=_("button"),l&&l.c(),C(e,"class",i="px-4 py-2 font-bold text-white rounded focus:outline-none hover:cursor-pointer "+t[1]+" "+t[2]),C(e,"type",t[0])},m(u,c){q(u,e,c),l&&l.m(e,null),n=!0,s||(r=B(e,"click",t[6]),s=!0)},p(u,[c]){a&&a.p&&(!n||c&16)&&qi(a,o,u,u[4],n?ji(o,u[4],c,null):Wi(u[4]),null),(!n||c&6&&i!==(i="px-4 py-2 font-bold text-white rounded focus:outline-none hover:cursor-pointer "+u[1]+" "+u[2]))&&C(e,"class",i),(!n||c&1)&&C(e,"type",u[0])},i(u){n||(W(l,u),n=!0)},o(u){Z(l,u),n=!1},d(u){u&&j(e),l&&l.d(u),s=!1,r()}}}function OS(t,e,i){let{$$slots:n={},$$scope:s}=e,{color:r="purple"}=e,o,a;r==="purple"?(o="bg-violet-500",a="hover:bg-violet-700"):r==="blue"&&(o="bg-blue-500",a="hover:bg-blue-700");let{type:l="button"}=e;function u(c){Z0.call(this,t,c)}return t.$$set=c=>{"color"in c&&i(3,r=c.color),"type"in c&&i(0,l=c.type),"$$scope"in c&&i(4,s=c.$$scope)},[l,o,a,r,s,n,u]}class Ll extends ot{constructor(e){super(),rt(this,e,OS,NS,Je,{color:3,type:0})}}function im(t,e,i){const n=t.slice();return n[10]=e[i],n}function nm(t){let e,i=t[10]+"",n,s;return{c(){e=_("option"),n=Oe(i),e.__value=s=t[10],e.value=e.__value},m(r,o){q(r,e,o),b(e,n)},p:Ee,d(r){r&&j(e)}}}function VS(t){let e;return{c(){e=Oe("Login")},m(i,n){q(i,e,n)},d(i){i&&j(e)}}}function sm(t){let e,i,n,s,r;return{c(){e=_("div"),i=_("div"),n=_("p"),s=Oe("Error: "),r=Oe(t[2]),C(n,"class","text-red-500"),C(i,"class","px-8 pt-6 pb-8 mb-4 bg-white rounded shadow-md"),C(e,"class","w-full max-w-md mb-6")},m(o,a){q(o,e,a),b(e,i),b(i,n),b(n,s),b(n,r)},p(o,a){a&4&&Ni(r,o[2])},d(o){o&&j(e)}}}function FS(t){let e,i,n,s,r,o,a,l,u,c,h,d,f,p,T,v,S,O,I,V,G,P,ue,oe,D,ve,Te,x,he,ge,Fe,ze,De,$e,lt,Xe,Ze,Me,Le,ae,et,de,Q,se=Zf,re=[];for(let U=0;U<se.length;U+=1)re[U]=nm(im(t,se,U));Me=new Ll({props:{type:"submit",color:"blue",$$slots:{default:[VS]},$$scope:{ctx:t}}});let F=t[2]&&sm(t);return{c(){e=_("div"),i=_("form"),n=_("div"),s=_("label"),s.textContent="Group",r=$(),o=_("select"),a=_("option"),a.textContent="Select your group",l=_("option"),l.textContent="BBB",u=_("option"),u.textContent="DVBrainiac",c=_("option"),c.textContent="DEV",h=_("option"),h.textContent="EFD",d=_("option"),d.textContent="Freud's Favorites",f=_("option"),f.textContent="Pavlov's Dawgs",p=_("option"),p.textContent="Psychiatric Trio",T=_("option"),T.textContent="Team Luke",v=_("option"),v.textContent="The Psychedelics",S=_("option"),S.textContent="The Unreasonable Ocho",O=$(),I=_("div"),V=_("label"),V.textContent="NetID",G=$(),P=_("select"),ue=_("option"),ue.textContent="Select your NetID";for(let U=0;U<re.length;U+=1)re[U].c();oe=$(),D=_("div"),ve=_("label"),ve.textContent="Episode",Te=$(),x=_("select"),he=_("option"),he.textContent="Select episode",ge=_("option"),ge.textContent="1",Fe=_("option"),Fe.textContent="2",ze=_("option"),ze.textContent="3",De=_("option"),De.textContent="4",$e=_("option"),$e.textContent="5",lt=_("option"),lt.textContent="6",Xe=$(),Ze=_("div"),Re(Me.$$.fragment),Le=$(),F&&F.c(),ae=Ga(),C(s,"for","groupId"),C(s,"class","mb-2 text-sm font-bold text-gray-700"),a.__value="",a.value=a.__value,l.__value="BBB",l.value=l.__value,u.__value="DVBrainiac",u.value=u.__value,c.__value="DEV",c.value=c.__value,h.__value="EFD",h.value=h.__value,d.__value="Freud's Favorites",d.value=d.__value,f.__value="Pavlov's Dawgs",f.value=f.__value,p.__value="Psychiatric Trio",p.value=p.__value,T.__value="Team Luke",T.value=T.__value,v.__value="The Psychedelics",v.value=v.__value,S.__value="The Unreasonable Ocho",S.value=S.__value,C(o,"id","groupId"),C(o,"name","groupId"),C(o,"class","w-full px-3 py-2 leading-tight border rounded shadow focus:outline-none focus:shadow-outline"),t[0]===void 0&&ei(()=>t[5].call(o)),C(n,"class","mb-4"),C(V,"for","netId"),C(V,"class","mb-2 text-sm font-bold text-gray-700"),ue.__value="",ue.value=ue.__value,C(P,"id","netId"),C(P,"name","netId"),C(P,"class","w-full px-3 py-2 leading-tight border rounded shadow focus:outline-none focus:shadow-outline"),t[3]===void 0&&ei(()=>t[6].call(P)),C(I,"class","mb-4"),C(ve,"for","epNum"),C(ve,"class","mb-2 text-sm font-bold text-gray-700"),he.__value="",he.value=he.__value,ge.__value="1",ge.value=ge.__value,Fe.__value="2",Fe.value=Fe.__value,ze.__value="3",ze.value=ze.__value,De.__value="4",De.value=De.__value,$e.__value="5",$e.value=$e.__value,lt.__value="6",lt.value=lt.__value,C(x,"id","epNum"),C(x,"name","epNum"),C(x,"class","w-full px-3 py-2 leading-tight border rounded shadow focus:outline-none focus:shadow-outline"),t[1]===void 0&&ei(()=>t[7].call(x)),C(D,"class","mb-4"),C(Ze,"class","text-center"),C(i,"class","px-8 pt-6 pb-8 mb-4 bg-white rounded shadow-md"),C(e,"class","w-full max-w-md mb-6")},m(U,_e){q(U,e,_e),b(e,i),b(i,n),b(n,s),b(n,r),b(n,o),b(o,a),b(o,l),b(o,u),b(o,c),b(o,h),b(o,d),b(o,f),b(o,p),b(o,T),b(o,v),b(o,S),Kn(o,t[0],!0),b(i,O),b(i,I),b(I,V),b(I,G),b(I,P),b(P,ue);for(let ct=0;ct<re.length;ct+=1)re[ct]&&re[ct].m(P,null);Kn(P,t[3],!0),b(i,oe),b(i,D),b(D,ve),b(D,Te),b(D,x),b(x,he),b(x,ge),b(x,Fe),b(x,ze),b(x,De),b(x,$e),b(x,lt),Kn(x,t[1],!0),b(i,Xe),b(i,Ze),Ae(Me,Ze,null),q(U,Le,_e),F&&F.m(U,_e),q(U,ae,_e),et=!0,de||(Q=[B(o,"change",t[5]),B(P,"change",t[6]),B(x,"change",t[7]),B(i,"submit",Mu(t[4]))],de=!0)},p(U,[_e]){if(_e&1&&Kn(o,U[0]),_e&0){se=Zf;let Ne;for(Ne=0;Ne<se.length;Ne+=1){const ai=im(U,se,Ne);re[Ne]?re[Ne].p(ai,_e):(re[Ne]=nm(ai),re[Ne].c(),re[Ne].m(P,null))}for(;Ne<re.length;Ne+=1)re[Ne].d(1);re.length=se.length}_e&8&&Kn(P,U[3]),_e&2&&Kn(x,U[1]);const ct={};_e&8192&&(ct.$$scope={dirty:_e,ctx:U}),Me.$set(ct),U[2]?F?F.p(U,_e):(F=sm(U),F.c(),F.m(ae.parentNode,ae)):F&&(F.d(1),F=null)},i(U){et||(W(Me.$$.fragment,U),et=!0)},o(U){Z(Me.$$.fragment,U),et=!1},d(U){U&&j(e),Or(re,U),Pe(Me),U&&j(Le),F&&F.d(U),U&&j(ae),de=!1,ki(Q)}}}const Tc="cosanlab";function US(t,e,i){let n,s;St(t,is,f=>i(3,n=f)),St(t,wi,f=>i(8,s=f));let r,o,a;const l=jt(),u=async()=>{console.log("Login -- login -- netId",n);const f=Ku();let p=n,T=`${r}_${o}_${p}`,v=`${r}_${o}_${p}@experiment.com`;console.log("Login -- fullId",T),console.log("Login -- email",v),ls(wi,s=T,s),localStorage.setItem("userId",s);try{await Fd(f,v,Tc),await em(r,n,o)}catch(S){console.log(S),i(2,a=S.message),S.message==`netId ${is} not a member of ${r}`?(i(2,a=`netId ${is} not a member of ${r}`),console.log(S)):S.code==="auth/user-not-found"?(console.log("no participant found...creating new account"),await Tk(f,v,Tc),await Fd(f,v,Tc),await em(r,n,o)):(console.log("other error"),console.log("$netId",n),console.log("netId",is),console.log("email",v),i(2,a=S.message),console.error(S))}l("finished")};function c(){r=Xl(this),i(0,r)}function h(){n=Xl(this),is.set(n)}function d(){o=Xl(this),i(1,o)}return[r,o,a,n,u,c,h,d]}class HS extends ot{constructor(e){super(),rt(this,e,US,FS,Je,{})}}function BS(t){let e,i,n,s,r,o;return{c(){e=_("div"),i=_("div"),n=$(),s=_("div"),r=_("h1"),o=Oe(t[0]),C(i,"class","w-32 h-32 row-start-3 border-4 border-gray-400 border-solid rounded-full animate-spin border-t-transparent"),C(r,"class","text-4xl"),C(s,"class","row-start-4 text-center"),C(e,"class","grid h-screen grid-rows-6 place-items-center")},m(a,l){q(a,e,l),b(e,i),b(e,n),b(e,s),b(s,r),b(r,o)},p(a,[l]){l&1&&Ni(o,a[0])},i:Ee,o:Ee,d(a){a&&j(e)}}}function $S(t,e,i){let{text:n="Loading..."}=e;return t.$$set=s=>{"text"in s&&i(0,n=s.text)},[n]}class Cy extends ot{constructor(e){super(),rt(this,e,$S,BS,Je,{text:0})}}function zS(t){let e,i,n,s,r,o,a,l,u,c,h,d,f,p,T,v,S,O,I;return v=new Ll({props:{$$slots:{default:[qS]},$$scope:{ctx:t}}}),v.$on("click",t[2]),{c(){e=_("div"),i=_("h1"),i.textContent="Please enter fullscreen mode!",n=$(),s=_("h2"),r=Oe("Hi "),o=_("b"),a=Oe(t[1]),l=Oe("!"),u=$(),c=_("br"),h=$(),d=_("p"),d.innerHTML=`We kindly request you to click the button below to enter fullscreen mode
      in order to participate in this study. Please remain in fullscreen mode
      throughout the entire duration of the study.
      <br/><br/>
      If the button doesn&#39;t work, you can achieve fullscreen by resizing your window
      manually.
      <br/>
      Thank you for your cooperation.`,f=$(),p=_("br"),T=$(),Re(v.$$.fragment),S=$(),O=_("br"),C(i,"class","mb-4 text-3xl"),C(d,"class","w-3/4 mb-2 text-center"),C(e,"class","flex flex-col items-center justify-center h-screen")},m(V,G){q(V,e,G),b(e,i),b(e,n),b(e,s),b(s,r),b(s,o),b(o,a),b(s,l),b(e,u),b(e,c),b(e,h),b(e,d),b(e,f),b(e,p),b(e,T),Ae(v,e,null),b(e,S),b(e,O),I=!0},p(V,G){(!I||G&2)&&Ni(a,V[1]);const P={};G&16&&(P.$$scope={dirty:G,ctx:V}),v.$set(P)},i(V){I||(W(v.$$.fragment,V),I=!0)},o(V){Z(v.$$.fragment,V),I=!1},d(V){V&&j(e),Pe(v)}}}function jS(t){let e,i;return e=new Cy({props:{text:"Please wait for at least 2 other group members to login..."}}),{c(){Re(e.$$.fragment)},m(n,s){Ae(e,n,s),i=!0},p:Ee,i(n){i||(W(e.$$.fragment,n),i=!0)},o(n){Z(e.$$.fragment,n),i=!1},d(n){Pe(e,n)}}}function qS(t){let e;return{c(){e=Oe("Enter Fullscreen Mode")},m(i,n){q(i,e,n)},d(i){i&&j(e)}}}function WS(t){let e,i,n,s;const r=[jS,zS],o=[];function a(l,u){return l[0]?0:1}return e=a(t),i=o[e]=r[e](t),{c(){i.c(),n=Ga()},m(l,u){o[e].m(l,u),q(l,n,u),s=!0},p(l,[u]){let c=e;e=a(l),e===c?o[e].p(l,u):(An(),Z(o[c],1,1,()=>{o[c]=null}),Pn(),i=o[e],i?i.p(l,u):(i=o[e]=r[e](l),i.c()),W(i,1),i.m(n.parentNode,n))},i(l){s||(W(i),s=!0)},o(l){Z(i),s=!1},d(l){o[e].d(l),l&&j(n)}}}function KS(t,e,i){let n;St(t,wi,a=>i(1,n=a));const s=jt();let r=!1;return[r,n,async()=>{await document.documentElement.requestFullscreen(),i(0,r=!0),s("finished")}]}class GS extends ot{constructor(e){super(),rt(this,e,KS,WS,Je,{})}}function QS(t){const e=t-1;return e*e*e+1}function rm(t){return Object.prototype.toString.call(t)==="[object Date]"}function yu(t,e){if(t===e||t!==t)return()=>t;const i=typeof t;if(i!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const n=e.map((s,r)=>yu(t[r],s));return s=>n.map(r=>r(s))}if(i==="object"){if(!t||!e)throw new Error("Object cannot be null");if(rm(t)&&rm(e)){t=t.getTime(),e=e.getTime();const r=e-t;return o=>new Date(t+o*r)}const n=Object.keys(e),s={};return n.forEach(r=>{s[r]=yu(t[r],e[r])}),r=>{const o={};return n.forEach(a=>{o[a]=s[a](r)}),o}}if(i==="number"){const n=e-t;return s=>t+s*n}throw new Error(`Cannot interpolate ${i} values`)}function _c(t,e={}){const i=Hs(t);let n,s=t;function r(o,a){if(t==null)return i.set(t=o),Promise.resolve();s=o;let l=n,u=!1,{delay:c=0,duration:h=400,easing:d=Ru,interpolate:f=yu}=Fc(Fc({},e),a);if(h===0)return l&&(l.abort(),l=null),i.set(t=s),Promise.resolve();const p=ip()+c;let T;return n=sp(v=>{if(v<p)return!0;u||(T=f(t,o),typeof h=="function"&&(h=h(t,o)),u=!0),l&&(l.abort(),l=null);const S=v-p;return S>h?(i.set(t=o),!1):(i.set(t=T(d(S/h))),!0)}),n.promise}return{set:r,update:(o,a)=>r(o(s,t),a),subscribe:i.subscribe}}function om(t,e,i){const n=t.slice();return n[10]=e[i],n[12]=i,n}function am(t){let e,i,n=t[10]+"",s,r;return{c(){e=_("li"),i=_("span"),s=Oe(n),r=$(),C(e,"class","num svelte-mf1wya"),yd(e,"transform","translateY(-"+t[0]+"px)")},m(o,a){q(o,e,a),b(e,i),b(i,s),b(e,r)},p(o,a){a&1&&yd(e,"transform","translateY(-"+o[0]+"px)")},d(o){o&&j(e)}}}function YS(t){let e,i=t[1],n=[];for(let s=0;s<i.length;s+=1)n[s]=am(om(t,i,s));return{c(){e=_("ul");for(let s=0;s<n.length;s+=1)n[s].c();C(e,"class","svelte-mf1wya")},m(s,r){q(s,e,r);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(s,[r]){if(r&3){i=s[1];let o;for(o=0;o<i.length;o+=1){const a=om(s,i,o);n[o]?n[o].p(a,r):(n[o]=am(a),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=i.length}},i:Ee,o:Ee,d(s){s&&j(e),Or(n,s)}}}function JS(t,e,i){let n,s,{countdown:r=0}=e;const o=jt();let a=null;const l=[0,1,2,3,4,5,6,7,8,9].reverse();let u=_c((9-Math.floor(r%60/10))*128,{duration:300}),c=_c((9-Math.floor(r%60%10))*128,{duration:300});return St(t,c,h=>i(0,s=h)),_c(0,{duration:500}),Gt(()=>{i(4,a=setInterval(()=>{i(3,r-=1)},1e3))}),J0(()=>{u.set((9-Math.floor(n/10))*128),c.set((9-Math.floor(n%10))*128)}),X0(()=>{a&&clearInterval(a)}),t.$$set=h=>{"countdown"in h&&i(3,r=h.countdown)},t.$$.update=()=>{t.$$.dirty&8,t.$$.dirty&8&&(n=r%60),t.$$.dirty&24&&r===0&&(clearInterval(a),i(4,a=null),o("completed"))},[s,l,c,r,a]}class XS extends ot{constructor(e){super(),rt(this,e,JS,YS,Je,{countdown:3})}}function ZS(t){let e,i,n,s,r,o;return r=new XS({props:{countdown:5}}),r.$on("completed",t[1]),{c(){e=_("div"),i=_("div"),n=_("h1"),n.textContent="You will begin the experiment in",s=$(),Re(r.$$.fragment),C(i,"class","inner svelte-1lus0wr"),C(e,"class","container svelte-1lus0wr")},m(a,l){q(a,e,l),b(e,i),b(i,n),b(i,s),Ae(r,i,null),o=!0},p:Ee,i(a){o||(W(r.$$.fragment,a),o=!0)},o(a){Z(r.$$.fragment,a),o=!1},d(a){a&&j(e),Pe(r)}}}function eI(t){const e=jt();return[e,()=>e("finished")]}class tI extends ot{constructor(e){super(),rt(this,e,eI,ZS,Je,{})}}function Ps(t,{delay:e=0,duration:i=400,easing:n=Ru}={}){const s=+getComputedStyle(t).opacity;return{delay:e,duration:i,easing:n,css:r=>`opacity: ${r*s}`}}function lm(t,{delay:e=0,duration:i=400,easing:n=QS,x:s=0,y:r=0,opacity:o=0}={}){const a=getComputedStyle(t),l=+a.opacity,u=a.transform==="none"?"":a.transform,c=l*(1-o),[h,d]=gd(s),[f,p]=gd(r);return{delay:e,duration:i,easing:n,css:(T,v)=>`
			transform: ${u} translate(${(1-T)*h}${d}, ${(1-T)*f}${p});
			opacity: ${l-c*v}`}}const w=(t,e)=>{typeof window!="undefined"&&!customElements.get(t)&&customElements.define(t,e)},Ai=(t,e,i)=>{t&&(t[e]=i)},Ce={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,safari10:!1,scriptDataOpts:!1,shadowDomShim:!1,slotChildNodesFix:!1,propBoolean:!0,propNumber:!0,propString:!0,cssVarShim:!1,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,dynamicImportShim:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0};let ns,Ey,Nl,Sy=!1,Ua=!1,rd=!1,Vt=!1,bu=null,wu=!1;const Mo=typeof window!="undefined"?window:{};Ce.cssVarShim&&Mo.CSS;const ti=Mo.document||{head:{}};Mo.HTMLElement||class{};const Pt={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,i,n)=>t.addEventListener(e,i,n),rel:(t,e,i,n)=>t.removeEventListener(e,i,n),ce:(t,e)=>new CustomEvent(t,e)},Ol=Ce.shadowDomShim&&Ce.shadowDom?(()=>(ti.head.attachShadow+"").indexOf("[native")>-1)():!0,iI=(()=>{let t=!1;try{ti.addEventListener("e",null,Object.defineProperty({},"passive",{get(){t=!0}}))}catch{}return t})(),nI=t=>Promise.resolve(t),sI=Ce.constructableCSS?(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replace=="function"}catch{}return!1})():!1,Iy=(t,e,i,n)=>{i&&i.map(([s,r,o])=>{const a=oI(t,s),l=rI(e,o),u=aI(s);Pt.ael(a,r,l,u),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>Pt.rel(a,r,l,u))})},rI=(t,e)=>i=>{try{Ce.lazyLoad||t.$hostElement$[e](i)}catch(n){No(n)}},oI=(t,e)=>e&4?ti:e&8?Mo:e&16?ti.body:t,aI=t=>iI?{passive:(t&1)!==0,capture:(t&2)!==0}:(t&2)!==0,cm="http://www.w3.org/1999/xlink",Un=(t,e="")=>()=>{},um=new WeakMap,lI=(t,e,i)=>{let n=$a.get(t);sI&&i?(n=n||new CSSStyleSheet,n.replace(e)):n=e,$a.set(t,n)},cI=(t,e,i,n)=>{let s=Ay(e,i),r=$a.get(s);if(t=t.nodeType===11?t:ti,r)if(typeof r=="string"){t=t.head||t;let o=um.get(t),a;o||um.set(t,o=new Set),o.has(s)||(a=ti.createElement("style"),a.innerHTML=r,t.insertBefore(a,t.querySelector("link")),o&&o.add(s))}else t.adoptedStyleSheets.includes(r)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,r]);return s},uI=t=>{const e=t.$cmpMeta$,i=t.$hostElement$,n=e.$flags$,s=Un("attachStyles",e.$tagName$),r=cI(Ol&&i.shadowRoot?i.shadowRoot:i.getRootNode(),e,t.$modeName$);n&10&&(i["s-sc"]=r,i.classList.add(r+"-h"),n&2&&i.classList.add(r+"-s")),s()},Ay=(t,e)=>"sc-"+(e&&t.$flags$&32?t.$tagName$+"-"+e:t.$tagName$),hI=t=>HI.map(e=>e(t)).find(e=>!!e),hm={},dI="http://www.w3.org/2000/svg",fI="http://www.w3.org/1999/xhtml",mI=t=>t!=null,od=t=>(t=typeof t,t==="object"||t==="function"),g=(t,e,...i)=>{let n=null,s=null,r=null,o=!1,a=!1,l=[];const u=h=>{for(let d=0;d<h.length;d++)n=h[d],Array.isArray(n)?u(n):n!=null&&typeof n!="boolean"&&((o=typeof t!="function"&&!od(n))&&(n=String(n)),o&&a?l[l.length-1].$text$+=n:l.push(o?Ha(null,n):n),a=o)};if(u(i),e){e.key&&(s=e.key),e.name&&(r=e.name);{const h=e.className||e.class;h&&(e.class=typeof h!="object"?h:Object.keys(h).filter(d=>h[d]).join(" "))}}if(typeof t=="function")return t(e===null?{}:e,l,gI);const c=Ha(t,null);return c.$attrs$=e,l.length>0&&(c.$children$=l),c.$key$=s,c.$name$=r,c},Ha=(t,e)=>{const i={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return i.$attrs$=null,i.$key$=null,i.$name$=null,i},Bs={},pI=t=>t&&t.$tag$===Bs,gI={forEach:(t,e)=>t.map(dm).forEach(e),map:(t,e)=>t.map(dm).map(e).map(vI)},dm=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),vI=t=>{if(typeof t.vtag=="function"){const i=Object.assign({},t.vattrs);return t.vkey&&(i.key=t.vkey),t.vname&&(i.name=t.vname),g(t.vtag,i,...t.vchildren||[])}const e=Ha(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},fm=(t,e,i,n,s,r)=>{if(i!==n){let o=ym(t,e),a=e.toLowerCase();if(e==="class"){const l=t.classList,u=mm(i),c=mm(n);l.remove(...u.filter(h=>h&&!c.includes(h))),l.add(...c.filter(h=>h&&!u.includes(h)))}else if(e==="style"){for(const l in i)(!n||n[l]==null)&&(l.includes("-")?t.style.removeProperty(l):t.style[l]="");for(const l in n)(!i||n[l]!==i[l])&&(l.includes("-")?t.style.setProperty(l,n[l]):t.style[l]=n[l])}else if(e!=="key")if(e==="ref")n&&n(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n")e[2]==="-"?e=e.slice(3):ym(Mo,a)?e=a.slice(2):e=a[2]+e.slice(3),i&&Pt.rel(t,e,i,!1),n&&Pt.ael(t,e,n,!1);else{const l=od(n);if((o||l&&n!==null)&&!s)try{if(t.tagName.includes("-"))t[e]=n;else{let c=n==null?"":n;e==="list"?o=!1:(i==null||t[e]!=c)&&(t[e]=c)}}catch{}let u=!1;a!==(a=a.replace(/^xlink\:?/,""))&&(e=a,u=!0),n==null||n===!1?(n!==!1||t.getAttribute(e)==="")&&(u?t.removeAttributeNS(cm,e):t.removeAttribute(e)):(!o||r&4||s)&&!l&&(n=n===!0?"":n,u?t.setAttributeNS(cm,e,n):t.setAttribute(e,n))}}},yI=/\s/,mm=t=>t?t.split(yI):[],Py=(t,e,i,n)=>{const s=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,r=t&&t.$attrs$||hm,o=e.$attrs$||hm;for(n in r)n in o||fm(s,n,r[n],void 0,i,e.$flags$);for(n in o)fm(s,n,r[n],o[n],i,e.$flags$)},Ba=(t,e,i,n)=>{let s=e.$children$[i],r=0,o,a,l;if(Sy||(rd=!0,s.$tag$==="slot"&&(ns&&n.classList.add(ns+"-s"),s.$flags$|=s.$children$?2:1)),s.$text$!==null)o=s.$elm$=ti.createTextNode(s.$text$);else if(s.$flags$&1)o=s.$elm$=ti.createTextNode("");else{if(Vt||(Vt=s.$tag$==="svg"),o=s.$elm$=ti.createElementNS(Vt?dI:fI,s.$flags$&2?"slot-fb":s.$tag$),Vt&&s.$tag$==="foreignObject"&&(Vt=!1),Py(null,s,Vt),mI(ns)&&o["s-si"]!==ns&&o.classList.add(o["s-si"]=ns),s.$children$)for(r=0;r<s.$children$.length;++r)a=Ba(t,s,r,o),a&&o.appendChild(a);s.$tag$==="svg"?Vt=!1:o.tagName==="foreignObject"&&(Vt=!0)}return o["s-hn"]=Nl,s.$flags$&3&&(o["s-sr"]=!0,o["s-cr"]=Ey,o["s-sn"]=s.$name$||"",l=t&&t.$children$&&t.$children$[i],l&&l.$tag$===s.$tag$&&t.$elm$&&so(t.$elm$,!1)),o},so=(t,e)=>{Pt.$flags$|=1;const i=t.childNodes;for(let n=i.length-1;n>=0;n--){const s=i[n];s["s-hn"]!==Nl&&s["s-ol"]&&(Dy(s).insertBefore(s,ad(s)),s["s-ol"].remove(),s["s-ol"]=void 0,rd=!0),e&&so(s,e)}Pt.$flags$&=-2},Ry=(t,e,i,n,s,r)=>{let o=t["s-cr"]&&t["s-cr"].parentNode||t,a;for(o.shadowRoot&&o.tagName===Nl&&(o=o.shadowRoot);s<=r;++s)n[s]&&(a=Ba(null,i,s,t),a&&(n[s].$elm$=a,o.insertBefore(a,ad(e))))},xy=(t,e,i,n,s)=>{for(;e<=i;++e)(n=t[e])&&(s=n.$elm$,Ny(n),Ua=!0,s["s-ol"]?s["s-ol"].remove():so(s,!0),s.remove())},bI=(t,e,i,n)=>{let s=0,r=0,o=0,a=0,l=e.length-1,u=e[0],c=e[l],h=n.length-1,d=n[0],f=n[h],p,T;for(;s<=l&&r<=h;)if(u==null)u=e[++s];else if(c==null)c=e[--l];else if(d==null)d=n[++r];else if(f==null)f=n[--h];else if(Yo(u,d))ss(u,d),u=e[++s],d=n[++r];else if(Yo(c,f))ss(c,f),c=e[--l],f=n[--h];else if(Yo(u,f))(u.$tag$==="slot"||f.$tag$==="slot")&&so(u.$elm$.parentNode,!1),ss(u,f),t.insertBefore(u.$elm$,c.$elm$.nextSibling),u=e[++s],f=n[--h];else if(Yo(c,d))(u.$tag$==="slot"||f.$tag$==="slot")&&so(c.$elm$.parentNode,!1),ss(c,d),t.insertBefore(c.$elm$,u.$elm$),c=e[--l],d=n[++r];else{for(o=-1,a=s;a<=l;++a)if(e[a]&&e[a].$key$!==null&&e[a].$key$===d.$key$){o=a;break}o>=0?(T=e[o],T.$tag$!==d.$tag$?p=Ba(e&&e[r],i,o,t):(ss(T,d),e[o]=void 0,p=T.$elm$),d=n[++r]):(p=Ba(e&&e[r],i,r,t),d=n[++r]),p&&Dy(u.$elm$).insertBefore(p,ad(u.$elm$))}s>l?Ry(t,n[h+1]==null?null:n[h+1].$elm$,i,n,r,h):r>h&&xy(e,s,l)},Yo=(t,e)=>t.$tag$===e.$tag$?t.$tag$==="slot"?t.$name$===e.$name$:t.$key$===e.$key$:!1,ad=t=>t&&t["s-ol"]||t,Dy=t=>(t["s-ol"]?t["s-ol"]:t).parentNode,ss=(t,e)=>{const i=e.$elm$=t.$elm$,n=t.$children$,s=e.$children$,r=e.$tag$,o=e.$text$;let a;o===null?(Vt=r==="svg"?!0:r==="foreignObject"?!1:Vt,r==="slot"||Py(t,e,Vt),n!==null&&s!==null?bI(i,n,e,s):s!==null?(t.$text$!==null&&(i.textContent=""),Ry(i,null,e,s,0,s.length-1)):n!==null&&xy(n,0,n.length-1),Vt&&r==="svg"&&(Vt=!1)):(a=i["s-cr"])?a.parentNode.textContent=o:t.$text$!==o&&(i.data=o)},My=t=>{let e=t.childNodes,i,n,s,r,o,a;for(n=0,s=e.length;n<s;n++)if(i=e[n],i.nodeType===1){if(i["s-sr"]){for(o=i["s-sn"],i.hidden=!1,r=0;r<s;r++)if(a=e[r].nodeType,e[r]["s-hn"]!==i["s-hn"]||o!==""){if(a===1&&o===e[r].getAttribute("slot")){i.hidden=!0;break}}else if(a===1||a===3&&e[r].textContent.trim()!==""){i.hidden=!0;break}}My(i)}},Xt=[],Ly=t=>{let e,i,n,s,r,o,a=0,l=t.childNodes,u=l.length;for(;a<u;a++){if(e=l[a],e["s-sr"]&&(i=e["s-cr"])&&i.parentNode)for(n=i.parentNode.childNodes,s=e["s-sn"],o=n.length-1;o>=0;o--)i=n[o],!i["s-cn"]&&!i["s-nr"]&&i["s-hn"]!==e["s-hn"]&&(pm(i,s)?(r=Xt.find(c=>c.$nodeToRelocate$===i),Ua=!0,i["s-sn"]=i["s-sn"]||s,r?r.$slotRefNode$=e:Xt.push({$slotRefNode$:e,$nodeToRelocate$:i}),i["s-sr"]&&Xt.map(c=>{pm(c.$nodeToRelocate$,i["s-sn"])&&(r=Xt.find(h=>h.$nodeToRelocate$===i),r&&!c.$slotRefNode$&&(c.$slotRefNode$=r.$slotRefNode$))})):Xt.some(c=>c.$nodeToRelocate$===i)||Xt.push({$nodeToRelocate$:i}));e.nodeType===1&&Ly(e)}},pm=(t,e)=>t.nodeType===1?t.getAttribute("slot")===null&&e===""||t.getAttribute("slot")===e:t["s-sn"]===e?!0:e==="",Ny=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(Ny)},wI=(t,e)=>{const i=t.$hostElement$,n=t.$cmpMeta$,s=t.$vnode$||Ha(null,null),r=pI(e)?e:g(null,null,e);Nl=i.tagName,n.$attrsToReflect$&&(r.$attrs$=r.$attrs$||{},n.$attrsToReflect$.map(([o,a])=>r.$attrs$[a]=i[o])),r.$tag$=null,r.$flags$|=4,t.$vnode$=r,r.$elm$=s.$elm$=i.shadowRoot||i,ns=i["s-sc"],Ey=i["s-cr"],Sy=Ol&&(n.$flags$&1)!==0,Ua=!1,ss(s,r);{if(Pt.$flags$|=1,rd){Ly(r.$elm$);let o,a,l,u,c,h,d=0;for(;d<Xt.length;d++)o=Xt[d],a=o.$nodeToRelocate$,a["s-ol"]||(l=ti.createTextNode(""),l["s-nr"]=a,a.parentNode.insertBefore(a["s-ol"]=l,a));for(d=0;d<Xt.length;d++)if(o=Xt[d],a=o.$nodeToRelocate$,o.$slotRefNode$){for(u=o.$slotRefNode$.parentNode,c=o.$slotRefNode$.nextSibling,l=a["s-ol"];l=l.previousSibling;)if(h=l["s-nr"],h&&h["s-sn"]===a["s-sn"]&&u===h.parentNode&&(h=h.nextSibling,!h||!h["s-nr"])){c=h;break}(!c&&u!==a.parentNode||a.nextSibling!==c)&&a!==c&&(!a["s-hn"]&&a["s-ol"]&&(a["s-hn"]=a["s-ol"].parentNode.nodeName),u.insertBefore(a,c))}else a.nodeType===1&&(a.hidden=!0)}Ua&&My(r.$elm$),Pt.$flags$&=-2,Xt.length=0}},Ye=t=>Ce.lazyLoad?Lo(t).$hostElement$:t,R=(t,e,i)=>{const n=Ye(t);return{emit:s=>(Ce.isDev&&!n.isConnected&&UI(`The "${e}" event was emitted, but the dispatcher node is no longer connected to the dom.`),kI(n,e,{bubbles:!!(i&4),composed:!!(i&2),cancelable:!!(i&1),detail:s}))}},kI=(t,e,i)=>{const n=Pt.ce(e,i);return t.dispatchEvent(n),n},TI=(t,e)=>{},Oy=(t,e)=>(t.$flags$|=16,TI(t,t.$ancestorComponent$),Ht(()=>_I(t,e))),_I=(t,e)=>{const i=t.$hostElement$,n=Un("scheduleUpdate",t.$cmpMeta$.$tagName$),s=i;let r;return e?r=ys(s,"componentWillLoad"):r=ys(s,"componentWillUpdate"),r=gm(r,()=>ys(s,"componentWillRender")),n(),gm(r,()=>CI(t,s,e))},CI=async(t,e,i)=>{const n=t.$hostElement$,s=Un("update",t.$cmpMeta$.$tagName$);n["s-rc"],i&&uI(t);const r=Un("render",t.$cmpMeta$.$tagName$);EI(t,e,n),r(),s(),II(t)},EI=(t,e,i)=>{try{bu=e,e=e.render&&e.render(),t.$flags$&=-17,t.$flags$|=2,(Ce.hasRenderFn||Ce.reflect)&&(Ce.vdomRender||Ce.reflect)&&(Ce.hydrateServerSide||wI(t,e))}catch(a){No(a,t.$hostElement$)}return bu=null,null},SI=()=>bu,II=t=>{const e=t.$cmpMeta$.$tagName$,i=t.$hostElement$,n=Un("postUpdate",e),s=i;t.$ancestorComponent$,ys(s,"componentDidRender"),t.$flags$&64?(ys(s,"componentDidUpdate"),n()):(t.$flags$|=64,ys(s,"componentDidLoad"),n())},ys=(t,e,i)=>{if(t&&t[e])try{return t[e](i)}catch(n){No(n)}},gm=(t,e)=>t&&t.then?t.then(e):e(),AI=(t,e)=>t!=null&&!od(t)?e&4?t==="false"?!1:t===""||!!t:e&2?parseFloat(t):e&1?String(t):t:t,PI=(t,e)=>Lo(t).$instanceValues$.get(e),RI=(t,e,i,n)=>{const s=Lo(t),r=t,o=s.$instanceValues$.get(e),a=s.$flags$,l=r;if(i=AI(i,n.$members$[e][0]),i!==o){s.$instanceValues$.set(e,i);{if(n.$watchers$&&a&128){const u=n.$watchers$[e];u&&u.map(c=>{try{l[c](i,o,e)}catch(h){No(h,r)}})}if((a&18)===2){if(l.componentShouldUpdate&&l.componentShouldUpdate(i,o,e)===!1)return;Oy(s,!1)}}}},xI=(t,e,i)=>{if(e.$members$){t.watchers&&(e.$watchers$=t.watchers);const n=Object.entries(e.$members$),s=t.prototype;n.map(([r,[o]])=>{(o&31||o&32)&&Object.defineProperty(s,r,{get(){return PI(this,r)},set(a){RI(this,r,a,e)},configurable:!0,enumerable:!0})});{const r=new Map;s.attributeChangedCallback=function(o,a,l){Pt.jmp(()=>{const u=r.get(o);this[u]=l===null&&typeof this[u]=="boolean"?!1:l})},t.observedAttributes=n.filter(([o,a])=>a[0]&15).map(([o,a])=>{const l=a[1]||o;return r.set(l,o),a[0]&512&&e.$attrsToReflect$.push([o,l]),l})}}return t},DI=async(t,e,i,n,s)=>{if((e.$flags$&32)===0&&(s=t.constructor,e.$flags$|=160,s.style)){let o=s.style;typeof o!="string"&&(o=o[e.$modeName$=hI(t)]);const a=Ay(i,e.$modeName$);if(!$a.has(a)){const l=Un("registerStyles",i.$tagName$);lI(a,o,!!(i.$flags$&1)),l()}}e.$ancestorComponent$,(()=>Oy(e,!0))()},MI=t=>{},LI=t=>{if((Pt.$flags$&1)===0){const e=Lo(t),i=e.$cmpMeta$,n=Un("connectedCallback",i.$tagName$);e.$flags$&1?(Iy(t,e,i.$listeners$),MI(e.$lazyInstance$)):(e.$flags$|=1,i.$flags$&12&&NI(t),DI(t,e,i)),n()}},NI=t=>{const e=t["s-cr"]=ti.createComment("");e["s-cn"]=!0,t.insertBefore(e,t.firstChild)},OI=t=>{if((Pt.$flags$&1)===0){const e=Lo(t);e.$rmListeners$&&(e.$rmListeners$.map(i=>i()),e.$rmListeners$=void 0)}},Y=(t,e)=>{const i={$flags$:e[0],$tagName$:e[1]};Ce.member&&(i.$members$=e[2]),Ce.hostListener&&(i.$listeners$=e[3]),Ce.watchCallback&&(i.$watchers$=t.$watchers$),Ce.reflect&&(i.$attrsToReflect$=[]),Ce.shadowDom&&!Ol&&i.$flags$&1&&(i.$flags$|=8);const n=t.prototype.connectedCallback,s=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__registerHost(){VI(this,i)},connectedCallback(){LI(this),Ce.connectedCallback&&n&&n.call(this)},disconnectedCallback(){OI(this),Ce.disconnectedCallback&&s&&s.call(this)}}),t.is=i.$tagName$,xI(t,i)},ie=t=>{Ol?t.attachShadow({mode:"open"}):t.shadowRoot=t},vm=(t,e)=>e,Vy=new WeakMap,Lo=t=>Vy.get(t),VI=(t,e)=>{const i={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map};return Ce.isDev&&(i.$renderCount$=0),Ce.method&&Ce.lazyLoad&&(i.$onInstancePromise$=new Promise(n=>i.$onInstanceResolve$=n)),Ce.asyncLoading&&(i.$onReadyPromise$=new Promise(n=>i.$onReadyResolve$=n),t["s-p"]=[],t["s-rc"]=[]),Iy(t,i,e.$listeners$),Vy.set(t,i)},ym=(t,e)=>e in t,No=(t,e)=>(0,console.error)(t,e),FI=Ce.isTesting?["STENCIL:"]:["%cstencil","color: white;background:#4c47ff;font-weight: bold; font-size:10px; padding:2px 6px; border-radius: 5px"],UI=(...t)=>console.warn(...FI,...t),$a=new Map,HI=[],bm=[],Fy=[],BI=(t,e)=>i=>{t.push(i),wu||(wu=!0,e&&Pt.$flags$&4?$I(ku):Pt.raf(ku))},wm=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(i){No(i)}t.length=0},ku=()=>{wm(bm),wm(Fy),(wu=bm.length>0)&&Pt.raf(ku)},$I=t=>nI().then(t),Ht=BI(Fy,!0);Ce.isDev,Ce.isTesting;function xe(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function zI(t,e,i,n=300,s=10){let r,o=0,a=!1;function l(){a||(r=setTimeout(()=>{if(o===s){i==null||i();return}t.dispatchEvent(e),o+=1,l()},n))}return l(),()=>{window.clearTimeout(r),a=!0}}const Cc=(t,e,i=0,n=0,s=0,r=0)=>{const o=t.getBoundingClientRect(),a=e.getBoundingClientRect();return o.left+i<a.right+s&&o.right+i>a.left+s&&o.top+n<a.bottom+r&&o.bottom+n>a.top+r},ri=(...t)=>{},Li=t=>t===null,N=t=>typeof t=="undefined",Mt=t=>Li(t)||N(t),Oo=t=>Mt(t)?void 0:t.constructor,Vl=t=>Oo(t)===Object,Pi=t=>Oo(t)===Number&&!Number.isNaN(t),_t=t=>Oo(t)===String,jI=t=>Oo(t)===Boolean,Tu=t=>Oo(t)===Function,za=t=>Array.isArray(t),Fl=(t,e)=>Boolean(t&&e&&t instanceof e),ja=()=>{let t=ri,e=ri;return{promise:new Promise((n,s)=>{t=n,e=s}),resolve:t,reject:e}};function bs(t,e,i){const n=t[e];t[e]=function(){return i(),n?n.call(t):void 0}}function Nt(t,e,i){let n=!1;N(e)||(bs(t,"componentWillLoad",()=>{e(),n=!0}),bs(t,"connectedCallback",()=>{n&&e()})),N(i)||bs(t,"disconnectedCallback",()=>{i()})}const Uy="vmFindPlayer";function qI(t){const e=Ye(t);let i;Nt(t,()=>{i=xe(e,Uy,n=>{n.stopPropagation(),n.detail(e)})},()=>{i==null||i()})}const $i=(t,e=300,i=10)=>{const n=Fl(t,HTMLElement)?t:Ye(t),s=ja();let r;const o=new CustomEvent(Uy,{bubbles:!0,composed:!0,detail:a=>{s.resolve(a),r()}});return r=zI(n,o,()=>{s.reject(`Could not find player for ${n.nodeName}`)},e,i),s.promise};var oi;(function(t){t.Audio="audio",t.Video="video"})(oi||(oi={}));const Hy="vmStateChange",Ki=t=>(e,i)=>{const n=Fl(t,HTMLElement)?t:Ye(t),s=new CustomEvent(Hy,{bubbles:!0,composed:!0,detail:{by:n,prop:e,value:i}});n.dispatchEvent(s)},Lr={play:"Play",pause:"Pause",playback:"Playback",scrubber:"Scrubber",scrubberLabel:"{currentTime} of {duration}",played:"Played",duration:"Duration",buffered:"Buffered",close:"Close",currentTime:"Current time",live:"LIVE",volume:"Volume",mute:"Mute",unmute:"Unmute",audio:"Audio",default:"Default",captions:"Captions",subtitlesOrCc:"Subtitles/CC",enableCaptions:"Enable subtitles/captions",disableCaptions:"Disable subtitles/captions",auto:"Auto",fullscreen:"Fullscreen",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",settings:"Settings",seekForward:"Seek forward",seekBackward:"Seek backward",seekTotal:"Seek total",normal:"Normal",none:"None",playbackRate:"Playback Rate",playbackQuality:"Playback Quality",loop:"Loop",disabled:"Disabled",off:"Off",enabled:"Enabled",pip:"Picture-in-Picture",enterPiP:"Miniplayer",exitPiP:"Expand"},ws={theme:void 0,paused:!0,playing:!1,duration:-1,currentProvider:void 0,mediaTitle:void 0,currentSrc:void 0,currentPoster:void 0,textTracks:[],currentTextTrack:-1,audioTracks:[],currentAudioTrack:-1,isTextTrackVisible:!0,shouldRenderNativeTextTracks:!0,icons:"vime",currentTime:0,autoplay:!1,ready:!1,playbackReady:!1,loop:!1,muted:!1,buffered:0,playbackRate:1,playbackRates:[1],playbackQuality:void 0,playbackQualities:[],seeking:!1,debug:!1,playbackStarted:!1,playbackEnded:!1,buffering:!1,controls:!1,isControlsActive:!1,volume:50,isFullscreenActive:!1,aspectRatio:"16:9",viewType:void 0,isAudioView:!1,isVideoView:!1,mediaType:void 0,isAudio:!1,isVideo:!1,isMobile:!1,isTouch:!1,isSettingsActive:!1,isLive:!1,isPiPActive:!1,autopause:!0,playsinline:!1,language:"en",languages:["en"],translations:{en:Lr},i18n:Lr},WI=new Set(["autoplay","autopause","aspectRatio","controls","theme","debug","paused","currentTime","language","loop","translations","playbackQuality","muted","playbackRate","playsinline","volume","isSettingsActive","isControlsActive","shouldRenderNativeTextTracks"]),By=t=>WI.has(t),KI=new Set(["paused","currentTime","duration","buffered","seeking","playing","buffering","playbackReady","textTracks","currentTextTrack","audioTracks","currentAudioTrack","mediaTitle","currentSrc","currentPoster","playbackRate","playbackRates","playbackStarted","playbackEnded","playbackQuality","playbackQualities","mediaType"]),GI=t=>KI.has(t);var zt;(function(t){t.Audio="audio",t.Video="video"})(zt||(zt={}));class st{constructor(e=[]){this.dispose=e}add(e){this.dispose.push(e)}empty(){this.dispose.forEach(e=>e()),this.dispose=[]}}var QI=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const _u=Symbol("vmPlayerKey"),Ul=Symbol("vmNameKey"),En=Symbol("vmRegistryKey"),Cu=Symbol("vmRegistrationKey"),$y="vmComponentRegister",zy="vmComponentRegistered",jy="vmComponentDeregistered",$s=t=>Fl(t,HTMLElement)?t:Ye(t);function X(t,e){const i=Symbol("vmRegistryId"),n=$s(t);n[Ul]=e!=null?e:n.nodeName.toLowerCase(),n[Cu]=i;const r=(o=>new CustomEvent(o,{bubbles:!0,composed:!0,detail:n}))($y);Nt(t,()=>{n.dispatchEvent(r)})}function YI(t){const e=Ye(t),i=new Map,n=new st;e[En]=i;function s(o){delete o[_u],delete o[En],i.delete(o[Cu]),e.dispatchEvent(new CustomEvent(jy,{detail:o}))}function r(o){const a=o.detail,l=$s(a);l[_u]=e,l[En]=i,i.set(l[Cu],l),e.dispatchEvent(new CustomEvent(zy,{detail:l})),Nt(a,void 0,()=>s(l))}Nt(t,()=>{n.add(xe(e,$y,r))},()=>{i.clear(),n.empty(),delete t[En]})}function JI(t,e){var i;const s=$s(t)[En];return Array.from((i=s==null?void 0:s.values())!==null&&i!==void 0?i:[]).some(r=>r[Ul]===e)}function fi(t){return $s(t)[_u]}function qy(t,e){var i,n;const s=$s(t);return Array.from((n=(i=s[En])===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[]).filter(r=>r[Ul]===e)}function Wy(t,e,i){var n;return QI(this,void 0,void 0,function*(){const s=yield $i(t),r=new st,o=$s(t)[En];function a(l){l.detail[Ul]===e&&(i==null||i(qy(s,e)))}return Array.from((n=o==null?void 0:o.values())!==null&&n!==void 0?n:[]).forEach(l=>a(new CustomEvent("",{detail:l}))),N(s)||(r.add(xe(s,zy,a)),r.add(xe(s,jy,a))),Nt(t,()=>{},()=>{r.empty()}),()=>{r.empty()}})}var XI=function(){var t,e=new Promise(function(i){t=i});return{promise:e,resolve:t}},ZI=function(t,e,i){i===void 0&&(i=!0);var n=t.constructor.name==="Function",s=n?t.prototype:t,r=s.componentWillLoad;s.componentWillLoad=function(){var o=this,a=Ye(this),l=XI(),u=new CustomEvent("openWormhole",{bubbles:!0,composed:!0,detail:{consumer:this,fields:e,updater:function(h,d){var f=h in a?a:o;f[h]=d},onOpen:l}});a.dispatchEvent(u);var c=function(){if(r)return r.call(o)};return i?l.promise.then(function(){return c()}):c()}},mr=new Map,km=function(t,e){var i=t.fields,n=t.updater;i.forEach(function(s){n(s,e[s])})},Tm={create:function(t,e){var i=Ye(t),n=new Map,s={wormholes:n,state:e};mr.set(t,s);var r=t.connectedCallback;t.connectedCallback=function(){mr.set(t,s),r&&r.call(t)};var o=t.disconnectedCallback;t.disconnectedCallback=function(){mr.delete(t),o&&o.call(t)},i.addEventListener("openWormhole",function(a){a.stopPropagation();var l=a.detail,u=l.consumer,c=l.onOpen;if(!n.has(u)){if(typeof u!="symbol"){var h=u.connectedCallback,d=u.disconnectedCallback;u.connectedCallback=function(){n.set(u,a.detail),h&&h.call(u)},u.disconnectedCallback=function(){n.delete(u),d&&d.call(u)}}n.set(u,a.detail),km(a.detail,s.state),c==null||c.resolve(function(){n.delete(u)})}}),i.addEventListener("closeWormhole",function(a){var l=a.detail;n.delete(l)})},Provider:function(t,e){var i=t.state,n=SI();if(mr.has(n)){var s=mr.get(n);s.state=i,s.wormholes.forEach(function(r){km(r,i)})}return e}};const eA="vmLoadStart",tA=new Set(["isFullscreenActive","isControlsActive","isTextTrackVisible","isPiPActive","isLive","isTouch","isAudio","isVideo","isAudioView","isVideoView"]),iA=new Set(["ready","playbackStarted","playbackEnded","playbackReady"]),nA=t=>tA.has(t)?`vm${t.replace("is","").replace("Active","")}Change`:iA.has(t)?`vm${t.charAt(0).toUpperCase()}${t.slice(1)}`:`vm${t.charAt(0).toUpperCase()}${t.slice(1)}Change`;function sA(t,e,i,n){const s=[];s.push(new CustomEvent(nA(e),{detail:i})),e==="paused"&&!i&&s.push(new CustomEvent("vmPlay")),e==="seeking"&&n&&!i&&s.push(new CustomEvent("vmSeeked")),s.forEach(r=>{t.dispatchEvent(r)})}const me=(t,e)=>ZI(t,e);var qa;(function(t){t.Audio="audio",t.Video="video",t.HLS="hls",t.Dash="dash",t.YouTube="youtube",t.Vimeo="vimeo",t.Dailymotion="dailymotion"})(qa||(qa={}));const Eu=/\.(m4a|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,_m=/\.(mp4|og[gv]|webm|mov|m4v)($|\?)/i,Su=/\.(m3u8)($|\?)/i,rA=/^application\/(x-mpegURL|vnd\.apple\.mpegURL)$/i,oA=/\.(mpd)($|\?)/i,Ky="vmProviderChange",zs=t=>(e,i)=>{const n=Fl(t,HTMLElement)?t:Ye(t),s=new CustomEvent(Ky,{bubbles:!0,composed:!0,detail:{by:n,prop:e,value:i}});n.dispatchEvent(s)},aA=new Set(["ready","playing","playbackReady","playbackStarted","playbackEnded","seeking","buffered","buffering","duration","viewType","mediaTitle","mediaType","currentSrc","currentPoster","playbackRates","playbackQualities","textTracks","currentTextTrack","isTextTrackVisible","audioTracks","currentAudioTrack","isPiPActive","isFullscreenActive"]),lA=t=>By(t)||aA.has(t);var Cm=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const Gy=Symbol("vmProviderCache"),Qy="vmMediaProviderConnect",cA="vmMediaProviderDisconnect";function Yy(t,e){return new CustomEvent(t,{bubbles:!0,composed:!0,detail:e})}function uA(t){const e=Ye(t),i=new st,n=new Map;t[Gy]=n;function s(){Object.keys(t).forEach(l=>{n.set(l,t[l])})}function r(){Ht(()=>Cm(this,void 0,void 0,function*(){var l;t.ready=!1,t.provider=void 0,n.clear(),(l=t.onProviderDisconnect)===null||l===void 0||l.call(t),e.dispatchEvent(Yy(cA))}))}function o(l){l.stopImmediatePropagation(),s();const u=l.detail,c=Ye(l.detail);if(t.provider===c)return;const h=c==null?void 0:c.nodeName.toLowerCase().replace("vm-","");Ht(()=>Cm(this,void 0,void 0,function*(){t.provider=c,t.currentProvider=Object.values(qa).find(d=>h===d),Nt(u,void 0,()=>r())}))}function a(l){var u;l.stopImmediatePropagation();const{by:c,prop:h,value:d}=l.detail;if(!lA(h)){(u=t.logger)===null||u===void 0||u.warn(`${c.nodeName} tried to change \`${h}\` but it is readonly.`);return}Ht(()=>{n.set(h,d),t[h]=d})}Nt(t,()=>{i.add(xe(e,Qy,o)),i.add(xe(e,Ky,a))},()=>{i.empty(),n.clear()})}function fn(t){const e=Yy(Qy,t);Nt(t,()=>{Ye(t).dispatchEvent(e)})}var Em=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const hA=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.willAttach=!1,this.preload="metadata",X(this),this.willAttach||fn(this)}getAdapter(){var t,e;return Em(this,void 0,void 0,function*(){const i=(e=yield(t=this.fileProvider)===null||t===void 0?void 0:t.getAdapter())!==null&&e!==void 0?e:{};return i.canPlay=n=>Em(this,void 0,void 0,function*(){return _t(n)&&Eu.test(n)}),i})}render(){return g("vm-file",{noConnect:!0,willAttach:this.willAttach,crossOrigin:this.crossOrigin,preload:this.preload,disableRemotePlayback:this.disableRemotePlayback,mediaTitle:this.mediaTitle,viewType:zt.Audio,ref:t=>{this.fileProvider=t}},g("slot",null))}},dA=":host([hidden]){display:none}";var fA=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const mA=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.canToggleCaptionVisibility=!1,this.showIcon="captions-on",this.hideIcon="captions-off",this.tooltipPosition="top",this.hideTooltip=!1,this.keys="c",this.i18n={},this.playbackReady=!1,this.textTracks=[],this.isTextTrackVisible=!1,X(this),me(this,["i18n","textTracks","isTextTrackVisible","playbackReady"])}onTextTracksChange(){var t;return fA(this,void 0,void 0,function*(){const e=fi(this);this.canToggleCaptionVisibility=this.textTracks.length>0&&((t=yield e==null?void 0:e.canSetTextTrackVisibility())!==null&&t!==void 0?t:!1)})}componentDidLoad(){this.onTextTracksChange()}onClick(){var t;const e=fi(this);(t=e==null?void 0:e.setTextTrackVisibility)===null||t===void 0||t.call(e,!this.isTextTrackVisible)}render(){const t=this.isTextTrackVisible?this.i18n.disableCaptions:this.i18n.enableCaptions,e=N(this.keys)?t:`${t} (${this.keys})`;return g(Bs,{hidden:!this.canToggleCaptionVisibility},g("vm-control",{label:this.i18n.captions,keys:this.keys,hidden:!this.canToggleCaptionVisibility,pressed:this.isTextTrackVisible,onClick:this.onClick.bind(this)},g("vm-icon",{name:this.isTextTrackVisible?this.showIcon:this.hideIcon,library:this.icons}),g("vm-tooltip",{hidden:this.hideTooltip,position:this.tooltipPosition,direction:this.tooltipDirection},e)))}static get watchers(){return{textTracks:["onTextTracksChange"],playbackReady:["onTextTracksChange"]}}static get style(){return dA}},Wa=new Set,ca=new Set,Ka=new Map;function Cr(){Ht(()=>{ca.forEach(t=>{const e=parseFloat(window.getComputedStyle(t).height);Wa.forEach(i=>{const n=Ka.get(i),s=Cc(i,t),r=Cc(i,t,0,e)||Cc(i,t,0,-e);n.set(t,s||r?e:0)})}),Wa.forEach(t=>{const e=Ka.get(t);t.style.setProperty("--vm-controls-height",`${Math.max(0,Math.max(...e.values()))}px`)})})}function pA(t){const e=Ye(t);function i(){return e.shadowRoot.querySelector(".controls")}Nt(t,()=>{const n=i();Li(n)||(ca.add(n),Cr())},()=>{ca.delete(i()),Cr()}),bs(t,"componentDidLoad",()=>{ca.add(i()),Cr()}),bs(t,"componentDidRender",Cr)}function Jy(t){const e=Ye(t);Nt(t,()=>{Wa.add(e),Ka.set(e,new Map),Cr()},()=>{Wa.delete(e),Ka.delete(e)})}const gA=":host{position:absolute;left:0;bottom:0;width:100%;pointer-events:none;z-index:var(--vm-captions-z-index)}.captions{width:100%;text-align:center;color:var(--vm-captions-text-color);font-size:var(--vm-captions-font-size);padding:$control-spacing;display:none;pointer-events:none;transition:transform 0.4s ease-in-out, opacity 0.3s ease-in-out}.captions.enabled{display:inline-block}.captions.hidden{display:none !important}.captions.inactive{opacity:0;visibility:hidden}.captions.fontMd{font-size:var(--vm-captions-font-size-medium)}.captions.fontLg{font-size:var(--vm-captions-font-size-large)}.captions.fontXl{font-size:var(--vm-captions-font-size-xlarge)}.cue{display:inline-block;background:var(--vm-captions-cue-bg-color);border-radius:var(--vm-captions-cue-border-radius);box-decoration-break:clone;line-height:185%;padding:var(--vm-captions-cue-padding);white-space:pre-wrap;pointer-events:none}.cue>div{display:inline}.cue:empty{display:none}";var vA=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const yA=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.sizeDisposal=new st,this.textDisposal=new st,this.isEnabled=!1,this.fontSize="sm",this.hidden=!1,this.isControlsActive=!1,this.isVideoView=!1,this.playbackStarted=!1,this.textTracks=[],this.currentTextTrack=-1,this.isTextTrackVisible=!0,X(this),Jy(this),me(this,["isVideoView","playbackStarted","isControlsActive","textTracks","currentTextTrack","isTextTrackVisible"])}onEnabledChange(){this.isEnabled=this.playbackStarted&&this.isVideoView}onTextTracksChange(){const t=this.textTracks[this.currentTextTrack],e=()=>{var i;const n=Array.from((i=t.activeCues)!==null&&i!==void 0?i:[]);this.renderCurrentCue(n[0])};this.textDisposal.empty(),Mt(t)||(e(),this.textDisposal.add(xe(t,"cuechange",e)))}connectedCallback(){this.dispatch=Ki(this),this.dispatch("shouldRenderNativeTextTracks",!1),this.onTextTracksChange(),this.onPlayerResize()}disconnectedCallback(){this.textDisposal.empty(),this.sizeDisposal.empty(),this.dispatch("shouldRenderNativeTextTracks",!0)}onPlayerResize(){return vA(this,void 0,void 0,function*(){const t=yield $i(this);if(N(t))return;const e=yield t.getContainer();new ResizeObserver(n=>{const s=n[0],{width:r}=s.contentRect;r>=1360?this.fontSize="xl":r>=1024?this.fontSize="lg":r>=768?this.fontSize="md":this.fontSize="sm"}).observe(e)})}renderCurrentCue(t){if(Mt(t)){this.cue="";return}const e=document.createElement("div");e.append(t.getCueAsHTML()),this.cue=e.innerHTML.trim()}render(){return g("div",{style:{transform:`translateY(calc(${this.isControlsActive?"var(--vm-controls-height)":"24px"} * -1))`},class:{captions:!0,enabled:this.isEnabled,hidden:this.hidden,fontMd:this.fontSize==="md",fontLg:this.fontSize==="lg",fontXl:this.fontSize==="xl",inactive:!this.isTextTrackVisible}},g("span",{class:"cue"},this.cue))}static get watchers(){return{isVideoView:["onEnabledChange"],playbackStarted:["onEnabledChange"],textTracks:["onTextTracksChange"],currentTextTrack:["onTextTracksChange"]}}static get style(){return gA}},bA=":host{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:var(--vm-click-to-play-z-index)}.clickToPlay{display:none;width:100%;height:100%;pointer-events:none}.clickToPlay.enabled{display:inline-block;pointer-events:auto}";var wA=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const kA=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.useOnMobile=!1,this.paused=!0,this.isVideoView=!1,this.isMobile=!1,X(this),me(this,["paused","isVideoView","isMobile"])}connectedCallback(){this.dispatch=Ki(this)}forceClick(){return wA(this,void 0,void 0,function*(){this.onClick()})}onClick(){this.dispatch("paused",!this.paused)}render(){return g("div",{class:{clickToPlay:!0,enabled:this.isVideoView&&(!this.isMobile||this.useOnMobile)},onClick:this.onClick.bind(this)})}static get style(){return bA}},TA="button{display:flex;align-items:center;flex-direction:row;border:var(--vm-control-border);cursor:pointer;flex-shrink:0;font-size:var(--vm-control-icon-size);color:var(--vm-control-color);background:var(--vm-control-bg, transparent);border-radius:var(--vm-control-border-radius);padding:var(--vm-control-padding);position:relative;pointer-events:auto;transition:all 0.3s ease;transform:scale(var(--vm-control-scale, 1));touch-action:manipulation;box-sizing:border-box}button.hidden{display:none}button:focus{outline:0}button.tapHighlight{background:var(--vm-control-tap-highlight)}button.notTouch:focus,button.notTouch:hover,button.notTouch[aria-expanded='true']{background:var(--vm-control-focus-bg);color:var(--vm-control-focus-color);transform:scale(calc(var(--vm-control-scale, 1) + 0.06))}";var Ec=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const _A=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmInteractionChange=R(this,"vmInteractionChange",7),this.vmFocus=R(this,"vmFocus",7),this.vmBlur=R(this,"vmBlur",7),this.keyboardDisposal=new st,this.showTapHighlight=!1,this.hidden=!1,this.isTouch=!1,X(this),me(this,["isTouch"])}onKeysChange(){return Ec(this,void 0,void 0,function*(){if(this.keyboardDisposal.empty(),N(this.keys))return;const t=yield $i(this),e=this.keys.split("/");N(t)||this.keyboardDisposal.add(xe(t,"keydown",i=>{e.includes(i.key)&&this.button.click()}))})}connectedCallback(){this.findTooltip(),this.onKeysChange()}componentWillLoad(){this.findTooltip()}disconnectedCallback(){this.keyboardDisposal.empty()}focusControl(){var t;return Ec(this,void 0,void 0,function*(){(t=this.button)===null||t===void 0||t.focus()})}blurControl(){var t;return Ec(this,void 0,void 0,function*(){(t=this.button)===null||t===void 0||t.blur()})}onTouchStart(){this.showTapHighlight=!0}onTouchEnd(){setTimeout(()=>{this.showTapHighlight=!1},100)}findTooltip(){const t=this.host.querySelector("vm-tooltip");return Li(t)||(this.describedBy=t.id),t}onShowTooltip(){const t=this.findTooltip();Li(t)||(t.active=!0),this.vmInteractionChange.emit(!0)}onHideTooltip(){const t=this.findTooltip();Li(t)||(t.active=!1),this.button.blur(),this.vmInteractionChange.emit(!1)}onFocus(){this.vmFocus.emit(),this.onShowTooltip()}onBlur(){this.vmBlur.emit(),this.onHideTooltip()}onMouseEnter(){this.onShowTooltip()}onMouseLeave(){this.onHideTooltip()}render(){const t=this.expanded?"true":"false",e=this.pressed?"true":"false";return g("button",{class:{hidden:this.hidden,notTouch:!this.isTouch,tapHighlight:this.showTapHighlight},id:this.identifier,type:"button","aria-label":this.label,"aria-haspopup":N(this.menu)?void 0:"true","aria-controls":this.menu,"aria-expanded":N(this.menu)?void 0:t,"aria-pressed":N(this.pressed)?void 0:e,"aria-hidden":this.hidden?"true":"false","aria-describedby":this.describedBy,onTouchStart:this.onTouchStart.bind(this),onTouchEnd:this.onTouchEnd.bind(this),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this),onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this),ref:i=>{this.button=i}},g("slot",null))}get host(){return this}static get watchers(){return{keys:["onKeysChange"]}}static get style(){return TA}},CA=":host{width:100%}.controlGroup{position:relative;width:100%;display:flex;flex-wrap:wrap;flex-direction:inherit;align-items:inherit;justify-content:inherit;box-sizing:border-box}.controlGroup.spaceTop{margin-top:var(--vm-control-group-spacing)}.controlGroup.spaceBottom{margin-bottom:var(--vm-control-group-spacing)}::slotted(*){margin-left:var(--vm-controls-spacing)}::slotted(*:first-child){margin-left:0}",EA=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.space="none",X(this)}render(){return g("div",{class:{controlGroup:!0,spaceTop:this.space!=="none"&&this.space!=="bottom",spaceBottom:this.space!=="none"&&this.space!=="top"}},g("slot",null))}get host(){return this}static get style(){return CA}},SA=":host{flex:1}",IA=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),X(this)}static get style(){return SA}},AA=(t,e=1e3,i=!1)=>{let n;return function(...r){const o=this,a=function(){n=void 0,i||t.apply(o,r)},l=i&&N(n);clearTimeout(n),n=setTimeout(a,e),l&&t.apply(o,r)}},PA=":host{position:relative;width:100%;z-index:var(--vm-controls-z-index)}:host([video]){position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.controls{display:flex;width:100%;position:absolute;flex-wrap:wrap;pointer-events:auto;box-sizing:border-box;background:var(--vm-controls-bg);padding:var(--vm-controls-padding);border-radius:var(--vm-controls-border-radius);opacity:0;visibility:hidden;transition:var(--vm-fade-transition)}.controls.audio{position:relative}.controls.hidden{display:none}.controls.active{opacity:1;visibility:visible}.controls.fullWidth{width:100%}.controls.fullHeight{height:100%}::slotted(*:not(vm-control-group)){margin-left:var(--vm-controls-spacing)}::slotted(*:not(vm-control-group):first-child){margin-left:0}";var RA=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const Jn={},Jo={},xA=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.disposal=new st,this.isInteracting=!1,this.hidden=!1,this.fullWidth=!1,this.fullHeight=!1,this.direction="row",this.align="center",this.justify="start",this.pin="bottomLeft",this.activeDuration=2750,this.waitForPlaybackStart=!1,this.hideWhenPaused=!1,this.hideOnMouseLeave=!1,this.isAudioView=!1,this.isSettingsActive=!1,this.playbackReady=!1,this.isControlsActive=!1,this.paused=!0,this.playbackStarted=!1,X(this),pA(this),me(this,["playbackReady","isAudioView","isControlsActive","isSettingsActive","paused","playbackStarted"])}connectedCallback(){this.dispatch=Ki(this),this.onControlsChange(),this.setupPlayerListeners()}componentWillLoad(){this.onControlsChange()}disconnectedCallback(){this.disposal.empty(),delete Jo[Jn[this]],delete Jn[this]}setupPlayerListeners(){return RA(this,void 0,void 0,function*(){const t=yield $i(this);if(N(t))return;["focus","keydown","click","touchstart","mouseleave"].forEach(i=>{this.disposal.add(xe(t,i,this.onControlsChange.bind(this)))}),this.disposal.add(xe(t,"mousemove",AA(this.onControlsChange,50,!0).bind(this))),Jn[this]=t})}show(){this.dispatch("isControlsActive",!0)}hide(){this.dispatch("isControlsActive",!1)}hideWithDelay(){clearTimeout(Jo[Jn[this]]),Jo[Jn[this]]=setTimeout(()=>{this.hide()},this.activeDuration)}onControlsChange(t){if(clearTimeout(Jo[Jn[this]]),this.hidden||!this.playbackReady){this.hide();return}if(this.isAudioView){this.show();return}if(this.waitForPlaybackStart&&!this.playbackStarted){this.hide();return}if(this.isInteracting||this.isSettingsActive){this.show();return}if(this.hideWhenPaused&&this.paused){this.hideWithDelay();return}if(this.hideOnMouseLeave&&!this.paused&&(t==null?void 0:t.type)==="mouseleave"){this.hide();return}if(!this.paused){this.show(),this.hideWithDelay();return}this.show()}getPosition(){if(this.isAudioView)return{};if(this.pin==="center")return{top:"50%",left:"50%",transform:"translate(-50%, -50%)"};const t=this.pin.split(/(?=[L|R])/).map(e=>e.toLowerCase());return{[t[0]]:0,[t[1]]:0}}onStartInteraction(){this.isInteracting=!0}onEndInteraction(){this.isInteracting=!1}render(){return g(Bs,{video:!this.isAudioView},g("div",{style:Object.assign(Object.assign({},this.getPosition()),{flexDirection:this.direction,alignItems:this.align==="center"?"center":`flex-${this.align}`,justifyContent:this.justify}),class:{controls:!0,audio:this.isAudioView,hidden:this.hidden,active:this.playbackReady&&this.isControlsActive,fullWidth:this.isAudioView||this.fullWidth,fullHeight:!this.isAudioView&&this.fullHeight},onMouseEnter:this.onStartInteraction.bind(this),onMouseLeave:this.onEndInteraction.bind(this),onTouchStart:this.onStartInteraction.bind(this),onTouchEnd:this.onEndInteraction.bind(this)},g("slot",null)))}static get watchers(){return{paused:["onControlsChange"],hidden:["onControlsChange"],isAudioView:["onControlsChange"],isInteracting:["onControlsChange"],isSettingsActive:["onControlsChange"],hideWhenPaused:["onControlsChange"],hideOnMouseLeave:["onControlsChange"],playbackStarted:["onControlsChange"],waitForPlaybackStart:["onControlsChange"],playbackReady:["onControlsChange"]}}static get style(){return PA}},DA=":host{display:flex;align-items:center;justify-content:center}",MA=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.currentTime=0,this.i18n={},this.alwaysShowHours=!1,X(this),me(this,["currentTime","i18n"])}render(){return g("vm-time",{label:this.i18n.currentTime,seconds:this.currentTime,alwaysShowHours:this.alwaysShowHours})}static get style(){return DA}};var Sc,Ic;const Rt=typeof window!="undefined",Hl=Rt?(Sc=window.navigator)===null||Sc===void 0?void 0:Sc.userAgent.toLowerCase():"",js=/iphone|ipad|ipod|ios|CriOS|FxiOS/.test(Hl),LA=/android/.test(Hl),Ac=Rt&&(js||LA),NA=Rt&&/(iPhone|iPod)/gi.test((Ic=window.navigator)===null||Ic===void 0?void 0:Ic.platform);/firefox/.test(Hl);const OA=Rt&&window.chrome;Rt&&!OA&&(window.safari||js||/(apple|safari)/.test(Hl));const VA=t=>{if(!Rt||N(window.ResizeObserver))return t(Ac),ri;function e(){t(window.innerWidth<=480||Ac)}return t(window.innerWidth<=480||Ac),xe(window,"resize",e)},FA=t=>{if(!Rt)return ri;let e=0;const i=xe(document,"touchstart",()=>{e=new Date().getTime(),t(!0)},!0),n=xe(document,"mousemove",()=>{new Date().getTime()-e<500||t(!1)},!0);return()=>{i(),n()}},UA=()=>Rt&&window.screen.orientation&&!!window.screen.orientation.lock,Xy=()=>{if(!Rt)return!1;const t=document.createElement("video");return!!document.pictureInPictureEnabled&&!t.disablePictureInPicture},Zy=()=>{if(!Rt)return!1;const t=document.createElement("video");return Tu(t.webkitSupportsPresentationMode)&&Tu(t.webkitSetPresentationMode)&&!NA},HA=()=>Xy()||Zy(),Sm=(t=!0,e=!0)=>{if(!Rt)return Promise.resolve(!1);const i=document.createElement("video");return t&&(i.setAttribute("muted",""),i.muted=!0),e&&(i.setAttribute("playsinline",""),i.setAttribute("webkit-playsinline","")),i.setAttribute("height","0"),i.setAttribute("width","0"),i.style.position="fixed",i.style.top="0",i.style.width="0",i.style.height="0",i.style.opacity="0",new Promise(n=>n(i.play())).catch(ri),Promise.resolve(!i.paused)};function BA(t){if(!!_t(t))try{return JSON.parse(t)}catch{return}}const $A=t=>!Mt(t)&&(Vl(t)||_t(t)&&t.startsWith("{")),zA=t=>Vl(t)?t:BA(t),Pc=(t,e=1)=>new Promise((i,n)=>{const s=new Image,r=()=>{delete s.onload,delete s.onerror,s.naturalWidth>=e?i(s):n(s)};Object.assign(s,{onload:r,onerror:r,src:t})}),jA=(t,e,i=ri)=>{var n;const s=document.createElement("script");s.src=t,s.onload=e,s.onerror=i;const r=document.getElementsByTagName("script")[0];(n=r.parentNode)===null||n===void 0||n.insertBefore(s,r)},e0=t=>{if(!!$A(t))return zA(t)},Im=(t,e="")=>{if(!Rt)return e;try{return window.decodeURIComponent(t)}catch{return e}},qA=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g,WA=t=>{const e=Object.create(null);if(N(t))return e;let i;for(;i=qA.exec(t);){const n=Im(i[1],i[1]).replace("[]",""),s=_t(i[2])?Im(i[2].replace(/\+/g," "),i[2]):"",r=e[n];r&&!za(r)&&(e[n]=[r]),r?e[n].push(s):e[n]=s}return e},KA=t=>{const e=[],i=(n,s)=>{e.push(`${encodeURIComponent(n)}=${encodeURIComponent(s)}`)};return Object.keys(t).forEach(n=>{const s=t[n];Mt(s)||(za(s)?s.forEach(r=>i(n,r)):i(n,s))}),e.join("&")},Am=(t,e="preconnect",i)=>{if(!Rt)return!1;const n=document.createElement("link");return n.rel=e,n.href=t,N(i)||(n.as=i),n.crossOrigin="true",document.head.append(n),!0},GA=(t,e)=>{if(N(e)||e.length===0)return t;const i=t.split("?",2);return i[0]+(N(i[1])?`?${e}`:`?${i[1]}&${e}`)},QA=(t,e)=>GA(t,Vl(e)?KA(e):e),YA=t=>{if(!!_t(t))return WA(t)},Xn={},t0=(t,e,i,n=()=>!0,s=jA)=>{const r=a=>{if(!N(window[a]))return window[a];if(window.exports&&window.exports[a])return window.exports[a];if(window.module&&window.module.exports&&window.module.exports[a])return window.module.exports[a]},o=r(e);return o&&n(o)?Promise.resolve(o):new Promise((a,l)=>{if(!N(Xn[t])){Xn[t].push({resolve:a,reject:l});return}Xn[t]=[{resolve:a,reject:l}];const u=c=>{Xn[t].forEach(h=>h.resolve(c))};if(!N(i)){const c=window[i];window[i]=function(){N(c)||c(),u(r(e))}}s(t,()=>{N(i)&&u(r(e))},c=>{Xn[t].forEach(h=>{h.reject(c)}),delete Xn[t]})})},Bl=(t,e=[])=>me(t,["autoplay","controls","language","muted","logger","loop","aspectRatio","playsinline",...e]),JA=":host{z-index:var(--vm-media-z-index)}";var xt=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const Rc=new Map,XA=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmLoadStart=R(this,"vmLoadStart",7),this.vmError=R(this,"vmError",7),this.defaultInternalState={},this.internalState={currentTime:0,volume:0,muted:!1,isAdsPlaying:!1,playbackReady:!1},this.embedSrc="",this.mediaTitle="",this.shouldAutoplayQueue=!1,this.showUpNextQueue=!1,this.showShareButtons=!1,this.showDailymotionLogo=!1,this.showVideoInfo=!0,this.language="en",this.autoplay=!1,this.controls=!1,this.loop=!1,this.muted=!1,this.playsinline=!1,X(this),fn(this),Bl(this)}onVideoIdChange(){if(this.internalState=Object.assign({},this.defaultInternalState),!this.videoId){this.embedSrc="";return}this.embedSrc=`${this.getOrigin()}/embed/video/${this.videoId}?api=1`,this.fetchVideoInfo=this.getVideoInfo(),this.pendingMediaTitleCall=ja()}onControlsChange(){this.internalState.playbackReady&&this.remoteControl("controls",this.controls)}onCustomPosterChange(){this.dispatch("currentPoster",this.poster)}connectedCallback(){this.dispatch=zs(this),this.dispatch("viewType",zt.Video),this.onVideoIdChange(),this.internalState.muted=this.muted,this.defaultInternalState=Object.assign({},this.internalState)}componentWillLoad(){this.initialMuted=this.muted}getOrigin(){return"https://www.dailymotion.com"}getPreconnections(){return[this.getOrigin(),"https://static1.dmcdn.net"]}remoteControl(t,e){return this.embed.postMessage({command:t,parameters:e?[e]:[]})}buildParams(){return{autoplay:this.autoplay,mute:this.initialMuted,controls:this.controls,"queue-autoplay-next":this.shouldAutoplayQueue,"queue-enable":this.showUpNextQueue,"sharing-enable":this.showShareButtons,syndication:this.syndication,"ui-highlight":this.color,"ui-logo":this.showDailymotionLogo,"ui-start-screen-info":this.showVideoInfo}}getVideoInfo(){return xt(this,void 0,void 0,function*(){if(Rc.has(this.videoId))return Rc.get(this.videoId);const t="https://api.dailymotion.com";return window.fetch(`${t}/video/${this.videoId}?fields=duration,thumbnail_1080_url`).then(e=>e.json()).then(e=>{const i=e.thumbnail_1080_url,n=parseFloat(e.duration);return Rc.set(this.videoId,{poster:i,duration:n}),{poster:i,duration:n}})})}onEmbedSrcChange(){this.vmLoadStart.emit(),this.dispatch("viewType",zt.Video)}onEmbedMessage(t){var e,i;const n=t.detail;switch(n.event){case"playback_ready":this.onControlsChange(),this.dispatch("currentSrc",this.embedSrc),this.dispatch("mediaType",oi.Video),Promise.all([this.fetchVideoInfo,(e=this.pendingMediaTitleCall)===null||e===void 0?void 0:e.promise]).then(([s,r])=>{var o,a;this.dispatch("duration",(o=s==null?void 0:s.duration)!==null&&o!==void 0?o:-1),this.dispatch("currentPoster",(a=this.poster)!==null&&a!==void 0?a:s==null?void 0:s.poster),this.dispatch("mediaTitle",r),this.dispatch("playbackReady",!0)});break;case"videochange":(i=this.pendingMediaTitleCall)===null||i===void 0||i.resolve(n.title);break;case"start":this.dispatch("paused",!1),this.dispatch("playbackStarted",!0),this.dispatch("buffering",!0);break;case"video_start":this.remoteControl("muted",this.internalState.muted),this.remoteControl("volume",this.internalState.volume),this.internalState.currentTime>0&&this.remoteControl("seek",this.internalState.currentTime);break;case"play":this.dispatch("paused",!1);break;case"pause":this.dispatch("paused",!0),this.dispatch("playing",!1),this.dispatch("buffering",!1);break;case"playing":this.dispatch("playing",!0),this.dispatch("buffering",!1);break;case"video_end":this.loop?setTimeout(()=>{this.remoteControl("play")},300):this.dispatch("playbackEnded",!0);break;case"timeupdate":this.dispatch("currentTime",parseFloat(n.time));break;case"volumechange":this.dispatch("muted",n.muted==="true"),this.dispatch("volume",Math.floor(parseFloat(n.volume)*100));break;case"seeking":this.dispatch("currentTime",parseFloat(n.time)),this.dispatch("seeking",!0);break;case"seeked":this.dispatch("currentTime",parseFloat(n.time)),this.dispatch("seeking",!1);break;case"waiting":this.dispatch("buffering",!0);break;case"progress":this.dispatch("buffered",parseFloat(n.time));break;case"durationchange":this.dispatch("duration",parseFloat(n.duration));break;case"qualitiesavailable":this.dispatch("playbackQualities",n.qualities.map(s=>`${s}p`));break;case"qualitychange":this.dispatch("playbackQuality",`${n.quality}p`);break;case"fullscreenchange":this.dispatch("isFullscreenActive",n.fullscreen==="true");break;case"error":this.vmError.emit(n.error);break}}getAdapter(){return xt(this,void 0,void 0,function*(){const t=/(?:dai\.ly|dailymotion|dailymotion\.com)\/(?:video\/|embed\/|)(?:video\/|)((?:\w)+)/;return{getInternalPlayer:()=>xt(this,void 0,void 0,function*(){return this.embed}),play:()=>xt(this,void 0,void 0,function*(){this.remoteControl("play")}),pause:()=>xt(this,void 0,void 0,function*(){this.remoteControl("pause")}),canPlay:e=>xt(this,void 0,void 0,function*(){return _t(e)&&t.test(e)}),setCurrentTime:e=>xt(this,void 0,void 0,function*(){e!==this.internalState.currentTime&&(this.internalState.currentTime=e,this.remoteControl("seek",e))}),setMuted:e=>xt(this,void 0,void 0,function*(){this.internalState.muted=e,this.remoteControl("muted",e)}),setVolume:e=>xt(this,void 0,void 0,function*(){this.internalState.volume=e/100,this.dispatch("volume",e),this.remoteControl("volume",e/100)}),canSetPlaybackQuality:()=>xt(this,void 0,void 0,function*(){return!0}),setPlaybackQuality:e=>xt(this,void 0,void 0,function*(){this.remoteControl("quality",e.slice(0,-1))}),canSetFullscreen:()=>xt(this,void 0,void 0,function*(){return!0}),enterFullscreen:()=>xt(this,void 0,void 0,function*(){this.remoteControl("fullscreen",!0)}),exitFullscreen:()=>xt(this,void 0,void 0,function*(){this.remoteControl("fullscreen",!1)})}})}render(){return g("vm-embed",{embedSrc:this.embedSrc,mediaTitle:this.mediaTitle,origin:this.getOrigin(),params:this.buildParams(),decoder:YA,preconnections:this.getPreconnections(),onVmEmbedMessage:this.onEmbedMessage.bind(this),onVmEmbedSrcChange:this.onEmbedSrcChange.bind(this),ref:t=>{this.embed=t}})}static get watchers(){return{videoId:["onVideoIdChange"],controls:["onControlsChange"],poster:["onCustomPosterChange"]}}static get style(){return JA}},ZA=":host{z-index:var(--vm-media-z-index)}";var li=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const eP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmLoadStart=R(this,"vmLoadStart",7),this.vmError=R(this,"vmError",7),this.textTracksDisposal=new st,this.hasAttached=!1,this.version="latest",this.config={},this.autoplay=!1,this.preload="metadata",this.enableTextTracksByDefault=!0,this.shouldRenderNativeTextTracks=!0,this.isTextTrackVisible=!0,this.currentTextTrack=-1,X(this),fn(this),me(this,["autoplay","shouldRenderNativeTextTracks","isTextTrackVisible","currentTextTrack"])}onSrcChange(){var t;!this.hasAttached||(this.vmLoadStart.emit(),(t=this.dash)===null||t===void 0||t.attachSource(this.src))}onShouldRenderNativeTextTracks(){var t;this.shouldRenderNativeTextTracks?this.textTracksDisposal.empty():this.hideCurrentTextTrack(),(t=this.dash)===null||t===void 0||t.enableForcedTextStreaming(!this.shouldRenderNativeTextTracks)}onTextTrackChange(){var t,e;if(!(!this.shouldRenderNativeTextTracks||N(this.dash))&&(this.dash.setTextTrack(this.isTextTrackVisible?this.currentTextTrack:-1),!this.isTextTrackVisible)){const i=Array.from((e=(t=this.mediaEl)===null||t===void 0?void 0:t.textTracks)!==null&&e!==void 0?e:[])[this.currentTextTrack];(i==null?void 0:i.mode)==="hidden"&&this.dispatch("currentTextTrack",-1)}}connectedCallback(){this.dispatch=zs(this),this.mediaEl&&this.setupDash()}disconnectedCallback(){this.textTracksDisposal.empty(),this.destroyDash()}setupDash(){return li(this,void 0,void 0,function*(){try{const t=this.libSrc||`https://cdn.jsdelivr.net/npm/dashjs@${this.version}/dist/dash.all.min.js`,e=yield t0(t,"dashjs");this.dash=e.MediaPlayer(this.config).create(),this.dash.initialize(this.mediaEl,null,this.autoplay),this.dash.setTextDefaultEnabled(this.enableTextTracksByDefault),this.dash.enableForcedTextStreaming(!this.shouldRenderNativeTextTracks),this.dash.on(e.MediaPlayer.events.PLAYBACK_METADATA_LOADED,()=>{this.dispatch("mediaType",oi.Video),this.dispatch("currentSrc",this.src),this.dispatchLevels(),this.listenToTextTracksForChanges(),this.dispatch("playbackReady",!0)}),this.dash.on(e.MediaPlayer.events.TRACK_CHANGE_RENDERED,()=>{this.shouldRenderNativeTextTracks||this.hideCurrentTextTrack()}),this.dash.on(e.MediaPlayer.events.ERROR,i=>{this.vmError.emit(i)}),this.hasAttached=!0}catch(t){this.vmError.emit(t)}})}destroyDash(){var t;return li(this,void 0,void 0,function*(){(t=this.dash)===null||t===void 0||t.reset(),this.hasAttached=!1})}onMediaElChange(t){return li(this,void 0,void 0,function*(){this.destroyDash(),!N(t.detail)&&(this.mediaEl=t.detail,yield this.setupDash())})}levelToPlaybackQuality(t){return t===-1?"Auto":`${t.height}p`}findLevelIndexFromQuality(t){return this.dash.getBitrateInfoListFor("video").findIndex(e=>this.levelToPlaybackQuality(e)===t)}dispatchLevels(){try{const t=this.dash.getBitrateInfoListFor("video");(t==null?void 0:t.length)>0&&(this.dispatch("playbackQualities",["Auto",...t.map(this.levelToPlaybackQuality)]),this.dispatch("playbackQuality","Auto"))}catch(t){this.vmError.emit(t)}}listenToTextTracksForChanges(){var t,e,i;if(this.textTracksDisposal.empty(),N(this.mediaEl)||this.shouldRenderNativeTextTracks)return;const n=(i=((e=(t=this.dash)===null||t===void 0?void 0:t.getCurrentTrackFor("text"))===null||e===void 0?void 0:e.index)-1)!==null&&i!==void 0?i:-1;this.currentTextTrack=n,this.dispatch("currentTextTrack",n),this.textTracksDisposal.add(xe(this.mediaEl.textTracks,"change",this.onTextTracksChange.bind(this)))}getTextTracks(){var t,e;return Array.from((e=(t=this.mediaEl)===null||t===void 0?void 0:t.textTracks)!==null&&e!==void 0?e:[])}hideCurrentTextTrack(){const t=this.getTextTracks();t[this.currentTextTrack]&&this.isTextTrackVisible&&(t[this.currentTextTrack].mode="hidden")}onTextTracksChange(){this.hideCurrentTextTrack(),this.dispatch("textTracks",this.getTextTracks()),this.dispatch("isTextTrackVisible",this.isTextTrackVisible),this.dispatch("currentTextTrack",this.currentTextTrack)}getAdapter(){var t,e;return li(this,void 0,void 0,function*(){const i=(e=yield(t=this.videoProvider)===null||t===void 0?void 0:t.getAdapter())!==null&&e!==void 0?e:{},n=i.canPlay;return Object.assign(Object.assign({},i),{getInternalPlayer:()=>li(this,void 0,void 0,function*(){return this.dash}),canPlay:s=>li(this,void 0,void 0,function*(){var r;return _t(s)&&oA.test(s)||((r=n==null?void 0:n(s))!==null&&r!==void 0?r:!1)}),canSetPlaybackQuality:()=>li(this,void 0,void 0,function*(){var s,r;try{return((r=(s=this.dash)===null||s===void 0?void 0:s.getBitrateInfoListFor("video"))===null||r===void 0?void 0:r.length)>0}catch(o){return this.vmError.emit(o),!1}}),setPlaybackQuality:s=>li(this,void 0,void 0,function*(){if(!N(this.dash)){const r=this.findLevelIndexFromQuality(s);this.dash.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:r===-1}}}}),r>=0&&this.dash.setQualityFor("video",r),this.dispatch("playbackQuality",s)}}),setCurrentTextTrack:s=>li(this,void 0,void 0,function*(){var r;this.shouldRenderNativeTextTracks?i.setCurrentTextTrack(s):(this.currentTextTrack=s,(r=this.dash)===null||r===void 0||r.setTextTrack(s),this.onTextTracksChange())}),setTextTrackVisibility:s=>li(this,void 0,void 0,function*(){var r;this.shouldRenderNativeTextTracks?i.setTextTrackVisibility(s):(this.isTextTrackVisible=s,(r=this.dash)===null||r===void 0||r.enableText(s),this.onTextTracksChange())})})})}render(){return g("vm-video",{willAttach:!0,crossOrigin:this.crossOrigin,preload:this.preload,poster:this.poster,controlsList:this.controlsList,autoPiP:this.autoPiP,disablePiP:this.disablePiP,hasCustomTextManager:!this.shouldRenderNativeTextTracks,disableRemotePlayback:this.disableRemotePlayback,mediaTitle:this.mediaTitle,ref:t=>{this.videoProvider=t}})}static get watchers(){return{src:["onSrcChange"],hasAttached:["onSrcChange"],shouldRenderNativeTextTracks:["onShouldRenderNativeTextTracks"],isTextTrackVisible:["onTextTrackChange"],currentTextTrack:["onTextTrackChange"]}}static get style(){return ZA}},tP=":host{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:var(--vm-dbl-click-fullscreen-z-index)}.dblClickFullscreen{display:none;width:100%;height:100%;pointer-events:none}.dblClickFullscreen.enabled{display:inline-block;pointer-events:auto}";var xc=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const iP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.canSetFullscreen=!1,this.useOnMobile=!1,this.isFullscreenActive=!0,this.isVideoView=!1,this.playbackReady=!1,this.isMobile=!1,this.clicks=0,X(this),me(this,["playbackReady","isFullscreenActive","isVideoView","isMobile"])}onPlaybackReadyChange(){return xc(this,void 0,void 0,function*(){const t=yield $i(this);N(t)||(this.canSetFullscreen=yield t.canSetFullscreen())})}onTriggerClickToPlay(){return xc(this,void 0,void 0,function*(){const[t]=qy(this,"vm-click-to-play");yield t==null?void 0:t.forceClick()})}onToggleFullscreen(){return xc(this,void 0,void 0,function*(){const t=yield $i(this);N(t)||(this.isFullscreenActive?t.exitFullscreen():t.enterFullscreen())})}onClick(){this.clicks+=1,this.clicks===1&&setTimeout(()=>{this.clicks===1?this.onTriggerClickToPlay():this.onToggleFullscreen(),this.clicks=0},300)}render(){return g("div",{class:{dblClickFullscreen:!0,enabled:this.playbackReady&&this.canSetFullscreen&&this.isVideoView&&(!this.isMobile||this.useOnMobile)},onClick:this.onClick.bind(this)})}static get watchers(){return{playbackReady:["onPlaybackReadyChange"]}}static get style(){return tP}},nP=":host{display:contents;pointer-events:none;z-index:var(--vm-controls-z-index)}",sP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.activeDuration=2750,this.waitForPlaybackStart=!1,this.hideWhenPaused=!1,this.hideOnMouseLeave=!1,this.isMobile=!1,this.isLive=!1,this.isAudioView=!1,this.isVideoView=!1,X(this),me(this,["theme","isMobile","isAudioView","isVideoView","isLive"])}buildAudioControls(){return g("vm-controls",{fullWidth:!0},g("vm-playback-control",{tooltipDirection:"right"}),g("vm-volume-control",null),!this.isLive&&g("vm-current-time",null),this.isLive&&g("vm-control-spacer",null),!this.isLive&&g("vm-scrubber-control",null),this.isLive&&g("vm-live-indicator",null),!this.isLive&&g("vm-end-time",null),!this.isLive&&g("vm-settings-control",{tooltipDirection:"left"}),g("div",{style:{marginLeft:"0",paddingRight:"2px"}}))}buildMobileVideoControls(){return g(vm,null,g("vm-scrim",{gradient:"up"}),g("vm-controls",{pin:"topLeft",fullWidth:!0,activeDuration:this.activeDuration,waitForPlaybackStart:this.waitForPlaybackStart,hideWhenPaused:this.hideWhenPaused},g("vm-control-spacer",null),g("vm-volume-control",null),!this.isLive&&g("vm-caption-control",null),!this.isLive&&g("vm-settings-control",null),this.isLive&&g("vm-fullscreen-control",null)),g("vm-controls",{pin:"center",justify:"center",activeDuration:this.activeDuration,waitForPlaybackStart:this.waitForPlaybackStart,hideWhenPaused:this.hideWhenPaused},g("vm-playback-control",{style:{"--vm-control-scale":"1.3"}})),!this.isLive&&g("vm-controls",{pin:"bottomLeft",fullWidth:!0,activeDuration:this.activeDuration,waitForPlaybackStart:this.waitForPlaybackStart,hideWhenPaused:this.hideWhenPaused},g("vm-control-group",null,g("vm-current-time",null),g("vm-control-spacer",null),g("vm-end-time",null),g("vm-fullscreen-control",null)),g("vm-control-group",{space:"top"},g("vm-scrubber-control",null))))}buildDesktopVideoControls(){return g(vm,null,this.theme!=="light"&&g("vm-scrim",{gradient:"up"}),g("vm-controls",{fullWidth:!0,pin:"bottomRight",activeDuration:this.activeDuration,waitForPlaybackStart:this.waitForPlaybackStart,hideWhenPaused:this.hideWhenPaused,hideOnMouseLeave:this.hideOnMouseLeave},!this.isLive&&g("vm-control-group",null,g("vm-scrubber-control",null)),g("vm-control-group",{space:this.isLive?"none":"top"},g("vm-playback-control",{tooltipDirection:"right"}),g("vm-volume-control",null),!this.isLive&&g("vm-time-progress",null),g("vm-control-spacer",null),!this.isLive&&g("vm-caption-control",null),this.isLive&&g("vm-live-indicator",null),g("vm-pip-control",null),!this.isLive&&g("vm-settings-control",null),g("vm-fullscreen-control",{tooltipDirection:"left"}))))}render(){return this.isAudioView?this.buildAudioControls():this.isVideoView&&this.isMobile?this.buildMobileVideoControls():this.isVideoView?this.buildDesktopVideoControls():null}static get style(){return nP}},rP=":host{z-index:var(--vm-menu-z-index)}";var Dc=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const oP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.textTracksDisposal=new st,this.canSetPlaybackRate=!1,this.canSetPlaybackQuality=!1,this.canSetTextTrack=!1,this.canSetAudioTrack=!1,this.pin="bottomRight",this.i18n={},this.playbackReady=!1,this.playbackRate=1,this.playbackRates=[1],this.isVideoView=!1,this.playbackQualities=[],this.textTracks=[],this.currentTextTrack=-1,this.audioTracks=[],this.currentAudioTrack=-1,this.isTextTrackVisible=!0,X(this),me(this,["i18n","playbackReady","playbackRate","playbackRates","playbackQuality","playbackQualities","isVideoView","textTracks","currentTextTrack","isTextTrackVisible","audioTracks","currentAudioTrack"])}onPlaybackReady(){return Dc(this,void 0,void 0,function*(){const t=yield $i(this);N(t)||(this.canSetPlaybackQuality=yield t.canSetPlaybackQuality(),this.canSetPlaybackRate=yield t.canSetPlaybackRate())})}onAudioTracksChange(){var t;return Dc(this,void 0,void 0,function*(){const e=fi(this);this.canSetAudioTrack=(t=yield e==null?void 0:e.canSetAudioTrack())!==null&&t!==void 0?t:!1})}onTextTracksChange(){var t;return Dc(this,void 0,void 0,function*(){const e=fi(this);this.canSetTextTrack=(t=yield e==null?void 0:e.canSetTextTrack())!==null&&t!==void 0?t:!1})}connectedCallback(){this.dispatch=Ki(this)}componentDidLoad(){this.onTextTracksChange()}disconnectedCallback(){this.textTracksDisposal.empty()}onPlaybackRateSelect(t){const e=t.target;this.dispatch("playbackRate",parseFloat(e.value))}buildPlaybackRateSubmenu(){if(this.playbackRates.length<=1||!this.canSetPlaybackRate)return g("vm-menu-item",{label:this.i18n.playbackRate,hint:this.i18n.normal});const t=e=>e===1?this.i18n.normal:`${e}`;return g("vm-submenu",{label:this.i18n.playbackRate,hint:t(this.playbackRate)},g("vm-menu-radio-group",{value:`${this.playbackRate}`,onVmCheck:this.onPlaybackRateSelect.bind(this)},this.playbackRates.map(e=>g("vm-menu-radio",{label:t(e),value:`${e}`}))))}onPlaybackQualitySelect(t){const e=t.target;this.dispatch("playbackQuality",e.value)}buildPlaybackQualitySubmenu(){var t;if(this.playbackQualities.length<=1||!this.canSetPlaybackQuality)return g("vm-menu-item",{label:this.i18n.playbackQuality,hint:(t=this.playbackQuality)!==null&&t!==void 0?t:this.i18n.auto});const e=i=>{const n=parseInt(i.slice(0,-1),10);if(n>=2160)return"UHD";if(n>=1080)return"HD"};return g("vm-submenu",{label:this.i18n.playbackQuality,hint:this.playbackQuality},g("vm-menu-radio-group",{value:this.playbackQuality,onVmCheck:this.onPlaybackQualitySelect.bind(this)},this.playbackQualities.map(i=>g("vm-menu-radio",{label:i,value:i,badge:e(i)}))))}onTextTrackSelect(t){const e=t.target,i=parseInt(e.value,10),n=fi(this);if(i===-1){n==null||n.setTextTrackVisibility(!1);return}n==null||n.setTextTrackVisibility(!0),n==null||n.setCurrentTextTrack(i)}buildTextTracksSubmenu(){var t,e,i;return this.textTracks.length<=1||!this.canSetTextTrack?g("vm-menu-item",{label:this.i18n.subtitlesOrCc,hint:(e=(t=this.textTracks[this.currentTextTrack])===null||t===void 0?void 0:t.label)!==null&&e!==void 0?e:this.i18n.none}):g("vm-submenu",{label:this.i18n.subtitlesOrCc,hint:this.isTextTrackVisible?(i=this.textTracks[this.currentTextTrack])===null||i===void 0?void 0:i.label:this.i18n.off},g("vm-menu-radio-group",{value:`${this.isTextTrackVisible?this.currentTextTrack:-1}`,onVmCheck:this.onTextTrackSelect.bind(this)},[g("vm-menu-radio",{label:this.i18n.off,value:"-1"})].concat(this.textTracks.map((n,s)=>g("vm-menu-radio",{label:n.label,value:`${s}`})))))}onAudioTrackSelect(t){const e=t.target,i=parseInt(e.value,10),n=fi(this);n==null||n.setCurrentAudioTrack(i)}buildAudioTracksMenu(){var t,e,i;return this.audioTracks.length<=1||!this.canSetAudioTrack?g("vm-menu-item",{label:this.i18n.audio,hint:(e=(t=this.audioTracks[this.currentAudioTrack])===null||t===void 0?void 0:t.label)!==null&&e!==void 0?e:this.i18n.default}):g("vm-submenu",{label:this.i18n.audio,hint:(i=this.audioTracks[this.currentAudioTrack])===null||i===void 0?void 0:i.label},g("vm-menu-radio-group",{value:`${this.currentAudioTrack}`,onVmCheck:this.onAudioTrackSelect.bind(this)},this.audioTracks.map((n,s)=>g("vm-menu-radio",{label:n.label,value:`${s}`}))))}render(){return g("vm-settings",{pin:this.pin},this.buildAudioTracksMenu(),this.buildPlaybackRateSubmenu(),this.buildPlaybackQualitySubmenu(),this.isVideoView&&this.buildTextTracksSubmenu(),g("slot",null))}static get watchers(){return{playbackReady:["onPlaybackReady","onAudioTracksChange","onTextTracksChange"],audioTracks:["onAudioTracksChange"],textTracks:["onTextTracksChange"]}}static get style(){return rP}},aP=":host{display:contents;pointer-events:none}",lP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.noClickToPlay=!1,this.noDblClickFullscreen=!1,this.noCaptions=!1,this.noPoster=!1,this.noSpinner=!1,this.noControls=!1,this.noSettings=!1,this.noLoadingScreen=!1,X(this)}render(){return g("vm-ui",null,!this.noClickToPlay&&g("vm-click-to-play",null),!this.noDblClickFullscreen&&g("vm-dbl-click-fullscreen",null),!this.noCaptions&&g("vm-captions",null),!this.noPoster&&g("vm-poster",null),!this.noSpinner&&g("vm-spinner",null),!this.noLoadingScreen&&g("vm-loading-screen",null),!this.noControls&&g("vm-default-controls",null),!this.noSettings&&g("vm-default-settings",null),g("slot",null))}static get style(){return aP}};class ld{constructor(e,i,n){var s;this.el=e,this.attributes=i,this.onLoad=n,this.hasLoaded=!1,!Mt(this.el)&&(this.intersectionObs=this.canObserveIntersection()?new IntersectionObserver(this.onIntersection.bind(this)):void 0,this.mutationObs=this.canObserveMutations()?new MutationObserver(this.onMutation.bind(this)):void 0,(s=this.mutationObs)===null||s===void 0||s.observe(this.el,{childList:!0,subtree:!0,attributeFilter:this.attributes}),this.lazyLoad())}didLoad(){return this.hasLoaded}destroy(){var e,i;(e=this.intersectionObs)===null||e===void 0||e.disconnect(),(i=this.mutationObs)===null||i===void 0||i.disconnect()}canObserveIntersection(){return Rt&&window.IntersectionObserver}canObserveMutations(){return Rt&&window.MutationObserver}lazyLoad(){var e;this.canObserveIntersection()?(e=this.intersectionObs)===null||e===void 0||e.observe(this.el):this.load()}onIntersection(e){e.forEach(i=>{(i.intersectionRatio>0||i.isIntersecting)&&(this.load(),this.intersectionObs.unobserve(i.target))})}onMutation(){this.hasLoaded&&this.load()}getLazyElements(){return(Mt(this.el.shadowRoot)?this.el:this.el.shadowRoot).querySelectorAll(".lazy")}load(){window.requestAnimationFrame(()=>{this.getLazyElements().forEach(this.loadEl.bind(this))})}loadEl(e){var i,n;(i=this.intersectionObs)===null||i===void 0||i.unobserve(e),this.hasLoaded=!0,(n=this.onLoad)===null||n===void 0||n.call(this,e)}}const cP=":host{z-index:var(--vm-media-z-index)}iframe{position:absolute;top:0;left:0;border:0;width:100%;height:100%;user-select:none}";var uP=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};let Pm=0;const Xo=new Set,hP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmEmbedSrcChange=R(this,"vmEmbedSrcChange",3),this.vmEmbedMessage=R(this,"vmEmbedMessage",3),this.vmEmbedLoaded=R(this,"vmEmbedLoaded",3),this.srcWithParams="",this.hasEnteredViewport=!1,this.embedSrc="",this.mediaTitle="",this.params="",this.preconnections=[],X(this)}onEmbedSrcChange(){this.srcWithParams=_t(this.embedSrc)&&this.embedSrc.length>0?QA(this.embedSrc,this.params):void 0}srcWithParamsChange(){if(N(this.srcWithParams)){this.vmEmbedSrcChange.emit(this.srcWithParams);return}!this.hasEnteredViewport&&!Xo.has(this.embedSrc)&&Am(this.srcWithParams)&&Xo.add(this.embedSrc),this.vmEmbedSrcChange.emit(this.srcWithParams)}preconnectionsChange(){this.hasEnteredViewport||this.preconnections.filter(t=>!Xo.has(t)).forEach(t=>{Am(t)&&Xo.add(t)})}connectedCallback(){this.lazyLoader=new ld(this.host,["data-src"],t=>{const e=t.getAttribute("data-src");t.removeAttribute("src"),Li(e)||t.setAttribute("src",e)}),this.onEmbedSrcChange(),this.genIframeId()}disconnectedCallback(){this.lazyLoader.destroy()}onWindowMessage(t){var e,i,n;if(!(t.source===((e=this.iframe)===null||e===void 0?void 0:e.contentWindow)&&(!_t(this.origin)||this.origin===t.origin)))return;const r=(n=(i=this.decoder)===null||i===void 0?void 0:i.call(this,t.data))!==null&&n!==void 0?n:t.data;r&&this.vmEmbedMessage.emit(r)}postMessage(t,e){var i,n;return uP(this,void 0,void 0,function*(){(n=(i=this.iframe)===null||i===void 0?void 0:i.contentWindow)===null||n===void 0||n.postMessage(JSON.stringify(t),e!=null?e:"*")})}onLoad(){this.vmEmbedLoaded.emit()}genIframeId(){Pm+=1,this.id=`vm-iframe-${Pm}`}render(){return g("iframe",{id:this.id,class:"lazy",title:this.mediaTitle,"data-src":this.srcWithParams,allowFullScreen:!0,allow:"autoplay; encrypted-media; picture-in-picture;",onLoad:this.onLoad.bind(this),ref:t=>{this.iframe=t}})}get host(){return this}static get watchers(){return{embedSrc:["onEmbedSrcChange"],params:["onEmbedSrcChange"],srcWithParams:["srcWithParamsChange"],preconnections:["preconnectionsChange"]}}static get style(){return cP}},dP=":host{display:flex;align-items:center;justify-content:center}",fP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.duration=-1,this.i18n={},this.alwaysShowHours=!1,X(this),me(this,["duration","i18n"])}render(){return g("vm-time",{label:this.i18n.duration,seconds:Math.max(0,this.duration),alwaysShowHours:this.alwaysShowHours})}static get style(){return dP}};var Ot={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},Rm=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],xm=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],Dm=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],Dt=typeof window!="undefined"&&typeof window.document!="undefined"?window.document:{},Wt="fullscreenEnabled"in Dt&&Object.keys(Ot)||Rm[0]in Dt&&Rm||xm[0]in Dt&&xm||Dm[0]in Dt&&Dm||[],wn={requestFullscreen:function(t){return t[Wt[Ot.requestFullscreen]]()},requestFullscreenFunction:function(t){return t[Wt[Ot.requestFullscreen]]},get exitFullscreen(){return Dt[Wt[Ot.exitFullscreen]].bind(Dt)},get fullscreenPseudoClass(){return":"+Wt[Ot.fullscreen]},addEventListener:function(t,e,i){return Dt.addEventListener(Wt[Ot[t]],e,i)},removeEventListener:function(t,e,i){return Dt.removeEventListener(Wt[Ot[t]],e,i)},get fullscreenEnabled(){return Boolean(Dt[Wt[Ot.fullscreenEnabled]])},set fullscreenEnabled(t){},get fullscreenElement(){return Dt[Wt[Ot.fullscreenElement]]},set fullscreenElement(t){},get onfullscreenchange(){return Dt[("on"+Wt[Ot.fullscreenchange]).toLowerCase()]},set onfullscreenchange(t){return Dt[("on"+Wt[Ot.fullscreenchange]).toLowerCase()]=t},get onfullscreenerror(){return Dt[("on"+Wt[Ot.fullscreenerror]).toLowerCase()]},set onfullscreenerror(t){return Dt[("on"+Wt[Ot.fullscreenerror]).toLowerCase()]=t}};function i0(t){return{all:t=t||new Map,on:function(e,i){var n=t.get(e);n?n.push(i):t.set(e,[i])},off:function(e,i){var n=t.get(e);n&&(i?n.splice(n.indexOf(i)>>>0,1):t.set(e,[]))},emit:function(e,i){var n=t.get(e);n&&n.slice().map(function(s){s(i)}),(n=t.get("*"))&&n.slice().map(function(s){s(e,i)})}}}var pr=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};class n0{constructor(e){this.host=e,this.disposal=new st,this.emitter=i0()}get isSupported(){return this.isSupportedNatively}get isSupportedNatively(){return wn.fullscreenEnabled}get isFullscreen(){return this.isNativeFullscreen}get isNativeFullscreen(){if(wn.fullscreenElement===this.host)return!0;try{return this.host.matches(wn.fullscreenPseudoClass)}catch{return!1}}on(e,i){this.emitter.on(e,i)}off(e,i){this.emitter.off(e,i)}destroy(){return pr(this,void 0,void 0,function*(){this.isFullscreen&&(yield this.exitFullscreen()),this.disposal.empty(),this.emitter.all.clear()})}addFullscreenChangeEventListener(e){return this.isSupported?xe(wn,"fullscreenchange",e):ri}addFullscreenErrorEventListener(e){return this.isSupported?xe(wn,"fullscreenerror",e):ri}requestFullscreen(){return pr(this,void 0,void 0,function*(){if(!this.isFullscreen)return this.throwIfNoFullscreenSupport(),this.disposal.add(this.addFullscreenChangeEventListener(this.handleFullscreenChange.bind(this))),this.disposal.add(this.addFullscreenErrorEventListener(this.handleFullscreenError.bind(this))),this.makeEnterFullscreenRequest()})}makeEnterFullscreenRequest(){return pr(this,void 0,void 0,function*(){return wn.requestFullscreen(this.host)})}handleFullscreenChange(){this.isFullscreen||this.disposal.empty(),this.emitter.emit("change",this.isFullscreen)}handleFullscreenError(e){this.emitter.emit("error",e)}exitFullscreen(){return pr(this,void 0,void 0,function*(){if(!!this.isFullscreen)return this.throwIfNoFullscreenSupport(),this.makeExitFullscreenRequest()})}makeExitFullscreenRequest(){return pr(this,void 0,void 0,function*(){return wn.exitFullscreen()})}throwIfNoFullscreenSupport(){if(!this.isSupported)throw Error("Fullscreen API is not enabled or supported in this environment.")}}var Mm=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};class mP extends n0{constructor(e,i){super(e),this.host=e,this.presentationController=i}get isFullscreen(){return this.presentationController.isFullscreenMode}get isSupported(){return this.presentationController.isSupported}makeEnterFullscreenRequest(){return Mm(this,void 0,void 0,function*(){return this.presentationController.setPresentationMode("fullscreen")})}makeExitFullscreenRequest(){return Mm(this,void 0,void 0,function*(){return this.presentationController.setPresentationMode("inline")})}addFullscreenChangeEventListener(){return this.isSupported?(this.presentationController.on("change",this.handlePresentationModeChange.bind(this)),()=>{this.presentationController.off("change",this.handlePresentationModeChange.bind(this))}):ri}handlePresentationModeChange(){this.handleFullscreenChange()}addFullscreenErrorEventListener(){return ri}}var pP=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};class gP{constructor(e){this.host=e,this.disposal=new st,this.emitter=i0();const i=e.disconnectedCallback;e.disconnectedCallback=()=>pP(this,void 0,void 0,function*(){yield this.destroy(),i==null||i.call(e)})}get videoElement(){var e;if(((e=this.host.mediaEl)===null||e===void 0?void 0:e.tagName.toLowerCase())==="video")return this.host.mediaEl}get presentationMode(){var e;return(e=this.videoElement)===null||e===void 0?void 0:e.webkitPresentationMode}get isInlineMode(){return this.presentationMode==="inline"}get isPictureInPictureMode(){return this.presentationMode==="inline"}get isFullscreenMode(){return this.presentationMode==="fullscreen"}get isSupported(){var e,i,n;return js&&Tu((e=this.videoElement)===null||e===void 0?void 0:e.webkitSetPresentationMode)&&((n=(i=this.videoElement)===null||i===void 0?void 0:i.webkitSupportsFullscreen)!==null&&n!==void 0?n:!1)}setPresentationMode(e){var i,n;(n=(i=this.videoElement)===null||i===void 0?void 0:i.webkitSetPresentationMode)===null||n===void 0||n.call(i,e)}on(e,i){this.emitter.on(e,i)}off(e,i){this.emitter.off(e,i)}destroy(){this.setPresentationMode("inline"),this.disposal.empty()}addPresentationModeChangeEventListener(){return!this.isSupported||Mt(this.videoElement)?ri:xe(this.videoElement,"webkitpresentationmodechanged",this.handlePresentationModeChange.bind(this))}handlePresentationModeChange(){this.emitter.emit("change",this.presentationMode)}}const vP="audio.sc-vm-file,video.sc-vm-file{border-radius:inherit;vertical-align:middle;width:100%;outline:0}video.sc-vm-file{position:absolute;top:0;left:0;border:0;height:100%;user-select:none}";var Ct=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const yP=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.vmLoadStart=R(this,"vmLoadStart",7),this.vmError=R(this,"vmError",7),this.vmMediaElChange=R(this,"vmMediaElChange",7),this.vmSrcSetChange=R(this,"vmSrcSetChange",7),this.textTracksDisposal=new st,this.wasPausedBeforeSeeking=!0,this.currentSrcSet=[],this.mediaQueryDisposal=new st,this.willAttach=!1,this.preload="metadata",this.playbackRates=[.25,.5,.75,1,1.25,1.5,2],this.language="en",this.autoplay=!1,this.controls=!1,this.loop=!1,this.muted=!1,this.playsinline=!1,this.noConnect=!1,this.paused=!0,this.currentTime=0,this.volume=0,this.playbackReady=!1,this.playbackStarted=!1,this.presentationController=new gP(this),this.fullscreenController=new mP(this,this.presentationController),this.currentTextTrack=-1,this.hasCustomTextManager=!1,this.isTextTrackVisible=!0,this.shouldRenderNativeTextTracks=!0,X(this),fn(this),Bl(this,["playbackReady","playbackStarted","currentTime","volume","paused","currentTextTrack","isTextTrackVisible","shouldRenderNativeTextTracks"]),Wy(this,"vm-poster",t=>{[this.vmPoster]=t})}onMediaTitleChange(){this.dispatch("mediaTitle",this.mediaTitle)}onPosterChange(){var t;this.playbackStarted||(t=this.mediaEl)===null||t===void 0||t.load()}onViewTypeChange(){this.dispatch("viewType",this.viewType)}connectedCallback(){this.initLazyLoader(),this.dispatch=zs(this),this.onViewTypeChange(),this.onPosterChange(),this.onMediaTitleChange(),this.addPresentationControllerListeners()}componentDidRender(){this.prevMediaEl!==this.mediaEl&&(this.prevMediaEl=this.mediaEl,this.vmMediaElChange.emit(this.mediaEl),this.presentationController.addPresentationModeChangeEventListener())}componentDidLoad(){this.onViewTypeChange()}disconnectedCallback(){var t;this.mediaQueryDisposal.empty(),this.textTracksDisposal.empty(),this.cancelTimeUpdates(),(t=this.lazyLoader)===null||t===void 0||t.destroy(),this.wasPausedBeforeSeeking=!0}initLazyLoader(){this.lazyLoader=new ld(this.host,["data-src","data-poster"],()=>{if(Mt(this.mediaEl))return;const t=this.mediaEl.getAttribute("data-poster");Li(t)||this.mediaEl.setAttribute("poster",t),this.refresh(),this.didSrcSetChange()})}refresh(){if(Mt(this.mediaEl))return;const{children:t}=this.mediaEl;for(let e=0;e<=t.length-1;e+=1){const i=t[e],n=i.getAttribute("data-src")||i.getAttribute("src")||i.getAttribute("data-vs");i.removeAttribute("src"),!Li(n)&&(i.setAttribute("data-vs",n),i.setAttribute("src",n))}}didSrcSetChange(){if(Mt(this.mediaEl))return;const e=Array.from(this.mediaEl.querySelectorAll("source")).map(n=>{var s;return{src:n.getAttribute("data-vs"),media:(s=n.getAttribute("data-media"))!==null&&s!==void 0?s:void 0,ref:n}});(this.currentSrcSet.length!==e.length||e.some((n,s)=>this.currentSrcSet[s].src!==n.src))&&(this.currentSrcSet=e,this.onSrcSetChange())}onSrcSetChange(){var t;this.textTracksDisposal.empty(),this.mediaQueryDisposal.empty(),this.vmLoadStart.emit(),this.vmSrcSetChange.emit(this.currentSrcSet),this.willAttach||(t=this.mediaEl)===null||t===void 0||t.load()}hasCustomPoster(){return!js&&!N(this.vmPoster)}cancelTimeUpdates(){Pi(this.timeRAF)&&window.cancelAnimationFrame(this.timeRAF),this.timeRAF=void 0}requestTimeUpdates(){var t,e;this.dispatch("currentTime",(e=(t=this.mediaEl)===null||t===void 0?void 0:t.currentTime)!==null&&e!==void 0?e:0),this.timeRAF=window.requestAnimationFrame(()=>{this.requestTimeUpdates()})}getMediaType(){const{currentSrc:t}=this.mediaEl;if(Eu.test(t))return oi.Audio;if(_m.test(t)||Su.test(t))return oi.Video}onLoadedMetadata(){this.mediaEl.volume=this.volume/100,this.listenToTextTracksForChanges(),this.onTextTracksChange(),this.onProgress(),this.dispatch("currentPoster",this.poster),this.dispatch("duration",this.mediaEl.duration),this.dispatch("playbackRates",this.playbackRates),this.willAttach||(this.dispatch("currentSrc",this.mediaEl.currentSrc),this.dispatch("mediaType",this.getMediaType()),this.dispatch("playbackReady",!0))}onProgress(){const{buffered:t,duration:e}=this.mediaEl,i=t.length===0?0:t.end(t.length-1);this.dispatch("buffered",i>e?e:i)}onPlay(){this.requestTimeUpdates(),this.dispatch("paused",!1),this.playbackStarted||this.dispatch("playbackStarted",!0)}onPause(){this.cancelTimeUpdates(),this.dispatch("paused",!0),this.dispatch("buffering",!1)}onPlaying(){this.dispatch("playing",!0),this.dispatch("buffering",!1)}onSeeking(){this.wasPausedBeforeSeeking||(this.wasPausedBeforeSeeking=this.mediaEl.paused),this.dispatch("currentTime",this.mediaEl.currentTime),this.dispatch("seeking",!0)}onSeeked(){this.currentTime===0&&!this.playbackStarted||(this.dispatch("seeking",!1),(!this.playbackStarted||!this.wasPausedBeforeSeeking)&&this.attemptToPlay(),this.wasPausedBeforeSeeking=!0)}onRateChange(){this.dispatch("playbackRate",this.mediaEl.playbackRate)}onVolumeChange(){this.dispatch("muted",this.mediaEl.muted),this.dispatch("volume",this.mediaEl.volume*100)}onDurationChange(){this.dispatch("duration",this.mediaEl.duration)}onWaiting(){this.dispatch("buffering",!0)}onSuspend(){this.dispatch("buffering",!1)}onEnded(){this.loop||this.dispatch("playbackEnded",!0)}onError(){this.vmError.emit(this.mediaEl.error)}attemptToPlay(){var t;try{(t=this.mediaEl)===null||t===void 0||t.play()}catch(e){this.vmError.emit(e)}}togglePiPInChrome(t){var e;return t?(e=this.mediaEl)===null||e===void 0?void 0:e.requestPictureInPicture():document.exitPictureInPicture()}togglePiPInSafari(t){var e,i;const n=t?"picture-in-picture":"inline";if(!(!((e=this.mediaEl)===null||e===void 0)&&e.webkitSupportsPresentationMode(n)))throw new Error("PiP API is not available.");return(i=this.mediaEl)===null||i===void 0?void 0:i.webkitSetPresentationMode(n)}togglePiP(t){return Ct(this,void 0,void 0,function*(){if(Xy())return this.togglePiPInChrome(t);if(Zy())return this.togglePiPInSafari(t);throw new Error("PiP API is not available.")})}onEnterPiP(){this.dispatch("isPiPActive",!0)}onLeavePiP(){this.dispatch("isPiPActive",!1)}addPresentationControllerListeners(){this.presentationController.on("change",t=>{this.dispatch("isPiPActive",t==="picture-in-picture"),this.dispatch("isFullscreenActive",t==="fullscreen")})}getAdapter(){return Ct(this,void 0,void 0,function*(){return{getInternalPlayer:()=>Ct(this,void 0,void 0,function*(){return this.mediaEl}),play:()=>Ct(this,void 0,void 0,function*(){var t;return(t=this.mediaEl)===null||t===void 0?void 0:t.play()}),pause:()=>Ct(this,void 0,void 0,function*(){var t;return(t=this.mediaEl)===null||t===void 0?void 0:t.pause()}),canPlay:t=>Ct(this,void 0,void 0,function*(){return _t(t)&&(Eu.test(t)||_m.test(t))}),setCurrentTime:t=>Ct(this,void 0,void 0,function*(){this.mediaEl&&(this.mediaEl.currentTime=t)}),setMuted:t=>Ct(this,void 0,void 0,function*(){this.mediaEl&&(this.mediaEl.muted=t)}),setVolume:t=>Ct(this,void 0,void 0,function*(){this.mediaEl&&(this.mediaEl.volume=t/100)}),canSetPlaybackRate:()=>Ct(this,void 0,void 0,function*(){return!0}),setPlaybackRate:t=>Ct(this,void 0,void 0,function*(){this.mediaEl&&(this.mediaEl.playbackRate=t)}),canSetPiP:()=>Ct(this,void 0,void 0,function*(){return HA()}),enterPiP:()=>this.togglePiP(!0),exitPiP:()=>this.togglePiP(!1),canSetFullscreen:()=>Ct(this,void 0,void 0,function*(){return this.fullscreenController.isSupported}),enterFullscreen:()=>this.fullscreenController.requestFullscreen(),exitFullscreen:()=>this.fullscreenController.exitFullscreen(),setCurrentTextTrack:t=>Ct(this,void 0,void 0,function*(){t!==this.currentTextTrack&&this.toggleTextTrackModes(t)}),setTextTrackVisibility:t=>Ct(this,void 0,void 0,function*(){this.isTextTrackVisible=t,this.toggleTextTrackModes(this.currentTextTrack)})}})}onHasCustomTextManagerChange(){this.hasCustomTextManager?this.textTracksDisposal.empty():this.playbackReady&&this.listenToTextTracksForChanges()}onShouldRenderNativeTextTracksChange(){this.hasCustomTextManager||this.toggleTextTrackModes(this.currentTextTrack)}onProviderConnect(t){this.noConnect&&t.stopImmediatePropagation()}onProviderDisconnect(t){this.noConnect&&t.stopImmediatePropagation()}getFilteredTextTracks(){const t=[],e=Array.from(this.mediaEl.textTracks);for(let i=0;i<e.length;i+=1){const n=e[i];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&t.push(e[i])}return t}listenToTextTracksForChanges(){this.hasCustomTextManager||(this.textTracksDisposal.empty(),!N(this.mediaEl)&&this.textTracksDisposal.add(xe(this.mediaEl.textTracks,"change",this.onTextTracksChange.bind(this))))}onTextTracksChange(){var t;const e=this.getFilteredTextTracks();let i=-1;for(let n=0;n<e.length;n+=1)if(e[n].mode==="hidden")i=n;else if(e[n].mode==="showing"){i=n;break}if(!this.shouldRenderNativeTextTracks&&((t=e[i])===null||t===void 0?void 0:t.mode)==="showing"){e[i].mode="hidden";return}this.shouldRenderNativeTextTracks&&(this.isTextTrackVisible=i!==-1&&e[i].mode==="showing",this.dispatch("isTextTrackVisible",this.isTextTrackVisible)),this.dispatch("textTracks",e),this.dispatch("currentTextTrack",this.shouldRenderNativeTextTracks&&!this.isTextTrackVisible?-1:i)}toggleTextTrackModes(t){if(Mt(this.mediaEl))return;const{textTracks:e}=this.mediaEl;if(t===-1)Array.from(e).forEach(n=>{n.mode="disabled"});else{const n=e[this.currentTextTrack];n&&(n.mode="disabled")}const i=e[t];i&&(i.mode=this.isTextTrackVisible&&this.shouldRenderNativeTextTracks?"showing":"hidden"),this.dispatch("currentTextTrack",this.shouldRenderNativeTextTracks&&!this.isTextTrackVisible?-1:t),this.dispatch("isTextTrackVisible",this.isTextTrackVisible)}render(){const t={autoplay:this.autoplay,muted:this.muted,playsinline:this.playsinline,playsInline:this.playsinline,"x5-playsinline":this.playsinline,"webkit-playsinline":this.playsinline,controls:this.controls,crossorigin:this.crossOrigin===""?"anonymous":this.crossOrigin,controlslist:this.controlsList,"data-poster":this.hasCustomPoster()?void 0:this.poster,loop:this.loop,preload:this.preload,disablePictureInPicture:this.disablePiP,autoPictureInPicture:this.autoPiP,disableRemotePlayback:this.disableRemotePlayback,"x-webkit-airplay":this.disableRemotePlayback?"deny":"allow",ref:n=>{this.mediaEl=n},onLoadedMetadata:this.onLoadedMetadata.bind(this),onProgress:this.onProgress.bind(this),onPlay:this.onPlay.bind(this),onPause:this.onPause.bind(this),onPlaying:this.onPlaying.bind(this),onSeeking:this.onSeeking.bind(this),onSeeked:this.onSeeked.bind(this),onRateChange:this.onRateChange.bind(this),onVolumeChange:this.onVolumeChange.bind(this),onDurationChange:this.onDurationChange.bind(this),onWaiting:this.onWaiting.bind(this),onSuspend:this.onSuspend.bind(this),onEnded:this.onEnded.bind(this),onError:this.onError.bind(this)},e=g("audio",Object.assign({class:"lazy"},t),g("slot",null),"Your browser does not support the",g("code",null,"audio"),"element."),i=g("video",Object.assign({class:"lazy"},t,{onenterpictureinpicture:this.onEnterPiP.bind(this),onleavepictureinpicture:this.onLeavePiP.bind(this)}),g("slot",null),"Your browser does not support the",g("code",null,"video"),"element.");return this.viewType===zt.Audio?e:i}get host(){return this}static get watchers(){return{mediaTitle:["onMediaTitleChange"],poster:["onPosterChange"],viewType:["onViewTypeChange"],hasCustomTextManager:["onHasCustomTextManagerChange"],shouldRenderNativeTextTracks:["onShouldRenderNativeTextTracksChange"]}}static get style(){return vP}},bP=":host([hidden]){display:none}";var wP=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const kP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.canSetFullscreen=!1,this.enterIcon="fullscreen-enter",this.exitIcon="fullscreen-exit",this.tooltipPosition="top",this.hideTooltip=!1,this.keys="f",this.isFullscreenActive=!1,this.i18n={},this.playbackReady=!1,X(this),me(this,["isFullscreenActive","playbackReady","i18n"])}onPlaybackReadyChange(){var t;return wP(this,void 0,void 0,function*(){const e=fi(this);this.canSetFullscreen=(t=yield e==null?void 0:e.canSetFullscreen())!==null&&t!==void 0?t:!1})}componentDidLoad(){this.onPlaybackReadyChange()}onClick(){const t=fi(this);this.isFullscreenActive?t==null||t.exitFullscreen():t==null||t.enterFullscreen()}render(){const t=this.isFullscreenActive?this.i18n.exitFullscreen:this.i18n.enterFullscreen,e=N(this.keys)?t:`${t} (${this.keys})`;return g(Bs,{hidden:!this.canSetFullscreen},g("vm-control",{label:this.i18n.fullscreen,keys:this.keys,pressed:this.isFullscreenActive,hidden:!this.canSetFullscreen,onClick:this.onClick.bind(this)},g("vm-icon",{name:this.isFullscreenActive?this.exitIcon:this.enterIcon,library:this.icons}),g("vm-tooltip",{hidden:this.hideTooltip,position:this.tooltipPosition,direction:this.tooltipDirection},e)))}static get watchers(){return{playbackReady:["onPlaybackReadyChange"]}}static get style(){return bP}};var ci=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const TP=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.vmLoadStart=R(this,"vmLoadStart",7),this.vmError=R(this,"vmError",7),this.hasAttached=!1,this.version="latest",this.preload="metadata",this.playbackReady=!1,X(this),fn(this),me(this,["playbackReady"])}connectedCallback(){this.dispatch=zs(this),this.mediaEl&&this.setupHls()}disconnectedCallback(){this.destroyHls()}get src(){if(Mt(this.videoProvider))return;const t=this.videoProvider.querySelectorAll("source"),e=Array.from(t).find(i=>Su.test(i.src)||rA.test(i.type));return e==null?void 0:e.src}setupHls(){return ci(this,void 0,void 0,function*(){if(!!N(this.hls))try{const t=this.libSrc||`https://cdn.jsdelivr.net/npm/hls.js@${this.version}/dist/hls.min.js`,e=yield t0(t,"Hls");if(!e.isSupported()){this.vmError.emit("hls.js is not supported");return}this.hls=new e(this.config),this.hls.on(e.Events.MEDIA_ATTACHED,()=>{this.hasAttached=!0,this.onSrcChange()}),this.hls.on(e.Events.AUDIO_TRACKS_UPDATED,()=>{this.dispatch("audioTracks",this.hls.audioTracks),this.dispatch("currentAudioTrack",this.hls.audioTrack)}),this.hls.on(e.Events.AUDIO_TRACK_SWITCHED,()=>{this.dispatch("currentAudioTrack",this.hls.audioTrack)}),this.hls.on(e.Events.ERROR,(i,n)=>{if(n.fatal)switch(n.type){case e.ErrorTypes.NETWORK_ERROR:this.hls.startLoad();break;case e.ErrorTypes.MEDIA_ERROR:this.hls.recoverMediaError();break;default:this.destroyHls();break}this.vmError.emit({event:i,data:n})}),this.hls.on(e.Events.MANIFEST_PARSED,()=>{this.dispatch("mediaType",oi.Video),this.dispatch("currentSrc",this.src),this.dispatchLevels()}),this.hls.on(e.Events.LEVEL_LOADED,(i,n)=>{this.playbackReady||(this.dispatch("duration",n.details.totalduration),this.dispatch("playbackReady",!0))}),this.hls.attachMedia(this.mediaEl)}catch(t){this.vmError.emit(t)}})}dispatchLevels(){!this.hls.levels||this.hls.levels.length===0||(this.dispatch("playbackQualities",["Auto",...this.hls.levels.map(this.levelToPlaybackQuality)]),this.dispatch("playbackQuality","Auto"))}levelToPlaybackQuality(t){return t===-1?"Auto":`${t.height}p`}findLevelIndexFromQuality(t){return this.hls.levels.findIndex(e=>this.levelToPlaybackQuality(e)===t)}destroyHls(){var t;(t=this.hls)===null||t===void 0||t.destroy(),this.hasAttached=!1}onMediaElChange(t){return ci(this,void 0,void 0,function*(){this.destroyHls(),!N(t.detail)&&(this.mediaEl=t.detail,setTimeout(()=>ci(this,void 0,void 0,function*(){yield this.setupHls()}),50))})}onSrcChange(){var t;return ci(this,void 0,void 0,function*(){this.hasAttached&&this.hls.url!==this.src&&(this.vmLoadStart.emit(),(t=this.hls)===null||t===void 0||t.loadSource(this.src))})}getAdapter(){var t,e;return ci(this,void 0,void 0,function*(){const i=(e=yield(t=this.videoProvider)===null||t===void 0?void 0:t.getAdapter())!==null&&e!==void 0?e:{},n=i.canPlay;return Object.assign(Object.assign({},i),{getInternalPlayer:()=>ci(this,void 0,void 0,function*(){return this.hls}),canPlay:s=>ci(this,void 0,void 0,function*(){var r;return _t(s)&&Su.test(s)||((r=n==null?void 0:n(s))!==null&&r!==void 0?r:!1)}),canSetPlaybackQuality:()=>ci(this,void 0,void 0,function*(){var s,r;return((r=(s=this.hls)===null||s===void 0?void 0:s.levels)===null||r===void 0?void 0:r.length)>0}),setPlaybackQuality:s=>ci(this,void 0,void 0,function*(){N(this.hls)||(this.hls.currentLevel=this.findLevelIndexFromQuality(s),this.dispatch("playbackQuality",s))}),setCurrentAudioTrack:s=>ci(this,void 0,void 0,function*(){N(this.hls)||(this.hls.audioTrack=s)})})})}render(){return g("vm-video",{willAttach:!0,crossOrigin:this.crossOrigin,preload:this.preload,poster:this.poster,controlsList:this.controlsList,autoPiP:this.autoPiP,disablePiP:this.disablePiP,disableRemotePlayback:this.disableRemotePlayback,mediaTitle:this.mediaTitle,ref:t=>{this.videoProvider=t}},g("slot",null))}},Lm="https://cdn.jsdelivr.net/npm/@vime/core@latest/icons",cd=new Map(Object.entries({vime:t=>`${Lm}/vime/vm-${t}.svg`,material:t=>`${Lm}/material/md-${t}.svg`})),Iu=new Set;function _P(t){const e=Ye(t);Nt(t,()=>{Iu.add(e)},()=>{Iu.delete(e)})}const CP=t=>cd.get(t);function EP(t,e){N(e)||cd.set(t,e),Iu.forEach(i=>{i.library===t&&i.redraw()})}function SP(t){cd.delete(t)}var IP=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const Mc=new Map,AP=t=>{if(Mc.has(t))return Mc.get(t);const e=fetch(t).then(i=>IP(void 0,void 0,void 0,function*(){if(i.ok){const n=document.createElement("div");n.innerHTML=yield i.text();const s=n.firstElementChild;return{ok:i.ok,status:i.status,svg:s&&s.tagName.toLowerCase()==="svg"?s.outerHTML:""}}return{ok:i.ok,status:i.status}}));return Mc.set(t,e),e},PP=":host{display:inline-block;width:1em;height:1em;contain:strict;box-sizing:content-box !important}.icon,svg{display:block;height:100%;width:100%;transition:var(--vm-icon-transition);transform:var(--vm-icon-transform);fill:var(--vm-icon-fill, currentColor);stroke:var(--vm-icon-stroke)}";var Nm=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const RP=new DOMParser,xP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmLoad=R(this,"vmLoad",7),this.vmError=R(this,"vmError",7),this.icons="material",X(this),_P(this)}handleChange(){this.setIcon()}connectedCallback(){me(this,["icons"])}componentDidLoad(){this.setIcon()}redraw(){return Nm(this,void 0,void 0,function*(){this.setIcon()})}getLabel(){let t="";return this.label?t=this.label:this.name?t=this.name.replace(/-/g," "):this.src&&(t=this.src.replace(/.*\//,"").replace(/-/g," ").replace(/\.svg/i,"")),t}setIcon(){var t;return Nm(this,void 0,void 0,function*(){const e=CP((t=this.library)!==null&&t!==void 0?t:this.icons);let i=this.src;if(this.name&&e&&(i=e(this.name)),i)try{const n=yield AP(i);if(n.ok){const r=RP.parseFromString(n.svg,"text/html").body.querySelector("svg");r?(this.svg=r.outerHTML,this.vmLoad.emit()):(this.svg="",this.vmError.emit({status:n.status}))}}catch{this.vmError.emit()}})}render(){return g("div",{class:"icon",role:"img","aria-label":this.getLabel(),innerHTML:this.svg})}static get watchers(){return{name:["handleChange"],src:["handleChange"],library:["handleChange"],icons:["handleChange"]}}static get style(){return PP}},DP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.icons="material",X(this),me(this,["icons"])}handleUpdate(){this.register()}connectedCallback(){this.register()}disconnectedCallback(){N(this.name)||SP(this.name)}register(){var t;EP((t=this.name)!==null&&t!==void 0?t:this.icons,this.name?this.resolver:void 0)}get host(){return this}static get watchers(){return{name:["handleUpdate"],resolver:["handleUpdate"],icons:["handleUpdate"]}}},MP=".liveIndicator{display:flex;align-items:center;font-size:13px;font-weight:bold;letter-spacing:0.6px;color:var(--vm-control-color)}.liveIndicator.hidden{display:none}.indicator{display:inline-block;width:8px;height:8px;border-radius:50%;margin-right:4px;background-color:var(--vm-live-indicator-color, red)}",LP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.isLive=!1,this.i18n={},X(this),me(this,["isLive","i18n"])}render(){return g("div",{class:{liveIndicator:!0,hidden:!this.isLive}},g("div",{class:"indicator"}),this.i18n.live)}static get style(){return MP}},NP=`:host{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:var(--vm-loading-screen-z-index);display:flex;align-items:center;justify-content:center}.loadingScreen{opacity:100;transition:var(--vm-fade-transition)}.loadingScreen.inactive{opacity:0}.dotPulse{position:relative;left:-9999px;width:var(--vm-loading-screen-dot-size);height:var(--vm-loading-screen-dot-size);border-radius:calc(var(--vm-loading-screen-dot-size) / 2);background-color:var(--vm-loading-screen-dot-color);color:var(--vm-loading-screen-dot-color);box-shadow:9999px 0 0 calc(calc(var(--vm-loading-screen-dot-size) / 2) * -1)
    var(--vm-loading-screen-dot-color);animation:dotPulse var(--vm-loading-screen-pulse-duration) infinite linear;animation-delay:calc(var(--vm-loading-screen-pulse-duration) / 6)}.dotPulse::before,.dotPulse::after{content:'';display:inline-block;position:absolute;top:0;width:var(--vm-loading-screen-dot-size);height:var(--vm-loading-screen-dot-size);border-radius:calc(var(--vm-loading-screen-dot-size) / 2);background-color:var(--vm-loading-screen-dot-color);color:var(--vm-loading-screen-dot-color)}.dotPulse::before{box-shadow:9984px 0 0 calc(calc(var(--vm-loading-screen-dot-size) / 2) * -1)
    var(--vm-loading-screen-dot-color);animation:dotPulseBefore var(--vm-loading-screen-pulse-duration) infinite
    linear;animation-delay:0s}.dotPulse::after{box-shadow:10014px 0 0 calc(calc(var(--vm-loading-screen-dot-size) / 2) * -1)
    var(--vm-loading-screen-dot-color);animation:dotPulseAfter var(--vm-loading-screen-pulse-duration) infinite
    linear;animation-delay:calc(var(--vm-loading-screen-pulse-duration) / 3)}@keyframes dotPulseBefore{0%{box-shadow:9984px 0 0
      calc(calc(var(--vm-loading-screen-dot-size) / 2) * -1)
      var(--vm-loading-screen-dot-color)}30%{box-shadow:9984px 0 0 2px var(--vm-loading-screen-dot-color)}60%,100%{box-shadow:9984px 0 0
      calc(calc(var(--vm-loading-screen-dot-size) / 2) * -1)
      var(--vm-loading-screen-dot-color)}}@keyframes dotPulse{0%{box-shadow:9999px 0 0
      calc(calc(var(--vm-loading-screen-dot-size) / 2) * -1)
      var(--vm-loading-screen-dot-color)}30%{box-shadow:9999px 0 0 2px var(--vm-loading-screen-dot-color)}60%,100%{box-shadow:9999px 0 0
      calc(calc(var(--vm-loading-screen-dot-size) / 2) * -1)
      var(--vm-loading-screen-dot-color)}}@keyframes dotPulseAfter{0%{box-shadow:10014px 0 0
      calc(calc(var(--vm-loading-screen-dot-size) / 2) * -1)
      var(--vm-loading-screen-dot-color)}30%{box-shadow:10014px 0 0 2px var(--vm-loading-screen-dot-color)}60%,100%{box-shadow:10014px 0 0
      calc(calc(var(--vm-loading-screen-dot-size) / 2) * -1)
      var(--vm-loading-screen-dot-color)}}`,OP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.playbackReady=!1,this.hideDots=!1,X(this),me(this,["playbackReady"])}render(){return g("div",{class:{loadingScreen:!0,inactive:this.playbackReady}},g("slot",null),!this.hideDots&&g("div",{class:"dotPulse"}))}static get style(){return NP}};function VP(t){return t.tagName.toLowerCase()!=="vm-submenu"?t:t.shadowRoot.querySelector("vm-menu-item")}function FP(t){var e;if(t.tagName.toLowerCase()!=="vm-menu-radio-group")return t;const n=t.shadowRoot.querySelector("slot");return Array.from((e=n==null?void 0:n.assignedElements())!==null&&e!==void 0?e:[]).filter(r=>r.tagName.toLowerCase()==="vm-menu-radio").map(r=>r.shadowRoot.querySelector("vm-menu-item"))}function UP(t){if(N(t))return[];const e=["vm-menu-item","vm-menu-radio-group","vm-submenu"];return Array.from(t!=null?t:[]).filter(i=>e.includes(i.tagName.toLowerCase())).map(i=>VP(i)).map(i=>FP(i)).reduce((i,n)=>i.concat(n),[])}const HP=":host{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;pointer-events:none;z-index:var(--vm-menu-z-index)}:host([active]){pointer-events:auto;z-index:calc(var(--vm-menu-z-index) + 1)}.menu{position:absolute;top:0;left:0;width:100%;height:100%;box-sizing:border-box;transition:var(--vm-menu-transition)}.menu.slideIn{transform:translateX(0)}.menu[aria-hidden='true'].slideInFromLeft{transform:translateX(-100%)}.menu[aria-hidden='true'].slideInFromRight{transform:translateX(100%)}.container{display:flex;flex-direction:column;position:relative;text-align:left;width:100%;height:100%;color:var(--vm-menu-color);background:var(--vm-menu-bg);font-size:var(--vm-menu-font-size);font-weight:var(--vm-menu-font-weight)}.menu:focus{outline:0}";var gr=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const BP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmOpen=R(this,"vmOpen",7),this.vmClose=R(this,"vmClose",7),this.vmFocus=R(this,"vmFocus",7),this.vmBlur=R(this,"vmBlur",7),this.vmActiveSubmenuChange=R(this,"vmActiveSubmenuChange",7),this.vmActiveMenuItemChange=R(this,"vmActiveMenuItemChange",7),this.vmMenuHeightChange=R(this,"vmMenuHeightChange",3),this.hasDisconnected=!1,this.active=!1,X(this)}onActiveMenuitemChange(){this.vmActiveMenuItemChange.emit(this.activeMenuItem)}onActiveSubmenuChange(){this.vmActiveSubmenuChange.emit(this.activeSubmenu)}onActiveChange(){var t;this.hasDisconnected||(this.active?this.vmOpen.emit(this.host):this.vmClose.emit(this.host),((t=this.controller)===null||t===void 0?void 0:t.tagName.toLowerCase())==="vm-menu-item"&&(this.controller.expanded=!0))}connectedCallback(){this.hasDisconnected=!1}componentDidRender(){Ht(()=>{this.hasDisconnected||this.calculateHeight()})}disconnectedCallback(){this.controller=void 0,this.hasDisconnected=!0}focusMenu(){var t;return gr(this,void 0,void 0,function*(){(t=this.menu)===null||t===void 0||t.focus()})}blurMenu(){var t;return gr(this,void 0,void 0,function*(){(t=this.menu)===null||t===void 0||t.blur()})}getActiveMenuItem(){return gr(this,void 0,void 0,function*(){return this.activeMenuItem})}setActiveMenuItem(t){return gr(this,void 0,void 0,function*(){t==null||t.focusItem(),this.activeMenuItem=t})}calculateHeight(){var t,e;return gr(this,void 0,void 0,function*(){let i=0;if(this.activeSubmenu){const n=yield this.activeSubmenu.getMenu();i=(t=yield n==null?void 0:n.calculateHeight())!==null&&t!==void 0?t:0,i+=yield this.activeSubmenu.getControllerHeight()}else{const n=((e=this.container)===null||e===void 0?void 0:e.firstChild).assignedElements({flatten:!0});n==null||n.forEach(s=>{i+=parseFloat(window.getComputedStyle(s).height)})}return this.vmMenuHeightChange.emit(i),i})}onOpenSubmenu(t){t.stopPropagation(),N(this.activeSubmenu)||(this.activeSubmenu.active=!1),this.activeSubmenu=t.detail,this.getChildren().forEach(e=>{e!==this.activeSubmenu&&(e.style.opacity="0",e.style.visibility="hidden")}),Ht(()=>{this.activeSubmenu.active=!0})}onCloseSubmenu(t){t==null||t.stopPropagation(),N(this.activeSubmenu)||(this.activeSubmenu.active=!1),this.getChildren().forEach(e=>{e!==this.activeSubmenu&&(e.style.opacity="",e.style.visibility="")}),Ht(()=>{this.activeSubmenu=void 0})}onWindowClick(){this.onCloseSubmenu(),this.onClose()}onWindowKeyDown(t){this.active&&t.key==="Escape"&&(this.onCloseSubmenu(),this.onClose(),this.focusController())}getChildren(){var t;const e=(t=this.host.shadowRoot.querySelector("slot"))===null||t===void 0?void 0:t.assignedElements({flatten:!0});return e!=null?e:[]}getMenuItems(){var t;const e=(t=this.host.shadowRoot.querySelector("slot"))===null||t===void 0?void 0:t.assignedElements({flatten:!0});return UP(e)}focusController(){var t,e,i,n,s;N((t=this.controller)===null||t===void 0?void 0:t.focusItem)?N((i=this.controller)===null||i===void 0?void 0:i.focusControl)?(s=this.controller)===null||s===void 0||s.focus():(n=this.controller)===null||n===void 0||n.focusControl():(e=this.controller)===null||e===void 0||e.focusItem()}triggerMenuItem(){var t;N(this.activeMenuItem)||(this.activeMenuItem.click(),(t=this.activeMenuItem.menu)===null||t===void 0||t.focusMenu())}onClose(){this.activeMenuItem=void 0,this.active=!1}onClick(t){t.stopPropagation()}onFocus(){var t;this.active=!0,[this.activeMenuItem]=this.getMenuItems(),(t=this.activeMenuItem)===null||t===void 0||t.focusItem(),this.vmFocus.emit()}onBlur(){this.vmBlur.emit()}foucsMenuItem(t,e){e<0&&(e=t.length-1),e>t.length-1&&(e=0),this.activeMenuItem=t[e],this.activeMenuItem.focusItem()}onKeyDown(t){if(!this.active)return;t.preventDefault(),t.stopPropagation();const e=this.getMenuItems();let i=e.findIndex(n=>n===this.activeMenuItem);switch(t.key){case"Escape":this.onClose(),this.focusController();break;case"ArrowDown":case"Tab":this.foucsMenuItem(e,i+=1);break;case"ArrowUp":this.foucsMenuItem(e,i-=1);break;case"ArrowLeft":this.onClose(),this.focusController();break;case"ArrowRight":case"Enter":case" ":this.triggerMenuItem();break;case"Home":case"PageUp":this.foucsMenuItem(e,0);break;case"End":case"PageDown":this.foucsMenuItem(e,e.length-1);break}}render(){var t,e,i;return g("div",{id:this.identifier,class:{menu:!0,slideIn:!N(this.slideInDirection),slideInFromLeft:this.slideInDirection==="left",slideInFromRight:this.slideInDirection==="right"},role:"menu",tabindex:"-1","aria-labelledby":(e=(t=this.controller)===null||t===void 0?void 0:t.identifier)!==null&&e!==void 0?e:(i=this.controller)===null||i===void 0?void 0:i.id,"aria-hidden":this.active?"false":"true",onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this),onClick:this.onClick.bind(this),onKeyDown:this.onKeyDown.bind(this),ref:n=>{this.menu=n}},g("div",{class:"container",ref:n=>{this.container=n}},g("slot",null)))}get host(){return this}static get watchers(){return{activeMenuItem:["onActiveMenuitemChange"],activeSubmenu:["onActiveSubmenuChange"],active:["onActiveChange"]}}static get style(){return HP}},$P=":host{display:block}.menuItem{display:flex;position:relative;align-items:center;flex-direction:row;cursor:pointer;color:var(--vm-menu-color);background:var(--vm-menu-bg);font-size:var(--vm-menu-font-size);font-weight:var(--vm-menu-font-weight);padding:var(--vm-menu-item-padding);touch-action:manipulation;box-sizing:border-box}.menuItem:focus{outline:0}.menuItem.hidden{display:none}.menuItem.tapHighlight{background:var(--vm-menu-item-tap-highlight)}.menuItem.showDivider{border-bottom:0.5px solid var(--vm-menu-item-divider-color)}.menuItem.notTouch:hover,.menuItem.notTouch:focus{outline:0;color:var(--vm-menu-item-focus-color);background-color:var(--vm-menu-item-focus-bg)}.menuItem[aria-expanded='true']{position:absolute;z-index:2;top:0;width:100%}.menuItem[aria-hidden='true']{display:none}.menuItem[aria-checked='true'] vm-icon{opacity:1;visibility:visible}vm-icon{display:inline-block}vm-icon{fill:currentColor;pointer-events:none;font-size:var(--vm-menu-item-check-icon-size);margin-right:10px;opacity:0;visibility:hidden;transition:var(--vm-fade-transition)}.hint{display:inline-block;margin-left:auto;overflow:hidden;pointer-events:none;margin-right:6px;font-size:var(--vm-menu-item-hint-font-size);opacity:var(--vm-menu-item-hint-opacity);color:var(--vm-menu-item-hint-color)}.badge{display:inline-block;line-height:1;overflow:hidden;pointer-events:none;margin-left:6px;color:var(--vm-menu-item-badge-color);background:var(--vm-menu-item-badge-bg);font-size:var(--vm-menu-item-badge-font-size)}.spacer{flex:1}.arrow{color:var(--vm-menu-item-arrow-color);border:2px solid;padding:2px;display:inline-block;border-width:0 2px 2px 0}.arrow.left{margin-right:6px;transform:rotate(135deg)}.arrow.right{transform:rotate(-45deg);opacity:0.38}";var Lc=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const zP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmFocus=R(this,"vmFocus",7),this.vmBlur=R(this,"vmBlur",7),this.showTapHighlight=!1,this.hidden=!1,this.checkIcon="check",this.isTouch=!1,X(this),me(this,["isTouch"])}focusItem(){var t;return Lc(this,void 0,void 0,function*(){(t=this.menuItem)===null||t===void 0||t.focus()})}blurItem(){var t;return Lc(this,void 0,void 0,function*(){(t=this.menuItem)===null||t===void 0||t.blur()})}getHeight(){return Lc(this,void 0,void 0,function*(){return parseFloat(this.menuItem?window.getComputedStyle(this.menuItem).height:"0")})}onClick(){Mt(this.menu)||(this.menu.active=!this.expanded)}onFocus(){this.vmFocus.emit()}onBlur(){this.vmBlur.emit()}onTouchStart(){this.showTapHighlight=!0}onTouchEnd(){setTimeout(()=>{this.showTapHighlight=!1},100)}onMouseLeave(){var t;(t=this.menuItem)===null||t===void 0||t.blur()}render(){var t,e,i,n;const s=!N(this.checked),r=!N(this.menu),o=this.expanded?"true":"false",a=this.checked?"true":"false",l=s&&!N(this.checkIcon),u=r&&this.expanded,c=r&&!this.expanded,h=!N(this.hint)&&!s&&(!r||!this.expanded),d=!N(this.badge)&&!h&&!c,f=h||c;return g("div",{class:{menuItem:!0,notTouch:!this.isTouch,tapHighlight:this.showTapHighlight,showDivider:r&&((t=this.expanded)!==null&&t!==void 0?t:!1)},id:this.identifier,role:s?"menuitemradio":"menuitem",tabindex:"0","aria-label":this.label,"aria-hidden":this.hidden?"true":"false","aria-haspopup":r?"true":void 0,"aria-controls":(i=(e=this.menu)===null||e===void 0?void 0:e.identifier)!==null&&i!==void 0?i:(n=this.menu)===null||n===void 0?void 0:n.id,"aria-expanded":r?o:void 0,"aria-checked":s?a:void 0,onClick:this.onClick.bind(this),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this),onTouchStart:this.onTouchStart.bind(this),onTouchEnd:this.onTouchEnd.bind(this),onMouseLeave:this.onMouseLeave.bind(this),ref:p=>{this.menuItem=p}},l&&g("vm-icon",{name:this.checkIcon,library:this.icons}),u&&g("span",{class:"arrow left"}),this.label,f&&g("span",{class:"spacer"}),h&&g("span",{class:"hint"},this.hint),d&&g("span",{class:"badge"},this.badge),c&&g("span",{class:"arrow right"}))}get host(){return this}static get style(){return $P}},jP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmCheck=R(this,"vmCheck",7),this.checked=!1,this.checkIcon="check",X(this)}onClick(){this.checked=!0,this.vmCheck.emit()}render(){return g("vm-menu-item",{label:this.label,checked:this.checked,badge:this.badge,checkIcon:this.checkIcon,icons:this.icons,onClick:this.onClick.bind(this)})}},qP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmCheck=R(this,"vmCheck",7),X(this)}onValueChange(){var t;(t=this.findRadios())===null||t===void 0||t.forEach(e=>{e.checked=e.value===this.value})}connectedCallback(){this.onValueChange()}componentDidLoad(){this.onValueChange()}onSelectionChange(t){const e=t.target;this.value=e.value}findRadios(){var t;return(t=this.host.shadowRoot.querySelector("slot"))===null||t===void 0?void 0:t.assignedElements()}render(){return g("slot",null)}get host(){return this}static get watchers(){return{value:["onValueChange"]}}},WP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmFocus=R(this,"vmFocus",7),this.vmBlur=R(this,"vmBlur",7),this.lowVolumeIcon="volume-low",this.highVolumeIcon="volume-high",this.mutedIcon="volume-mute",this.tooltipPosition="top",this.hideTooltip=!1,this.keys="m",this.volume=50,this.muted=!1,this.i18n={},X(this),me(this,["muted","volume","i18n"])}connectedCallback(){this.dispatch=Ki(this)}getIcon(){const t=this.volume<50?this.lowVolumeIcon:this.highVolumeIcon;return this.muted||this.volume===0?this.mutedIcon:t}onClick(){this.dispatch("muted",!this.muted)}render(){const t=this.muted?this.i18n.unmute:this.i18n.mute,e=N(this.keys)?t:`${t} (${this.keys})`;return g("vm-control",{label:this.i18n.mute,pressed:this.muted,keys:this.keys,onClick:this.onClick.bind(this)},g("vm-icon",{name:this.getIcon(),library:this.icons}),g("vm-tooltip",{hidden:this.hideTooltip,position:this.tooltipPosition,direction:this.tooltipDirection},e))}},KP=":host([hidden]){display:none}";var GP=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const QP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.canSetPiP=!1,this.enterIcon="pip-enter",this.exitIcon="pip-exit",this.tooltipPosition="top",this.hideTooltip=!1,this.keys="p",this.isPiPActive=!1,this.i18n={},this.playbackReady=!1,X(this),me(this,["isPiPActive","playbackReady","i18n"])}onPlaybackReadyChange(){var t;return GP(this,void 0,void 0,function*(){const e=fi(this);this.canSetPiP=(t=yield e==null?void 0:e.canSetPiP())!==null&&t!==void 0?t:!1})}componentDidLoad(){this.onPlaybackReadyChange()}onClick(){const t=fi(this);this.isPiPActive?t==null||t.exitPiP():t==null||t.enterPiP()}render(){const t=this.isPiPActive?this.i18n.exitPiP:this.i18n.enterPiP,e=N(this.keys)?t:`${t} (${this.keys})`;return g(Bs,{hidden:!this.canSetPiP},g("vm-control",{label:this.i18n.pip,keys:this.keys,pressed:this.isPiPActive,hidden:!this.canSetPiP,onClick:this.onClick.bind(this)},g("vm-icon",{name:this.isPiPActive?this.exitIcon:this.enterIcon,library:this.icons}),g("vm-tooltip",{hidden:this.hideTooltip,position:this.tooltipPosition,direction:this.tooltipDirection},e)))}static get watchers(){return{playbackReady:["onPlaybackReadyChange"]}}static get style(){return KP}},YP=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.playIcon="play",this.pauseIcon="pause",this.tooltipPosition="top",this.hideTooltip=!1,this.keys="k",this.paused=!0,this.i18n={},X(this),me(this,["paused","i18n"])}connectedCallback(){this.dispatch=Ki(this)}onClick(){this.dispatch("paused",!this.paused)}render(){const t=this.paused?this.i18n.play:this.i18n.pause,e=N(this.keys)?t:`${t} (${this.keys})`;return g("vm-control",{label:this.i18n.playback,keys:this.keys,pressed:!this.paused,onClick:this.onClick.bind(this)},g("vm-icon",{name:this.paused?this.playIcon:this.pauseIcon,library:this.icons}),g("vm-tooltip",{hidden:this.hideTooltip,position:this.tooltipPosition,direction:this.tooltipDirection},e))}};class JP{constructor(){this.silent=!1}log(...e){!this.silent&&!N(console)&&console.log("[Vime tip]:",...e)}warn(...e){!this.silent&&!N(console)&&console.error("[Vime warn]:",...e)}}const Au=new Set;function XP(t){const e=Ye(t);Nt(t,()=>{Au.add(e)},()=>{Au.delete(e)})}function ZP(t){const e=Ye(t);Au.forEach(i=>{i!==e&&i.autopause&&(i.paused=!0)})}function eR(t){const e=Ye(t),i=new Map;function n(){Object.keys(ws).forEach(r=>{i.set(r,t[r])})}Nt(t,()=>{n()},()=>{i.clear()});const{componentDidRender:s}=t;t.componentDidRender=function(){s==null||s();const r=Array.from(i.keys());for(let o=0;o<r.length;o+=1){const a=r[o],l=i.get(a),u=t[a];l!==u&&(sA(e,a,u,l),i.set(a,u))}}}var vr=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const tR=new Set(["currentTime","paused"]);function iR(t){const e=Ye(t),i=new st,n=new Map;function s(){Object.keys(ws).forEach(d=>{n.set(d,t[d])})}let r=[];function o(){return vr(this,void 0,void 0,function*(){const d=yield t.adapter;if(!N(d)){for(let f=0;f<r.length;f+=1)yield r[f](d);r=[]}})}let a=!1;function l(d){if(d==null||d.stopImmediatePropagation(),!a){a=!0;return}r=[],Ht(()=>{Object.keys(ws).filter(GI).forEach(f=>{t[f]=ws[f]})})}function u(d){var f;return vr(this,void 0,void 0,function*(){d.stopImmediatePropagation();const{by:p,prop:T,value:v}=d.detail;if(!By(T)){(f=t.logger)===null||f===void 0||f.warn(`${p.nodeName} tried to change \`${T}\` but it is readonly.`);return}if(!t.playbackStarted&&tR.has(T)){const S=yield t.adapter;T==="paused"&&!v&&(S==null||S.play()),T==="currentTime"&&(S==null||S.play(),S==null||S.setCurrentTime(v))}Ht(()=>{t[T]=v})})}const{onProviderDisconnect:c}=t;t.onProviderDisconnect=function(){l(),c&&c.call(t)},Nt(t,()=>{s(),i.add(xe(e,eA,l)),i.add(xe(e,Hy,u))},()=>{n.clear(),i.empty()}),bs(t,"componentWillRender",()=>vr(this,void 0,void 0,function*(){t.playbackReady&&r.length>0&&(yield o())}));function h(d,f){var p;return f!==((p=t[Gy])===null||p===void 0?void 0:p.get(d))}return function(f,p){return vr(this,void 0,void 0,function*(){if(!h(f,t[f]))return;const T=t[f],v=S=>vr(this,void 0,void 0,function*(){var O;try{yield(O=S==null?void 0:S[p])===null||O===void 0?void 0:O.call(S,T)}catch(I){e.dispatchEvent(new CustomEvent("vmError",{detail:I}))}});t.playbackReady?yield v(yield t.adapter):r.push(v)})}}const nR=".player{box-sizing:border-box;direction:ltr;font-family:var(--vm-player-font-family);-moz-osx-font-smoothing:auto;-webkit-font-smoothing:subpixel-antialiased;-webkit-tap-highlight-color:transparent;font-variant-numeric:tabular-nums;font-weight:500;line-height:1.7;width:100%;display:block;max-width:100%;min-width:275px;min-height:40px;position:relative;text-shadow:none;outline:0;transition:box-shadow 0.3s ease;box-shadow:var(--vm-player-box-shadow);border-radius:var(--vm-player-border-radius)}.player.idle{cursor:none}.player.audio{background-color:transparent !important}.player.video{height:0;overflow:hidden;background-color:var(--vm-player-bg, #000)}.player.fullscreen{margin:0;border-radius:0;width:100%;height:100%;padding-bottom:0 !important}.blocker{position:absolute;top:0;left:0;width:100%;height:100%;display:inline-block;z-index:var(--vm-blocker-z-index)}";var we=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};let Om=0;const sR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmThemeChange=R(this,"vmThemeChange",7),this.vmPausedChange=R(this,"vmPausedChange",7),this.vmPlay=R(this,"vmPlay",7),this.vmPlayingChange=R(this,"vmPlayingChange",7),this.vmSeekingChange=R(this,"vmSeekingChange",7),this.vmSeeked=R(this,"vmSeeked",7),this.vmBufferingChange=R(this,"vmBufferingChange",7),this.vmDurationChange=R(this,"vmDurationChange",7),this.vmCurrentTimeChange=R(this,"vmCurrentTimeChange",7),this.vmReady=R(this,"vmReady",7),this.vmPlaybackReady=R(this,"vmPlaybackReady",7),this.vmPlaybackStarted=R(this,"vmPlaybackStarted",7),this.vmPlaybackEnded=R(this,"vmPlaybackEnded",7),this.vmBufferedChange=R(this,"vmBufferedChange",7),this.vmError=R(this,"vmError",7),this.vmLoadStart=R(this,"vmLoadStart",7),this.vmCurrentProviderChange=R(this,"vmCurrentProviderChange",7),this.vmCurrentSrcChange=R(this,"vmCurrentSrcChange",7),this.vmCurrentPosterChange=R(this,"vmCurrentPosterChange",7),this.vmMediaTitleChange=R(this,"vmMediaTitleChange",7),this.vmControlsChange=R(this,"vmControlsChange",7),this.vmPlaybackRateChange=R(this,"vmPlaybackRateChange",7),this.vmPlaybackRatesChange=R(this,"vmPlaybackRatesChange",7),this.vmPlaybackQualityChange=R(this,"vmPlaybackQualityChange",7),this.vmPlaybackQualitiesChange=R(this,"vmPlaybackQualitiesChange",7),this.vmMutedChange=R(this,"vmMutedChange",7),this.vmVolumeChange=R(this,"vmVolumeChange",7),this.vmViewTypeChange=R(this,"vmViewTypeChange",7),this.vmMediaTypeChange=R(this,"vmMediaTypeChange",7),this.vmLiveChange=R(this,"vmLiveChange",7),this.vmTouchChange=R(this,"vmTouchChange",7),this.vmLanguageChange=R(this,"vmLanguageChange",7),this.vmI18nChange=R(this,"vmI18nChange",7),this.vmTranslationsChange=R(this,"vmTranslationsChange",7),this.vmLanguagesChange=R(this,"vmLanguagesChange",7),this.vmFullscreenChange=R(this,"vmFullscreenChange",7),this.vmPiPChange=R(this,"vmPiPChange",7),this.vmTextTracksChange=R(this,"vmTextTracksChange",7),this.vmCurrentTextTrackChange=R(this,"vmCurrentTextTrackChange",7),this.vmTextTrackVisibleChange=R(this,"vmTextTrackVisibleChange",7),this.vmAudioTracksChange=R(this,"vmAudioTracksChange",7),this.vmCurrentAudioTrackChange=R(this,"vmCurrentAudioTrackChange",7),this.disposal=new st,this.logger=new JP,this.icons="vime",this.paused=!0,this.playing=!1,this.duration=-1,this.currentTime=0,this.autoplay=!1,this.ready=!1,this.playbackReady=!1,this.loop=!1,this.muted=!1,this.buffered=0,this.playbackRate=1,this.lastRateCheck=1,this.playbackRates=[1],this.playbackQualities=[],this.seeking=!1,this.debug=!1,this.playbackStarted=!1,this.playbackEnded=!1,this.buffering=!1,this.controls=!1,this.isControlsActive=!1,this.isSettingsActive=!1,this.volume=50,this.isFullscreenActive=!1,this.aspectRatio="16:9",this.isAudioView=!1,this.isVideoView=!1,this.isAudio=!1,this.isVideo=!1,this.isLive=!1,this.isMobile=!1,this.isTouch=!1,this.isPiPActive=!1,this.textTracks=[],this.currentTextTrack=-1,this.isTextTrackVisible=!0,this.shouldRenderNativeTextTracks=!0,this.audioTracks=[],this.currentAudioTrack=-1,this.autopause=!0,this.playsinline=!1,this.language="en",this.translations={en:Lr},this.languages=["en"],this.i18n=Lr,qI(this),YI(this),XP(this),uA(this),eR(this),this.safeAdapterCall=iR(this)}get adapter(){var t;return(t=this.provider)===null||t===void 0?void 0:t.getAdapter()}onContainerChange(){var t;(t=this.fullscreenController)===null||t===void 0||t.destroy(),!N(this.container)&&(this.fullscreenController=new n0(this.container),this.fullscreenController.on("change",e=>{this.isFullscreenActive=e,e&&this.rotateDevice()}),this.fullscreenController.on("error",e=>{this.vmError.emit(e)}))}onPausedChange(){this.paused?this.playing=!1:ZP(this),this.safeAdapterCall("paused",this.paused?"pause":"play")}onDurationChange(){this.isLive=this.duration===1/0}onCurrentTimeChange(){const t=this.playbackReady?this.duration:1/0;this.currentTime=Math.max(0,Math.min(this.currentTime,t)),this.safeAdapterCall("currentTime","setCurrentTime")}onPlaybackReadyChange(){this.ready||(this.ready=!0)}onMutedChange(){this.safeAdapterCall("muted","setMuted")}onPlaybackRateChange(t,e){var i,n;return we(this,void 0,void 0,function*(){if(t!==this.lastRateCheck){if(!(yield(n=(i=yield this.adapter)===null||i===void 0?void 0:i.canSetPlaybackRate)===null||n===void 0?void 0:n.call(i))){this.logger.log("provider cannot change `playbackRate`."),this.lastRateCheck=e,this.playbackRate=e;return}if(!this.playbackRates.includes(t)){this.logger.log(`invalid \`playbackRate\` of ${t}, valid values are [${this.playbackRates.join(", ")}]`),this.lastRateCheck=e,this.playbackRate=e;return}this.lastRateCheck=t,this.safeAdapterCall("playbackRate","setPlaybackRate")}})}onPlaybackQualityChange(t,e){var i,n;return we(this,void 0,void 0,function*(){if(!(N(t)||t===this.lastQualityCheck)){if(!(yield(n=(i=yield this.adapter)===null||i===void 0?void 0:i.canSetPlaybackQuality)===null||n===void 0?void 0:n.call(i))){this.logger.log("provider cannot change `playbackQuality`."),this.lastQualityCheck=e,this.playbackQuality=e;return}if(!this.playbackQualities.includes(t)){this.logger.log(`invalid \`playbackQuality\` of ${t}, valid values are [${this.playbackQualities.join(", ")}]`),this.lastQualityCheck=e,this.playbackQuality=e;return}this.lastQualityCheck=t,this.safeAdapterCall("playbackQuality","setPlaybackQuality")}})}onDebugChange(){this.logger.silent=!this.debug}onVolumeChange(){return we(this,void 0,void 0,function*(){this.volume=Math.max(0,Math.min(this.volume,100)),this.safeAdapterCall("volume","setVolume")})}onViewTypeChange(){this.isAudioView=this.viewType===zt.Audio,this.isVideoView=this.viewType===zt.Video}onMediaTypeChange(){this.isAudio=this.mediaType===oi.Audio,this.isVideo=this.mediaType===oi.Video}onLanguageChange(t,e){if(!this.languages.includes(this.language)){this.logger.log(`invalid \`language\` of ${this.language}, valid values are [${this.languages.join(", ")}]`),this.language=e;return}this.i18n=this.translations[this.language]}onTranslationsChange(){Object.assign(this.translations,{en:Lr}),this.languages=Object.keys(this.translations),this.i18n=this.translations[this.language]}onError(t){this.logger.warn(t.detail)}getProvider(){return we(this,void 0,void 0,function*(){return this.provider})}getAdapter(){return we(this,void 0,void 0,function*(){return this.adapter})}play(){var t;return we(this,void 0,void 0,function*(){return(t=yield this.adapter)===null||t===void 0?void 0:t.play()})}pause(){var t;return we(this,void 0,void 0,function*(){return(t=yield this.adapter)===null||t===void 0?void 0:t.pause()})}canPlay(t){var e,i;return we(this,void 0,void 0,function*(){return(i=(e=yield this.adapter)===null||e===void 0?void 0:e.canPlay(t))!==null&&i!==void 0?i:!1})}canAutoplay(){return we(this,void 0,void 0,function*(){return Sm()})}canMutedAutoplay(){return we(this,void 0,void 0,function*(){return Sm(!0)})}canSetPlaybackRate(){var t,e,i;return we(this,void 0,void 0,function*(){return(i=(e=(t=yield this.adapter)===null||t===void 0?void 0:t.canSetPlaybackRate)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:!1})}canSetPlaybackQuality(){var t,e,i;return we(this,void 0,void 0,function*(){return(i=(e=(t=yield this.adapter)===null||t===void 0?void 0:t.canSetPlaybackQuality)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:!1})}canSetFullscreen(){var t,e,i;return we(this,void 0,void 0,function*(){return this.fullscreenController.isSupported||((i=(e=(t=yield this.adapter)===null||t===void 0?void 0:t.canSetFullscreen)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:!1)})}enterFullscreen(t){var e,i,n;return we(this,void 0,void 0,function*(){if(!this.isVideoView)throw Error("Cannot enter fullscreen on an audio player view.");if(this.fullscreenController.isSupported)return this.fullscreenController.requestFullscreen();const s=yield this.adapter;if((i=yield(e=s==null?void 0:s.canSetFullscreen)===null||e===void 0?void 0:e.call(s))!==null&&i!==void 0?i:!1)return(n=s==null?void 0:s.enterFullscreen)===null||n===void 0?void 0:n.call(s,t);throw Error("Fullscreen API is not available.")})}exitFullscreen(){var t,e;return we(this,void 0,void 0,function*(){return this.fullscreenController.isSupported?this.fullscreenController.exitFullscreen():(e=(t=yield this.adapter)===null||t===void 0?void 0:t.exitFullscreen)===null||e===void 0?void 0:e.call(t)})}canSetPiP(){var t,e,i;return we(this,void 0,void 0,function*(){return(i=(e=(t=yield this.adapter)===null||t===void 0?void 0:t.canSetPiP)===null||e===void 0?void 0:e.call(t))!==null&&i!==void 0?i:!1})}enterPiP(){var t,e;return we(this,void 0,void 0,function*(){if(!this.isVideoView)throw Error("Cannot enter PiP mode on an audio player view.");if(!(yield this.canSetPiP()))throw Error("Picture-in-Picture API is not available.");return(e=(t=yield this.adapter)===null||t===void 0?void 0:t.enterPiP)===null||e===void 0?void 0:e.call(t)})}exitPiP(){var t,e;return we(this,void 0,void 0,function*(){return(e=(t=yield this.adapter)===null||t===void 0?void 0:t.exitPiP)===null||e===void 0?void 0:e.call(t)})}canSetAudioTrack(){var t;return we(this,void 0,void 0,function*(){return!N((t=yield this.adapter)===null||t===void 0?void 0:t.setCurrentAudioTrack)})}setCurrentAudioTrack(t){var e,i;return we(this,void 0,void 0,function*(){(i=(e=yield this.adapter)===null||e===void 0?void 0:e.setCurrentAudioTrack)===null||i===void 0||i.call(e,t)})}canSetTextTrack(){var t;return we(this,void 0,void 0,function*(){return!N((t=yield this.adapter)===null||t===void 0?void 0:t.setCurrentTextTrack)})}setCurrentTextTrack(t){var e,i;return we(this,void 0,void 0,function*(){(i=(e=yield this.adapter)===null||e===void 0?void 0:e.setCurrentTextTrack)===null||i===void 0||i.call(e,t)})}canSetTextTrackVisibility(){var t;return we(this,void 0,void 0,function*(){return!N((t=yield this.adapter)===null||t===void 0?void 0:t.setTextTrackVisibility)})}setTextTrackVisibility(t){var e,i;return we(this,void 0,void 0,function*(){(i=(e=yield this.adapter)===null||e===void 0?void 0:e.setTextTrackVisibility)===null||i===void 0||i.call(e,t)})}extendLanguage(t,e){var i;return we(this,void 0,void 0,function*(){const n=Object.assign(Object.assign({},this.translations),{[t]:Object.assign(Object.assign({},(i=this.translations[t])!==null&&i!==void 0?i:{}),e)});this.translations=n})}connectedCallback(){this.onPausedChange(),this.onCurrentTimeChange(),this.onVolumeChange(),this.onMutedChange(),this.onDebugChange(),this.onContainerChange(),this.onTranslationsChange(),this.onLanguageChange(this.language,ws.language),this.disposal.add(VA(t=>{this.isMobile=t})),this.disposal.add(FA(t=>{this.isTouch=t}))}componentWillLoad(){Tm.create(this,this.getPlayerState())}disconnectedCallback(){var t;(t=this.fullscreenController)===null||t===void 0||t.destroy(),this.disposal.empty()}rotateDevice(){return we(this,void 0,void 0,function*(){if(!(!this.isMobile||!UA()))try{this.isFullscreenActive?yield window.screen.orientation.lock("landscape"):yield window.screen.orientation.unlock()}catch(t){this.vmError.emit(t)}})}getPlayerState(){const t={},e=Object.keys(ws);for(let i=0;i<e.length;i+=1)t[e[i]]=this[e[i]];return t}calcAspectRatio(){const[t,e]=/\d{1,2}:\d{1,2}/.test(this.aspectRatio)?this.aspectRatio.split(":"):[16,9];return 100/Number(t)*Number(e)}getContainer(){return we(this,void 0,void 0,function*(){return this.container})}callAdapter(t,e){return we(this,void 0,void 0,function*(){return(yield this.adapter)[t](e)})}hasCustomControls(){return JI(this,"vm-controls")}genId(){var t;const e=(t=this.host)===null||t===void 0?void 0:t.id;return _t(e)&&e.length>0?e:(Om+=1,`vm-player-${Om}`)}render(){const t=`${this.isAudioView?"Audio Player":"Video Player"}${N(this.mediaTitle)?"":` - ${this.mediaTitle}`}`,e=!js||!this.isVideoView||this.playsinline&&!this.isFullscreenActive;e||(this.controls=!0);const i=e&&this.hasCustomControls()&&this.isVideoView&&!this.paused&&!this.isControlsActive,n=!this.controls&&e&&this.isVideoView;return g(Bs,{id:this.genId(),idle:i,mobile:this.isMobile,touch:this.isTouch,live:this.isLive,audio:this.isAudioView,video:this.isVideoView,pip:this.isPiPActive,fullscreen:this.isFullscreenActive},g("div",{"aria-label":t,"aria-hidden":this.ready?"false":"true","aria-busy":this.playbackReady?"false":"true",class:{player:!0,idle:i,audio:this.isAudioView,video:this.isVideoView,fullscreen:this.isFullscreenActive},style:{paddingBottom:this.isVideoView?`${this.calcAspectRatio()}%`:void 0},ref:s=>{Ht(()=>{this.container=s})}},n&&g("div",{class:"blocker"}),g(Tm.Provider,{state:this.getPlayerState()},g("slot",null))))}get host(){return this}static get watchers(){return{container:["onContainerChange"],paused:["onPausedChange"],duration:["onDurationChange"],currentTime:["onCurrentTimeChange"],playbackReady:["onPlaybackReadyChange"],muted:["onMutedChange"],playbackRate:["onPlaybackRateChange"],playbackQuality:["onPlaybackQualityChange"],debug:["onDebugChange"],volume:["onVolumeChange"],viewType:["onViewTypeChange"],isAudioView:["onViewTypeChange"],isVideoView:["onViewTypeChange"],mediaType:["onMediaTypeChange"],language:["onLanguageChange"],translations:["onTranslationsChange"]}}static get style(){return nR}},rR=":host{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:var(--vm-poster-z-index)}.poster{width:100%;height:100%;background:#000;opacity:0;visibility:hidden;pointer-events:none;transition:var(--vm-fade-transition)}.poster.hidden{display:none}.poster.active{opacity:1;visibility:visible}img{width:100%;height:100%;pointer-events:none}",oR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmLoaded=R(this,"vmLoaded",3),this.vmWillShow=R(this,"vmWillShow",3),this.vmWillHide=R(this,"vmWillHide",3),this.isHidden=!0,this.isActive=!1,this.hasLoaded=!1,this.fit="cover",this.isVideoView=!1,this.playbackStarted=!1,this.currentTime=0,X(this),me(this,["mediaTitle","currentPoster","playbackStarted","currentTime","isVideoView"])}onCurrentPosterChange(){var t;this.hasLoaded=!1,(t=this.lazyLoader)===null||t===void 0||t.onMutation()}connectedCallback(){this.lazyLoader=new ld(this.host,["data-src","src"],t=>{const e=t.getAttribute("data-src");t.removeAttribute("src"),Li(e)||t.setAttribute("src",e)}),this.onEnabledChange(),this.onActiveChange()}disconnectedCallback(){this.lazyLoader.destroy()}onVisibilityChange(){!this.isHidden&&this.isActive?this.vmWillShow.emit():this.vmWillHide.emit()}onEnabledChange(){this.isHidden=!this.isVideoView,this.onVisibilityChange()}onActiveChange(){this.isActive=!this.playbackStarted||this.currentTime<=.1,this.onVisibilityChange()}onPosterLoad(){this.vmLoaded.emit(),this.hasLoaded=!0}render(){return g("div",{class:{poster:!0,hidden:this.isHidden,active:this.isActive&&this.hasLoaded}},g("img",{class:"lazy","data-src":this.currentPoster,alt:N(this.mediaTitle)?"Media Poster":`${this.mediaTitle} Poster`,style:{objectFit:this.fit},onLoad:this.onPosterLoad.bind(this)}))}get host(){return this}static get watchers(){return{currentPoster:["onCurrentPosterChange"],isVideoView:["onEnabledChange"],currentTime:["onActiveChange"],playbackStarted:["onActiveChange"]}}static get style(){return rR}},aR=":host{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:var(--vm-scrim-z-index)}.scrim{position:absolute;width:100%;background:var(--vm-scrim-bg);display:inline-block;opacity:0;visibility:hidden;transition:var(--vm-fade-transition)}.scrim.gradient{height:258px;background:none;background-position:bottom;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAECCAYAAAA/9r2TAAABKklEQVQ4T2XI50cFABiF8dvee++67b33uM17b1MkkSSSSBJJJIkkkkQSSSKJ9Efmeb8cr86HH88JBP4thkfEkiKOFPGkSCCNRE8SKZJJkUIaqZ40UqSTIoMUmaSR5ckmRQ4pckkjz5NPigJSFJKiiDSKPSWkKCVFGWmUeypIUUmKKlJUk0aNJ0iKWlLUkUa9p4EUjaRoIkUzabR4WknRRop20ujwdJKiixTdpOghjV5PHyn6STFAGoOeIVIMk2KEFKOkMeYZJ8UEKUKkMemZIsU0KWZIMUsac54wKSKkiJLGvGeBFIukWCLFMrkCq7AG67ABm7AF27ADu7AH+3AAh3AEx3ACp3AG53ABl3AF13ADt3AH9/AAj/AEz/ACr/AG7/ABn/AF3/ADv39LujSyJPVJ0QAAAABJRU5ErkJggg==')}.scrim.gradientUp{top:unset;bottom:0}.scrim.gradientDown{transform:rotate(180deg)}.scrim.hidden{display:none}.scrim.active{opacity:1;visibility:visible}",lR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.isVideoView=!1,this.isControlsActive=!1,X(this),me(this,["isVideoView","isControlsActive"])}render(){return g("div",{class:{scrim:!0,gradient:!N(this.gradient),gradientUp:this.gradient==="up",gradientDown:this.gradient==="down",hidden:!this.isVideoView,active:this.isControlsActive}})}static get style(){return aR}},cR=t=>Math.trunc(t/60/60%60),uR=t=>Math.trunc(t/60%60),hR=t=>Math.trunc(t%60),Er=(t=0,e=!1)=>{const i=o=>`0${o}`.slice(-2),n=cR(t),s=uR(t),r=hR(t);return`${e||n>0?`${n}:`:""}${i(s)}:${i(r)}`},dR=`:host{--vm-tooltip-spacing:var(--vm-scrubber-tooltip-spacing);flex:1;position:relative;cursor:pointer;pointer-events:auto;box-sizing:border-box;left:calc(var(--vm-slider-thumb-width) / 2);margin-right:var(--vm-slider-thumb-width);margin-bottom:var(--vm-slider-track-height)}@keyframes progress{to{background-position:var(--vm-scrubber-loading-stripe-size) 0}}.scrubber{position:relative;width:100%}vm-slider,progress{margin-left:calc(calc(var(--vm-slider-thumb-width) / 2) * -1);margin-right:calc(calc(var(--vm-slider-thumb-width) / 2) * -1);width:calc(100% + var(--vm-slider-thumb-width));height:var(--vm-slider-track-height)}vm-slider:hover,progress:hover{cursor:pointer}vm-slider{position:absolute;top:0;left:0;z-index:3}progress{-webkit-appearance:none;background:transparent;border:0;border-radius:100px;position:absolute;left:0;top:50%;padding:0;color:var(--vm-scrubber-buffered-bg);height:var(--vm-slider-track-height)}progress::-webkit-progress-bar{background:transparent}progress::-webkit-progress-value{background:currentColor;border-radius:100px;min-width:var(--vm-slider-track-height);transition:width 0.2s ease}progress::-moz-progress-bar{background:currentColor;border-radius:100px;min-width:var(--vm-slider-track-height);transition:width 0.2s ease}progress::-ms-fill{border-radius:100px;transition:width 0.2s ease}progress.loading{animation:progress 1s linear infinite;background-image:linear-gradient(
    -45deg,
    var(--vm-scrubber-loading-stripe-color) 25%,
    transparent 25%,
    transparent 50%,
    var(--vm-scrubber-loading-stripe-color) 50%,
    var(--vm-scrubber-loading-stripe-color) 75%,
    transparent 75%,
    transparent
  );background-repeat:repeat-x;background-size:var(--vm-scrubber-loading-stripe-size)
    var(--vm-scrubber-loading-stripe-size);color:transparent;background-color:transparent}`;var fR=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const mR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.keyboardDisposal=new st,this.timestamp="",this.endTime=0,this.alwaysShowHours=!1,this.hideTooltip=!1,this.currentTime=0,this.duration=-1,this.noKeyboard=!1,this.buffering=!1,this.buffered=0,this.i18n={},X(this),me(this,["i18n","currentTime","duration","buffering","buffered"])}onNoKeyboardChange(){return fR(this,void 0,void 0,function*(){if(this.keyboardDisposal.empty(),this.noKeyboard)return;const t=yield $i(this);if(N(t))return;const e=i=>{if(i.key!=="ArrowLeft"&&i.key!=="ArrowRight")return;i.preventDefault();const s=i.key==="ArrowLeft"?Math.max(0,this.currentTime-5):Math.min(this.duration,this.currentTime+5);this.dispatch("currentTime",s)};this.keyboardDisposal.add(xe(t,"keydown",e))})}onDurationChange(){this.endTime=Math.max(0,this.duration)}connectedCallback(){this.dispatch=Ki(this),this.timestamp=Er(this.currentTime,this.alwaysShowHours),this.onNoKeyboardChange()}disconnectedCallback(){this.keyboardDisposal.empty()}setTooltipPosition(t){var e,i;const n=(i=(e=this.tooltip.shadowRoot)===null||e===void 0?void 0:e.querySelector(".tooltip"))===null||i===void 0?void 0:i.getBoundingClientRect(),s=this.slider.getBoundingClientRect(),r=parseFloat(window.getComputedStyle(this.slider).getPropertyValue("--vm-slider-thumb-width")),o=n.width/2-r/2,a=s.width-n.width/2-r/2,l=Math.max(o,Math.min(t,a));this.tooltip.style=`--vm-tooltip-left: ${l}px`}onSeek(t){this.dispatch("currentTime",t.detail)}onSeeking(t){if(this.duration<0||this.tooltip.hidden)return;if(t.type==="mouseleave"){this.getSliderInput().blur(),this.tooltip.active=!1;return}const e=this.host.getBoundingClientRect(),i=Math.max(0,Math.min(100,100/e.width*(t.pageX-e.left)));this.timestamp=Er(this.duration/100*i,this.alwaysShowHours),this.setTooltipPosition(i/100*e.width),this.tooltip.active||(this.getSliderInput().focus(),this.tooltip.active=!0)}getSliderInput(){var t;return(t=this.slider.shadowRoot)===null||t===void 0?void 0:t.querySelector("input")}render(){const t=this.i18n.scrubberLabel.replace(/{currentTime}/,Er(this.currentTime)).replace(/{duration}/,Er(this.endTime));return g("div",{class:"scrubber",onMouseEnter:this.onSeeking.bind(this),onMouseLeave:this.onSeeking.bind(this),onMouseMove:this.onSeeking.bind(this),onTouchMove:()=>{this.getSliderInput().focus()},onTouchEnd:()=>{this.getSliderInput().blur()}},g("vm-slider",{step:.01,max:this.endTime,value:this.currentTime,label:this.i18n.scrubber,valueText:t,onVmValueChange:this.onSeek.bind(this),ref:e=>{this.slider=e}}),g("progress",{class:{loading:this.buffering},min:0,max:this.endTime,value:this.buffered,"aria-label":this.i18n.buffered,"aria-valuemin":"0","aria-valuemax":this.endTime,"aria-valuenow":this.buffered,"aria-valuetext":`${(this.endTime>0?this.buffered/this.endTime:0).toFixed(0)}%`},"% buffered"),g("vm-tooltip",{hidden:this.hideTooltip,ref:e=>{this.tooltip=e}},this.timestamp))}get host(){return this}static get watchers(){return{noKeyboard:["onNoKeyboardChange"],duration:["onDurationChange"]}}static get style(){return dR}},pR=`:host{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:var(--vm-menu-z-index)}.settings{position:absolute;opacity:0;pointer-events:none;overflow-x:hidden;overflow-y:auto;background-color:var(--vm-menu-bg);max-height:var(--vm-settings-max-height);border-radius:var(--vm-settings-border-radius);padding:var(--vm-settings-padding);box-shadow:var(--vm-settings-shadow);box-sizing:border-box;scrollbar-width:thin;scroll-behavior:smooth;scrollbar-color:var(--vm-settings-scroll-thumb-color)
    var(--vm-settings-scroll-track-color);transform:translateY(8px);transition:var(--vm-settings-transition)}.container{display:block;width:var(--vm-settings-width);height:100%;position:relative;transition:width 0.25s ease-in, height 0.25s ease-in}.settings.hydrated{visibility:hidden !important}.settings::-webkit-scrollbar{width:var(--vm-settings-scroll-width)}.settings::-webkit-scrollbar-track{background:var(--vm-settings-scroll-track-color)}.settings::-webkit-scrollbar-thumb{border-radius:var(--vm-settings-scroll-width);background-color:var(--vm-settings-scroll-thumb-color);border:2px solid var(--vm-menu-bg)}.settings.active{transform:translateY(0);opacity:1;pointer-events:auto;visibility:visible !important}.settings.mobile{position:fixed;top:auto !important;left:0 !important;right:0 !important;bottom:0 !important;width:100%;min-height:56px;max-height:50%;border-radius:0;z-index:2147483647;transform:translateY(100%)}.settings.mobile.active{transform:translateY(0)}.settings.mobile>vm-menu{height:100% !important;overflow:auto !important}`;var gR=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};let Vm=0;const vR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.disposal=new st,this.menuHeight=0,this.pin="bottomRight",this.active=!1,this.isMobile=!1,this.isAudioView=!1,X(this),Jy(this),me(this,["isMobile","isAudioView"])}onActiveChange(){this.dispatch("isSettingsActive",this.active),!N(this.controller)&&(this.controller.expanded=this.active)}connectedCallback(){this.dispatch=Ki(this),Vm+=1,this.id=`vm-settings-${Vm}`}disconnectedCallback(){this.disposal.empty()}setController(t){return gR(this,void 0,void 0,function*(){this.controller=t,this.controller.menu=this.id,this.disposal.empty(),this.disposal.add(xe(this.controller,"click",()=>{this.active=!this.active})),this.disposal.add(xe(this.controller,"keydown",e=>{e.key==="Enter"&&(this.active||this.menu.focusMenu())}))})}getPosition(){if(this.isAudioView)return{right:"0",bottom:"calc(var(--vm-controls-height, 0) + 4px)"};const t=this.pin.split(/(?=[L|R])/).map(e=>e.toLowerCase());return{[t.includes("top")?"top":"bottom"]:"var(--vm-controls-height, 0)",[t.includes("left")?"left":"right"]:"8px"}}onOpen(t){var e;((e=t.detail)===null||e===void 0?void 0:e.identifier)===this.id&&(this.active=!0)}onClose(t){var e;((e=t.detail)===null||e===void 0?void 0:e.identifier)===this.id&&(this.active=!1)}onHeightChange(t){this.menuHeight=t.detail}render(){return g("div",{style:Object.assign({},this.getPosition()),class:{settings:!0,active:this.active,mobile:this.isMobile}},g("div",{class:"container",style:{height:`${this.menuHeight}px`}},g("vm-menu",{identifier:this.id,active:this.active,controller:this.controller,onVmOpen:this.onOpen.bind(this),onVmClose:this.onClose.bind(this),onVmMenuHeightChange:this.onHeightChange.bind(this),ref:t=>{this.menu=t}},g("slot",null))))}get host(){return this}static get watchers(){return{active:["onActiveChange"]}}static get style(){return pR}},yR=".settingsControl.hidden{display:none}.settingsControl{--vm-icon-transition:transform 0.3s ease}.settingsControl.active{--vm-icon-transform:rotate(90deg)}";var Fm=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};let Um=0;const bR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.icon="settings",this.tooltipPosition="top",this.expanded=!1,this.i18n={},this.hideTooltip=!1,X(this),me(this,["i18n"])}onComponentsChange(){N(this.vmSettings)||this.vmSettings.setController(this.host)}connectedCallback(){Um+=1,this.id=`vm-settings-control-${Um}`,Wy(this,"vm-settings",t=>{[this.vmSettings]=t})}focusControl(){var t;return Fm(this,void 0,void 0,function*(){(t=this.control)===null||t===void 0||t.focusControl()})}blurControl(){var t;return Fm(this,void 0,void 0,function*(){(t=this.control)===null||t===void 0||t.blurControl()})}render(){const t=!N(this.menu);return g("div",{class:{settingsControl:!0,hidden:!t,active:t&&this.expanded}},g("vm-control",{identifier:this.id,menu:this.menu,hidden:!t,expanded:this.expanded,label:this.i18n.settings,ref:e=>{this.control=e}},g("vm-icon",{name:this.icon,library:this.icons}),g("vm-tooltip",{hidden:this.hideTooltip||this.expanded,position:this.tooltipPosition,direction:this.tooltipDirection},this.i18n.settings)))}get host(){return this}static get watchers(){return{vmSettings:["onComponentsChange"]}}static get style(){return yR}},wR=`:host{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:var(--vm-skeleton-z-index)}@keyframes sheen{0%{background-position:200% 0}to{background-position:-200% 0}}.skeleton{width:100%;height:100%;display:flex;min-height:1rem;pointer-events:auto}.sheen.hidden{opacity:0;visibility:hidden;transition:var(--vm-fade-transition);pointer-events:none}.indicator{flex:1 1 auto;background:var(--vm-skeleton-color)}.skeleton.sheen .indicator{background:linear-gradient(
    270deg,
    var(--vm-skeleton-sheen-color),
    var(--vm-skeleton-color),
    var(--vm-skeleton-color),
    var(--vm-skeleton-sheen-color)
  );background-size:400% 100%;background-size:400% 100%;animation:sheen 8s ease-in-out infinite}`,kR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.hidden=!1,this.effect="sheen",this.ready=!1,X(this),me(this,["ready"])}onReadyChange(){this.ready?setTimeout(()=>{this.hidden=!0},500):this.hidden=!1}render(){return g("div",{class:{skeleton:!0,hidden:this.hidden,sheen:this.effect==="sheen"}},g("div",{class:"indicator"}))}static get watchers(){return{ready:["onReadyChange"]}}static get style(){return wR}},TR=`:host{width:100%}.slider{width:100%}input{width:100%;-webkit-appearance:none;background:transparent;border:0;outline:0;cursor:pointer;box-sizing:border-box;border-radius:calc(var(--vm-slider-thumb-height) * 2);user-select:none;-webkit-user-select:none;touch-action:manipulation;color:var(--vm-slider-value-color);display:block;height:var(--vm-slider-track-height);margin:0;padding:0;transition:box-shadow 0.3s ease}input::-webkit-slider-runnable-track{background:transparent;border:0;border-radius:calc(var(--vm-slider-track-height) / 2);height:var(--vm-slider-track-height);transition:box-shadow 0.3s ease;user-select:none;background-image:linear-gradient(
    to right,
    currentColor var(--vm-value, 0%),
    transparent var(--vm-value, 0%)
  );background-color:var(--vm-slider-track-color)}input::-webkit-slider-thumb{opacity:0;background:var(--vm-slider-thumb-bg);border:0;border-radius:100%;position:relative;transition:all 0.2s ease;width:var(--vm-slider-thumb-width);height:var(--vm-slider-thumb-height);box-shadow:var(--vm-slider-thumb-shadow);-webkit-appearance:none;margin-top:calc(
    0px -
      calc(
        calc(var(--vm-slider-thumb-height) - var(--vm-slider-track-height)) / 2
      )
  )}input::-moz-range-track{background:transparent;border:0;border-radius:calc(var(--vm-slider-track-height) / 2);height:var(--vm-slider-track-height);transition:box-shadow 0.3s ease;user-select:none;background-color:var(--vm-slider-track-color)}input::-moz-range-thumb{opacity:0;background:var(--vm-slider-thumb-bg);border:0;border-radius:100%;position:relative;transition:all 0.2s ease;width:var(--vm-slider-thumb-width);height:var(--vm-slider-thumb-height);box-shadow:var(--vm-slider-thumb-shadow)}input::-moz-range-progress{background:currentColor;border-radius:calc(var(--vm-slider-track-height) / 2);height:var(--vm-slider-track-height)}input::-ms-track{border:0;border-radius:calc(var(--vm-slider-track-height) / 2);height:var(--vm-slider-track-height);transition:box-shadow 0.3s ease;user-select:none;color:transparent;background-color:var(--vm-slider-track-color)}input::-ms-fill-upper{background:transparent;border:0;border-radius:calc(var(--vm-slider-track-height) / 2);height:var(--vm-slider-track-height);transition:box-shadow 0.3s ease;user-select:none}input::-ms-fill-lower{border:0;border-radius:calc(var(--vm-slider-track-height) / 2);height:var(--vm-slider-track-height);transition:box-shadow 0.3s ease;user-select:none;background:currentColor}input::-ms-thumb{opacity:0;background:var(--vm-slider-thumb-bg);border:0;border-radius:100%;position:relative;transition:all 0.2s ease;width:var(--vm-slider-thumb-width);height:var(--vm-slider-thumb-height);box-shadow:var(--vm-slider-thumb-shadow);margin-top:0}input::-ms-tooltip{display:none}input:hover::-webkit-slider-runnable-track{height:var(--vm-slider-track-focused-height)}input:hover::-moz-range-track{height:var(--vm-slider-track-focused-height)}input:hover::-ms-track{height:var(--vm-slider-track-focused-height)}input:hover::-ms-fill-upper{height:var(--vm-slider-track-focused-height)}input:hover::-ms-fill-lower{height:var(--vm-slider-track-focused-height)}input:hover::-webkit-slider-thumb{opacity:1}input:hover::-moz-range-thumb{opacity:1}input:hover::-ms-thumb{opacity:1}input:focus{outline:0}input:focus::-webkit-slider-runnable-track{outline:0;height:var(--vm-slider-track-focused-height)}input:focus::-moz-range-track{outline:0;height:var(--vm-slider-track-focused-height)}input:focus::-ms-track{outline:0;height:var(--vm-slider-track-focused-height)}input::-moz-focus-outer{border:0}`,_R=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmValueChange=R(this,"vmValueChange",7),this.vmFocus=R(this,"vmFocus",7),this.vmBlur=R(this,"vmBlur",7),this.step=1,this.min=0,this.max=10,this.value=5,X(this)}getPercentage(){return`${this.value/this.max*100}%`}onValueChange(t){var e;const i=parseFloat((e=t.target)===null||e===void 0?void 0:e.value);this.vmValueChange.emit(i)}calcTouchedValue(t){const e=t.target,i=t.changedTouches[0],n=parseFloat(e.getAttribute("min")),s=parseFloat(e.getAttribute("max")),r=parseFloat(e.getAttribute("step")),o=s-n;let a;const l=e.getBoundingClientRect(),u=parseFloat(window.getComputedStyle(this.host).getPropertyValue("--vm-slider-thumb-width")),c=100/l.width*(u/2)/100;a=100/l.width*(i.clientX-l.left),a=Math.max(0,Math.min(a,100)),a<50?a-=(100-a*2)*c:a>50&&(a+=(a-50)*2*c);const h=o*(a/100);return r>=1?n+Math.round(h/r)*r:n+parseFloat(h.toFixed(2))}onTouch(t){const e=t.target;e.disabled||(t.preventDefault(),this.value=this.calcTouchedValue(t),this.vmValueChange.emit(this.value),e.dispatchEvent(new window.Event(t.type==="touchend"?"change":"input",{bubbles:!0})))}render(){var t;return g("div",{class:"slider",style:{"--vm-value":this.getPercentage()}},g("input",{type:"range",step:this.step,min:this.min,max:this.max,value:this.value,autocomplete:"off","aria-label":this.label,"aria-valuemin":this.min,"aria-valuemax":this.max,"aria-valuenow":this.value,"aria-valuetext":(t=this.valueText)!==null&&t!==void 0?t:this.getPercentage(),"aria-orientation":"horizontal",onInput:this.onValueChange.bind(this),onFocus:()=>{this.vmFocus.emit()},onBlur:()=>{this.vmBlur.emit()},onTouchStart:this.onTouch.bind(this),onTouchMove:this.onTouch.bind(this),onTouchEnd:this.onTouch.bind(this)}))}get host(){return this}static get style(){return TR}},CR=`:host{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:var(--vm-spinner-z-index)}.spinner{width:100%;height:100%;display:flex;justify-content:center;align-items:center;opacity:0;visibility:hidden;pointer-events:none;transition:var(--vm-fade-transition)}.spinner.hidden{display:none}.spinner.active{opacity:1;visibility:visible}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.spin{background:transparent;margin:60px auto;font-size:10px;position:relative;text-indent:-9999em;pointer-events:none;border-top:var(--vm-spinner-thickness) solid var(--vm-spinner-fill-color);border-left:var(--vm-spinner-thickness) solid var(--vm-spinner-fill-color);border-right:var(--vm-spinner-thickness) solid var(--vm-spinner-track-color);border-bottom:var(--vm-spinner-thickness) solid var(--vm-spinner-track-color);transform:translateZ(0)}.spin.active{animation:spin var(--vm-spinner-spin-duration) infinite
    var(--vm-spinner-spin-timing-func)}.spin,.spin::after{border-radius:50%;width:var(--vm-spinner-width);height:var(--vm-spinner-height)}`,ER=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmWillShow=R(this,"vmWillShow",3),this.vmWillHide=R(this,"vmWillHide",3),this.blacklist=[qa.YouTube],this.isHidden=!0,this.isActive=!1,this.isVideoView=!1,this.showWhenMediaLoading=!1,this.playbackReady=!1,this.buffering=!1,X(this),me(this,["isVideoView","buffering","playbackReady","currentProvider"])}onVideoViewChange(){this.isHidden=!this.isVideoView,this.onVisiblityChange()}onActiveChange(){this.isActive=this.buffering||this.showWhenMediaLoading&&!this.playbackReady,this.onVisiblityChange()}onVisiblityChange(){!this.isHidden&&this.isActive?this.vmWillShow.emit():this.vmWillHide.emit()}render(){return g("div",{class:{spinner:!0,hidden:this.isHidden||this.blacklist.includes(this.currentProvider),active:this.isActive}},g("div",{class:{spin:!0,active:this.isActive}},"Loading..."))}static get watchers(){return{isVideoView:["onVideoViewChange"],buffering:["onActiveChange"],playbackReady:["onActiveChange"]}}static get style(){return CR}};var Nc=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};let Hm=0;const SR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmOpenSubmenu=R(this,"vmOpenSubmenu",7),this.vmCloseSubmenu=R(this,"vmCloseSubmenu",7),this.slideInDirection="right",this.active=!1,X(this)}connectedCallback(){this.genId()}getController(){return Nc(this,void 0,void 0,function*(){return this.controller})}getMenu(){return Nc(this,void 0,void 0,function*(){return this.menu})}getControllerHeight(){var t,e;return Nc(this,void 0,void 0,function*(){return(e=(t=this.controller)===null||t===void 0?void 0:t.getHeight())!==null&&e!==void 0?e:0})}getControllerHeightSync(){var t;const e=(t=this.controller)===null||t===void 0?void 0:t.shadowRoot.querySelector("[role='menuitem']");return e?parseFloat(window.getComputedStyle(e).height):0}onMenuOpen(){this.active=!0,this.vmOpenSubmenu.emit(this.host)}onMenuClose(){this.active=!1,this.vmCloseSubmenu.emit(this.host)}genId(){Hm+=1,this.id=`vm-submenu-${Hm}`}getControllerId(){return`${this.id}-controller`}render(){return g("div",null,g("vm-menu-item",{identifier:this.getControllerId(),menu:this.menu,label:this.label,hint:this.hint,expanded:this.active,ref:t=>{Ht(()=>{this.controller=t})}}),g("vm-menu",{identifier:this.id,controller:this.controller,active:this.active,slideInDirection:this.slideInDirection,onVmOpen:this.onMenuOpen.bind(this),onVmClose:this.onMenuClose.bind(this),ref:t=>{Ht(()=>{this.menu=t})},style:{top:`${this.getControllerHeightSync()+1}px`}},g("slot",null)))}get host(){return this}},IR=".time{display:flex;align-items:center;color:var(--vm-time-color);font-size:var(--vm-time-font-size);font-weight:var(--vm-time-font-weight)}",AR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.seconds=0,this.alwaysShowHours=!1,X(this)}render(){return g("div",{class:"time","aria-label":this.label},Er(Math.max(0,this.seconds),this.alwaysShowHours))}static get style(){return IR}},PR=".timeProgress{display:flex;width:100%;height:100%;align-items:center;color:var(--vm-time-color)}.separator{margin:0 4px}",RR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.separator="/",this.alwaysShowHours=!1,X(this)}render(){return g("div",{class:"timeProgress"},g("vm-current-time",{alwaysShowHours:this.alwaysShowHours}),g("span",{class:"separator"},this.separator),g("vm-end-time",{alwaysShowHours:this.alwaysShowHours}))}static get style(){return PR}},xR=`:host{display:contents;z-index:var(--vm-tooltip-z-index)}.tooltip{left:var(--vm-tooltip-left, 50%);transform:translateX(-50%);line-height:1.3;pointer-events:none;position:absolute;opacity:0;white-space:nowrap;visibility:hidden;background:var(--vm-tooltip-bg);border-radius:var(--vm-tooltip-border-radius);box-sizing:border-box;box-shadow:var(--vm-tooltip-box-shadow);color:var(--vm-tooltip-color);font-size:var(--vm-tooltip-font-size);padding:var(--vm-tooltip-padding);transition:opacity var(--vm-tooltip-fade-duration)
    var(--vm-tooltip-fade-timing-func)}.tooltip[aria-hidden='false']{opacity:1;visibility:visible}.tooltip.hidden{display:none}.tooltip.onTop{bottom:100%;margin-bottom:var(--vm-tooltip-spacing)}.tooltip.onBottom{top:100%;margin-top:var(--vm-tooltip-spacing)}.tooltip.growLeft{left:auto;right:0;transform:none}.tooltip.growRight{left:0;transform:none}`;let Bm=0;const DR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.hasLoaded=!1,this.hidden=!1,this.active=!1,this.position="top",this.isTouch=!1,this.isMobile=!1,X(this),me(this,["isTouch","isMobile"])}componentDidLoad(){this.hasLoaded=!0}getId(){const t=this.host.id;return _t(t)&&t.length>0?t:(Bm+=1,`vm-tooltip-${Bm}`)}render(){return g("div",{id:this.getId(),role:"tooltip","aria-hidden":!this.active||this.isTouch||this.isMobile?"true":"false",class:{tooltip:!0,hidden:!this.hasLoaded||this.hidden,onTop:this.position==="top",onBottom:this.position==="bottom",growLeft:this.direction==="left",growRight:this.direction==="right"}},g("slot",null))}get host(){return this}static get style(){return xR}},MR=":host{z-index:var(--vm-ui-z-index)}.ui{width:100%;pointer-events:none}.ui.hidden{display:none}.ui.video{position:absolute;top:0;left:0;height:100%}",LR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.isVideoView=!1,this.playsinline=!1,this.isFullscreenActive=!1,X(this),me(this,["isVideoView","playsinline","isFullscreenActive"])}render(){const t=!js||!this.isVideoView||this.playsinline&&!this.isFullscreenActive;return g("div",{class:{ui:!0,hidden:!t,video:this.isVideoView}},t&&g("slot",null))}static get style(){return MR}};var NR=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const OR=class extends HTMLElement{constructor(){super(),this.__registerHost(),this.willAttach=!1,this.hasCustomTextManager=!1,this.preload="metadata",X(this),fn(this)}onProviderConnect(t){this.willAttach&&t.stopImmediatePropagation()}onProviderDisconnect(t){this.willAttach&&t.stopImmediatePropagation()}getAdapter(){var t;return NR(this,void 0,void 0,function*(){return(t=this.fileProvider)===null||t===void 0?void 0:t.getAdapter()})}render(){return g("vm-file",{noConnect:!0,willAttach:this.willAttach,crossOrigin:this.crossOrigin,poster:this.poster,preload:this.preload,controlsList:this.controlsList,autoPiP:this.autoPiP,disablePiP:this.disablePiP,disableRemotePlayback:this.disableRemotePlayback,hasCustomTextManager:this.hasCustomTextManager,mediaTitle:this.mediaTitle,viewType:zt.Video,ref:t=>{this.fileProvider=t}},g("slot",null))}};var Pu;(function(t){t.Play="play",t.Pause="pause",t.Seeking="seeking",t.Seeked="seeked",t.TimeUpdate="timeupdate",t.VolumeChange="volumechange",t.DurationChange="durationchange",t.FullscreenChange="fullscreenchange",t.CueChange="cuechange",t.Progress="progress",t.Error="error",t.PlaybackRateChange="playbackratechange",t.Loaded="loaded",t.BufferStart="bufferstart",t.BufferEnd="bufferend",t.TextTrackChange="texttrackchange",t.Waiting="waiting",t.Ended="ended"})(Pu||(Pu={}));const VR=":host{z-index:var(--vm-media-z-index)}vm-embed{position:absolute;top:0;left:0;width:100%;height:100%}vm-embed.hideControls{display:block;width:100%;height:auto;position:relative}";var Yt=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const Oc=new Map,FR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmLoadStart=R(this,"vmLoadStart",7),this.vmError=R(this,"vmError",7),this.defaultInternalState={},this.volume=50,this.hasLoaded=!1,this.internalState={paused:!0,playing:!1,seeking:!1,currentTime:0,buffered:0,playbackStarted:!1,playRequest:!1},this.embedSrc="",this.mediaTitle="",this.byline=!0,this.portrait=!0,this.noAutoAspectRatio=!1,this.cookies=!0,this.language="en",this.aspectRatio="16:9",this.autoplay=!1,this.controls=!1,this.loop=!1,this.muted=!1,this.playsinline=!1,X(this),fn(this),Bl(this)}onVideoIdChange(){if(this.cancelTimeUpdates(),!this.videoId){this.embedSrc="";return}this.embedSrc=`${this.getOrigin()}/video/${this.videoId}`,this.pendingDurationCall=ja(),this.pendingMediaTitleCall=ja(),this.fetchVideoInfo=this.getVideoInfo()}onCustomPosterChange(){this.dispatch("currentPoster",this.poster)}connectedCallback(){this.dispatch=zs(this),this.dispatch("viewType",zt.Video),this.onVideoIdChange(),this.defaultInternalState=Object.assign({},this.internalState)}componentWillLoad(){this.initialMuted=this.muted}disconnectedCallback(){this.cancelTimeUpdates(),this.pendingPlayRequest=void 0}getOrigin(){return"https://player.vimeo.com"}getPreconnections(){return[this.getOrigin(),"https://i.vimeocdn.com","https://f.vimeocdn.com","https://fresnel.vimeocdn.com"]}remoteControl(t,e){return this.embed.postMessage({method:t,value:e})}buildParams(){return{byline:this.byline,color:this.color,portrait:this.portrait,autopause:!1,transparent:!1,autoplay:this.autoplay,muted:this.initialMuted,playsinline:this.playsinline,dnt:!this.cookies}}getVideoInfo(){return Yt(this,void 0,void 0,function*(){return Oc.has(this.videoId)?Oc.get(this.videoId):window.fetch(`https://vimeo.com/api/oembed.json?url=${this.embedSrc}`).then(t=>t.json()).then(t=>{var e;const i=/vimeocdn.com\/video\/(.*)?_/,r={poster:`https://i.vimeocdn.com/video/${(e=t==null?void 0:t.thumbnail_url)===null||e===void 0?void 0:e.match(i)[1]}_1920x1080.jpg`,width:t==null?void 0:t.width,height:t==null?void 0:t.height};return Oc.set(this.videoId,r),r})})}onTimeChange(t){this.internalState.currentTime!==t&&(this.dispatch("currentTime",t),Math.abs(this.internalState.currentTime-t)>1.5&&(this.internalState.seeking=!0,this.dispatch("seeking",!0),this.internalState.playing&&this.internalState.buffered<t&&this.dispatch("buffering",!0),window.clearTimeout(this.pendingPlayRequest),this.internalState.paused||(this.internalState.playRequest=!0),this.remoteControl(this.internalState.playbackStarted?"pause":"play")),this.internalState.currentTime=t)}cancelTimeUpdates(){Pi(this.timeRAF)&&window.cancelAnimationFrame(this.timeRAF)}requestTimeUpdates(){this.remoteControl("getCurrentTime"),this.timeRAF=window.requestAnimationFrame(()=>{this.requestTimeUpdates()})}onSeeked(){!this.internalState.seeking||(this.dispatch("seeking",!1),this.internalState.seeking=!1,this.internalState.playRequest&&window.setTimeout(()=>{this.remoteControl("play")},150))}onVimeoMethod(t,e){var i,n;switch(t){case"getCurrentTime":this.internalState.seeking||this.onTimeChange(e);break;case"getDuration":(i=this.pendingDurationCall)===null||i===void 0||i.resolve(e);break;case"getVideoTitle":(n=this.pendingMediaTitleCall)===null||n===void 0||n.resolve(e);break}}onLoaded(){var t,e;this.hasLoaded||(this.pendingPlayRequest=void 0,this.internalState=Object.assign({},this.defaultInternalState),this.dispatch("currentSrc",this.embedSrc),this.dispatch("mediaType",oi.Video),this.remoteControl("getDuration"),this.remoteControl("getVideoTitle"),Promise.all([this.fetchVideoInfo,(t=this.pendingDurationCall)===null||t===void 0?void 0:t.promise,(e=this.pendingMediaTitleCall)===null||e===void 0?void 0:e.promise]).then(([i,n,s])=>{var r,o,a;this.requestTimeUpdates(),this.dispatch("aspectRatio",`${(r=i==null?void 0:i.width)!==null&&r!==void 0?r:16}:${(o=i==null?void 0:i.height)!==null&&o!==void 0?o:9}`),this.dispatch("currentPoster",(a=this.poster)!==null&&a!==void 0?a:i==null?void 0:i.poster),this.dispatch("duration",n!=null?n:-1),this.dispatch("mediaTitle",s),this.dispatch("playbackReady",!0)}),this.hasLoaded=!0)}onVimeoEvent(t,e){switch(t){case"ready":Object.values(Pu).forEach(i=>{this.remoteControl("addEventListener",i)});break;case"loaded":this.onLoaded();break;case"play":this.onLoaded(),this.internalState.paused=!1,this.dispatch("paused",!1);break;case"playProgress":this.internalState.playing||(this.dispatch("playing",!0),this.internalState.playing=!0,this.internalState.playbackStarted=!0,this.pendingPlayRequest=window.setTimeout(()=>{this.internalState.playRequest=!1,this.pendingPlayRequest=void 0},1e3)),this.dispatch("buffering",!1),this.onSeeked();break;case"pause":this.internalState.paused=!0,this.internalState.playing=!1,this.dispatch("paused",!0),this.dispatch("buffering",!1);break;case"loadProgress":this.internalState.buffered=e.seconds,this.dispatch("buffered",e.seconds);break;case"bufferstart":this.dispatch("buffering",!0),this.internalState.paused&&(this.internalState.paused=!1,this.dispatch("paused",!1),this.dispatch("playbackStarted",!0));break;case"bufferend":this.dispatch("buffering",!1),this.internalState.paused&&this.onSeeked();break;case"volumechange":if(e.volume>0){const i=Math.floor(e.volume*100);this.dispatch("muted",!1),this.volume!==i&&(this.volume=i,this.dispatch("volume",this.volume))}else this.dispatch("muted",!0);break;case"durationchange":this.dispatch("duration",e.duration);break;case"playbackratechange":this.dispatch("playbackRate",e.playbackRate);break;case"fullscreenchange":this.dispatch("isFullscreenActive",e.fullscreen);break;case"finish":this.loop?(this.remoteControl("setCurrentTime",0),setTimeout(()=>{this.remoteControl("play")},200)):this.dispatch("playbackEnded",!0);break;case"error":this.vmError.emit(e);break}}onEmbedSrcChange(){this.hasLoaded=!1,this.vmLoadStart.emit(),this.dispatch("viewType",zt.Video)}onEmbedMessage(t){const e=t.detail;N(e.event)||this.onVimeoEvent(e.event,e.data),N(e.method)||this.onVimeoMethod(e.method,e.value)}adjustPosition(){if(this.controls)return{};const[t,e]=this.aspectRatio.split(":").map(r=>parseInt(r,10)),i=240,n=100/t*e,s=(i-n)/(i/50);return{paddingBottom:`${i}%`,transform:`translateY(-${s+.02}%)`}}getAdapter(){return Yt(this,void 0,void 0,function*(){const t=/vimeo(?:\.com|)\/([0-9]{9,})/,e=/vimeo\.com\/external\/[0-9]+\..+/;return{getInternalPlayer:()=>Yt(this,void 0,void 0,function*(){return this.embed}),play:()=>Yt(this,void 0,void 0,function*(){this.remoteControl("play")}),pause:()=>Yt(this,void 0,void 0,function*(){this.remoteControl("pause")}),canPlay:i=>Yt(this,void 0,void 0,function*(){return _t(i)&&!e.test(i)&&t.test(i)}),setCurrentTime:i=>Yt(this,void 0,void 0,function*(){i!==this.internalState.currentTime&&this.remoteControl("setCurrentTime",i)}),setMuted:i=>Yt(this,void 0,void 0,function*(){i||(this.volume=this.volume>0?this.volume:30),this.remoteControl("setVolume",i?0:this.volume/100)}),setVolume:i=>Yt(this,void 0,void 0,function*(){this.muted?this.dispatch("volume",i):this.remoteControl("setVolume",i/100)}),canSetPlaybackRate:()=>Yt(this,void 0,void 0,function*(){return!1}),setPlaybackRate:i=>Yt(this,void 0,void 0,function*(){this.remoteControl("setPlaybackRate",i)})}})}render(){return g("vm-embed",{class:{hideControls:!this.controls},style:this.adjustPosition(),embedSrc:this.embedSrc,mediaTitle:this.mediaTitle,origin:this.getOrigin(),params:this.buildParams(),decoder:e0,preconnections:this.getPreconnections(),onVmEmbedMessage:this.onEmbedMessage.bind(this),onVmEmbedSrcChange:this.onEmbedSrcChange.bind(this),ref:t=>{this.embed=t}})}static get watchers(){return{videoId:["onVideoIdChange"],poster:["onCustomPosterChange"]}}static get style(){return VR}},UR=`.volumeControl{align-items:center;display:flex;position:relative;pointer-events:auto;box-sizing:border-box}vm-slider{width:75px;height:100%;margin:0;max-width:0;position:relative;z-index:3;transition:margin 0.2s cubic-bezier(0.4, 0, 1, 1),
    max-width 0.2s cubic-bezier(0.4, 0, 1, 1);margin-left:calc(var(--vm-control-spacing) / 2) !important;visibility:hidden}vm-slider:hover{cursor:pointer}vm-slider.hidden{display:none}vm-slider.active{max-width:75px;visibility:visible;margin:0 calc(var(--vm-control-spacing) / 2)}`;var HR=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const BR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.keyboardDisposal=new st,this.prevMuted=!1,this.currentVolume=50,this.isSliderActive=!1,this.lowVolumeIcon="volume-low",this.highVolumeIcon="volume-high",this.mutedIcon="volume-mute",this.tooltipPosition="top",this.hideTooltip=!1,this.muteKeys="m",this.noKeyboard=!1,this.muted=!1,this.volume=50,this.isMobile=!1,this.i18n={},X(this),me(this,["volume","muted","isMobile","i18n"])}onNoKeyboardChange(){return HR(this,void 0,void 0,function*(){if(this.keyboardDisposal.empty(),this.noKeyboard)return;const t=yield $i(this);N(t)||this.keyboardDisposal.add(xe(t,"keydown",e=>{if(e.key!=="ArrowUp"&&e.key!=="ArrowDown")return;const n=e.key==="ArrowUp"?Math.min(100,this.volume+5):Math.max(0,this.volume-5);this.dispatch("volume",parseInt(`${n}`,10))}))})}onPlayerVolumeChange(){this.currentVolume=this.muted?0:this.volume,!this.muted&&this.prevMuted&&this.volume===0&&this.dispatch("volume",30),this.prevMuted=this.muted}connectedCallback(){this.prevMuted=this.muted,this.dispatch=Ki(this),this.onNoKeyboardChange()}disconnectedCallback(){this.keyboardDisposal.empty()}onShowSlider(){clearTimeout(this.hideSliderTimeout),this.isSliderActive=!0}onHideSlider(){this.hideSliderTimeout=setTimeout(()=>{this.isSliderActive=!1},100)}onVolumeChange(t){const e=t.detail;this.currentVolume=e,this.dispatch("volume",e),this.dispatch("muted",e===0)}onKeyDown(t){t.key!=="ArrowLeft"&&t.key!=="ArrowRight"||t.stopPropagation()}render(){return g("div",{class:"volumeControl",onMouseEnter:this.onShowSlider.bind(this),onMouseLeave:this.onHideSlider.bind(this)},g("vm-mute-control",{keys:this.muteKeys,lowVolumeIcon:this.lowVolumeIcon,highVolumeIcon:this.highVolumeIcon,mutedIcon:this.mutedIcon,icons:this.icons,tooltipPosition:this.tooltipPosition,tooltipDirection:this.tooltipDirection,hideTooltip:this.hideTooltip,onVmFocus:this.onShowSlider.bind(this),onVmBlur:this.onHideSlider.bind(this)}),g("vm-slider",{class:{hidden:this.isMobile,active:this.isSliderActive},step:5,max:100,value:this.currentVolume,label:this.i18n.volume,onKeyDown:this.onKeyDown.bind(this),onVmFocus:this.onShowSlider.bind(this),onVmBlur:this.onHideSlider.bind(this),onVmValueChange:this.onVolumeChange.bind(this)}))}static get watchers(){return{noKeyboard:["onNoKeyboardChange"],muted:["onPlayerVolumeChange"],volume:["onPlayerVolumeChange"]}}static get style(){return UR}},$m=t=>{switch(t){case"unknown":return;case"tiny":return"144p";case"small":return"240p";case"medium":return"360p";case"large":return"480p";case"hd720":return"720p";case"hd1080":return"1080p";case"highres":return"1440p";case"max":return"2160p";default:return}},$R=":host{z-index:var(--vm-media-z-index)}";var Jt=function(t,e,i,n){function s(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(n.next(c))}catch(h){o(h)}}function l(c){try{u(n.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})};const Vc=new Map,zR=class extends HTMLElement{constructor(){super(),this.__registerHost(),ie(this),this.vmLoadStart=R(this,"vmLoadStart",7),this.defaultInternalState={},this.internalState={paused:!0,duration:0,seeking:!1,playbackReady:!1,playbackStarted:!1,currentTime:0,lastTimeUpdate:0,playbackRate:1,state:-1},this.embedSrc="",this.mediaTitle="",this.cookies=!1,this.showFullscreenControl=!0,this.language="en",this.autoplay=!1,this.controls=!1,this.loop=!1,this.muted=!1,this.playsinline=!1,X(this),fn(this),Bl(this)}onVideoIdChange(){if(!this.videoId){this.embedSrc="";return}this.embedSrc=`${this.getOrigin()}/embed/${this.videoId}`,this.fetchPosterURL=this.findPosterURL()}onCustomPosterChange(){this.dispatch("currentPoster",this.poster)}connectedCallback(){this.dispatch=zs(this),this.dispatch("viewType",zt.Video),this.onVideoIdChange(),this.defaultInternalState=Object.assign({},this.internalState)}componentWillLoad(){this.initialMuted=this.muted}getAdapter(){return Jt(this,void 0,void 0,function*(){const t=/(?:youtu\.be|youtube|youtube\.com|youtube-nocookie\.com)\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=|)((?:\w|-){11})/;return{getInternalPlayer:()=>Jt(this,void 0,void 0,function*(){return this.embed}),play:()=>Jt(this,void 0,void 0,function*(){this.remoteControl("playVideo")}),pause:()=>Jt(this,void 0,void 0,function*(){this.remoteControl("pauseVideo")}),canPlay:e=>Jt(this,void 0,void 0,function*(){return _t(e)&&t.test(e)}),setCurrentTime:e=>Jt(this,void 0,void 0,function*(){e!==this.internalState.currentTime&&this.remoteControl("seekTo",e)}),setMuted:e=>Jt(this,void 0,void 0,function*(){e?this.remoteControl("mute"):this.remoteControl("unMute")}),setVolume:e=>Jt(this,void 0,void 0,function*(){this.remoteControl("setVolume",e)}),canSetPlaybackRate:()=>Jt(this,void 0,void 0,function*(){return!0}),setPlaybackRate:e=>Jt(this,void 0,void 0,function*(){this.remoteControl("setPlaybackRate",e)})}})}getOrigin(){return this.cookies?"https://www.youtube.com":"https://www.youtube-nocookie.com"}getPreconnections(){return[this.getOrigin(),"https://www.google.com","https://googleads.g.doubleclick.net","https://static.doubleclick.net","https://s.ytimg.com","https://i.ytimg.com"]}remoteControl(t,e){return this.embed.postMessage({event:"command",func:t,args:e?[e]:void 0})}buildParams(){return{enablejsapi:1,cc_lang_pref:this.language,hl:this.language,fs:this.showFullscreenControl?1:0,controls:this.controls?1:0,disablekb:this.controls?0:1,iv_load_policy:this.controls?1:3,mute:this.initialMuted?1:0,playsinline:this.playsinline?1:0,autoplay:this.autoplay?1:0}}onEmbedSrcChange(){this.vmLoadStart.emit(),this.dispatch("viewType",zt.Video)}onEmbedLoaded(){window.setTimeout(()=>this.embed.postMessage({event:"listening"}),100)}findPosterURL(){return Jt(this,void 0,void 0,function*(){if(Vc.has(this.videoId))return Vc.get(this.videoId);const t=e=>`https://i.ytimg.com/vi/${this.videoId}/${e}.jpg`;return Pc(t("maxresdefault"),121).catch(()=>Pc(t("sddefault"),121)).catch(()=>Pc(t("hqdefault"),121)).then(e=>{const i=e.src;return Vc.set(this.videoId,i),i})})}onCued(){this.internalState.playbackReady||(this.internalState=Object.assign({},this.defaultInternalState),this.dispatch("currentSrc",this.embedSrc),this.dispatch("mediaType",oi.Video),this.fetchPosterURL.then(t=>{var e;this.dispatch("currentPoster",(e=this.poster)!==null&&e!==void 0?e:t),this.dispatch("playbackReady",!0)}),this.internalState.playbackReady=!0)}onPlayerStateChange(t){if(this.internalState.playbackReady&&t===-1){this.internalState.paused=!0,this.internalState.playbackStarted=!1,this.dispatch("buffering",!1),this.dispatch("paused",!0),this.dispatch("playbackStarted",!1);return}const e=t===1,i=t===3;switch(this.dispatch("buffering",i),this.internalState.paused&&(i||e)&&(this.internalState.paused=!1,this.dispatch("paused",!1),this.internalState.playbackStarted||(this.dispatch("playbackStarted",!0),this.internalState.playbackStarted=!0)),t){case 5:this.onCued();break;case 1:this.onCued(),this.dispatch("playing",!0);break;case 2:this.internalState.paused=!0,this.dispatch("paused",!0);break;case 0:this.loop?window.setTimeout(()=>{this.remoteControl("playVideo")},150):(this.dispatch("playbackEnded",!0),this.internalState.paused=!0,this.dispatch("paused",!0));break}this.internalState.state=t}calcCurrentTime(t){let e=t;if(this.internalState.state===0)return this.internalState.duration;if(this.internalState.state===1){const i=(Date.now()/1e3-this.defaultInternalState.lastTimeUpdate)*this.internalState.playbackRate;i>0&&(e+=Math.min(i,1))}return e}onTimeChange(t){const e=this.calcCurrentTime(t);this.dispatch("currentTime",e),Math.abs(this.internalState.currentTime-e)>1.5&&(this.internalState.seeking=!0,this.dispatch("seeking",!0)),this.internalState.currentTime=e}onBufferedChange(t){this.dispatch("buffered",t),this.internalState.seeking&&t>this.internalState.currentTime&&window.setTimeout(()=>{this.internalState.seeking=!1,this.dispatch("seeking",!1)},this.internalState.paused?100:0)}onEmbedMessage(t){const e=t.detail,{info:i}=e;!i||(Vl(i.videoData)&&this.dispatch("mediaTitle",i.videoData.title),Pi(i.duration)&&(this.internalState.duration=i.duration,this.dispatch("duration",i.duration)),za(i.availablePlaybackRates)&&this.dispatch("playbackRates",i.availablePlaybackRates),Pi(i.playbackRate)&&(this.internalState.playbackRate=i.playbackRate,this.dispatch("playbackRate",i.playbackRate)),Pi(i.currentTime)&&this.onTimeChange(i.currentTime),Pi(i.currentTimeLastUpdated)&&(this.internalState.lastTimeUpdate=i.currentTimeLastUpdated),Pi(i.videoLoadedFraction)&&this.onBufferedChange(i.videoLoadedFraction*this.internalState.duration),Pi(i.volume)&&this.dispatch("volume",i.volume),jI(i.muted)&&this.dispatch("muted",i.muted),za(i.availableQualityLevels)&&this.dispatch("playbackQualities",i.availableQualityLevels.map(n=>$m(n))),_t(i.playbackQuality)&&this.dispatch("playbackQuality",$m(i.playbackQuality)),Pi(i.playerState)&&this.onPlayerStateChange(i.playerState))}render(){return g("vm-embed",{embedSrc:this.embedSrc,mediaTitle:this.mediaTitle,origin:this.getOrigin(),params:this.buildParams(),decoder:e0,preconnections:this.getPreconnections(),onVmEmbedLoaded:this.onEmbedLoaded.bind(this),onVmEmbedMessage:this.onEmbedMessage.bind(this),onVmEmbedSrcChange:this.onEmbedSrcChange.bind(this),ref:t=>{this.embed=t}})}static get watchers(){return{cookies:["onVideoIdChange"],videoId:["onVideoIdChange"],poster:["onCustomPosterChange"]}}static get style(){return $R}},s0=Y(hA,[4,"vm-audio",{willAttach:[4,"will-attach"],crossOrigin:[1,"cross-origin"],preload:[1],disableRemotePlayback:[4,"disable-remote-playback"],mediaTitle:[1,"media-title"]}]),qs=Y(mA,[1,"vm-caption-control",{showIcon:[1,"show-icon"],hideIcon:[1,"hide-icon"],tooltipPosition:[1,"tooltip-position"],tooltipDirection:[1,"tooltip-direction"],hideTooltip:[4,"hide-tooltip"],icons:[1],keys:[1],i18n:[16],playbackReady:[4,"playback-ready"],textTracks:[16],isTextTrackVisible:[4,"is-text-track-visible"],canToggleCaptionVisibility:[32]}]),$l=Y(yA,[1,"vm-captions",{hidden:[4],isControlsActive:[4,"is-controls-active"],isVideoView:[4,"is-video-view"],playbackStarted:[4,"playback-started"],textTracks:[16],currentTextTrack:[2,"current-text-track"],isTextTrackVisible:[4,"is-text-track-visible"],isEnabled:[32],cue:[32],fontSize:[32]}]),zl=Y(kA,[1,"vm-click-to-play",{useOnMobile:[4,"use-on-mobile"],paused:[4],isVideoView:[4,"is-video-view"],isMobile:[4,"is-mobile"]}]),Ke=Y(_A,[1,"vm-control",{keys:[1],identifier:[1],hidden:[4],label:[1],menu:[1],expanded:[4],pressed:[4],isTouch:[4,"is-touch"],describedBy:[32],showTapHighlight:[32]}]),Ws=Y(EA,[1,"vm-control-group",{space:[1]}]),Ks=Y(IA,[1,"vm-control-spacer"]),Gs=Y(xA,[1,"vm-controls",{hidden:[4],fullWidth:[4,"full-width"],fullHeight:[4,"full-height"],direction:[1],align:[1],justify:[1],pin:[513],activeDuration:[2,"active-duration"],waitForPlaybackStart:[4,"wait-for-playback-start"],hideWhenPaused:[4,"hide-when-paused"],hideOnMouseLeave:[4,"hide-on-mouse-leave"],isAudioView:[4,"is-audio-view"],isSettingsActive:[4,"is-settings-active"],playbackReady:[4,"playback-ready"],isControlsActive:[4,"is-controls-active"],paused:[4],playbackStarted:[4,"playback-started"],isInteracting:[32]}]),mn=Y(MA,[1,"vm-current-time",{currentTime:[2,"current-time"],i18n:[16],alwaysShowHours:[4,"always-show-hours"]}]),r0=Y(XA,[1,"vm-dailymotion",{videoId:[1,"video-id"],shouldAutoplayQueue:[4,"should-autoplay-queue"],showUpNextQueue:[4,"show-up-next-queue"],showShareButtons:[4,"show-share-buttons"],color:[1],syndication:[1],showDailymotionLogo:[4,"show-dailymotion-logo"],showVideoInfo:[4,"show-video-info"],language:[1],autoplay:[4],controls:[4],poster:[1],logger:[16],loop:[4],muted:[4],playsinline:[4],embedSrc:[32],mediaTitle:[32]}]),o0=Y(eP,[1,"vm-dash",{src:[1],version:[1],libSrc:[1,"lib-src"],config:[16],autoplay:[4],crossOrigin:[1,"cross-origin"],preload:[1],poster:[1],controlsList:[1,"controls-list"],autoPiP:[4,"auto-pip"],disablePiP:[4,"disable-pip"],disableRemotePlayback:[4,"disable-remote-playback"],mediaTitle:[1,"media-title"],enableTextTracksByDefault:[4,"enable-text-tracks-by-default"],shouldRenderNativeTextTracks:[4,"should-render-native-text-tracks"],isTextTrackVisible:[4,"is-text-track-visible"],currentTextTrack:[2,"current-text-track"],hasAttached:[32]},[[0,"vmMediaElChange","onMediaElChange"]]]),jl=Y(iP,[1,"vm-dbl-click-fullscreen",{useOnMobile:[4,"use-on-mobile"],isFullscreenActive:[4,"is-fullscreen-active"],isVideoView:[4,"is-video-view"],playbackReady:[4,"playback-ready"],isMobile:[4,"is-mobile"],canSetFullscreen:[32]}]),ql=Y(sP,[1,"vm-default-controls",{activeDuration:[2,"active-duration"],waitForPlaybackStart:[4,"wait-for-playback-start"],hideWhenPaused:[4,"hide-when-paused"],hideOnMouseLeave:[4,"hide-on-mouse-leave"],theme:[1],isMobile:[4,"is-mobile"],isLive:[4,"is-live"],isAudioView:[4,"is-audio-view"],isVideoView:[4,"is-video-view"]}]),Wl=Y(oP,[1,"vm-default-settings",{pin:[513],i18n:[16],playbackReady:[4,"playback-ready"],playbackRate:[2,"playback-rate"],playbackRates:[16],isVideoView:[4,"is-video-view"],playbackQuality:[1,"playback-quality"],playbackQualities:[16],textTracks:[16],currentTextTrack:[2,"current-text-track"],audioTracks:[16],currentAudioTrack:[2,"current-audio-track"],isTextTrackVisible:[4,"is-text-track-visible"],canSetPlaybackRate:[32],canSetPlaybackQuality:[32],canSetTextTrack:[32],canSetAudioTrack:[32]}]),a0=Y(lP,[1,"vm-default-ui",{noClickToPlay:[4,"no-click-to-play"],noDblClickFullscreen:[4,"no-dbl-click-fullscreen"],noCaptions:[4,"no-captions"],noPoster:[4,"no-poster"],noSpinner:[4,"no-spinner"],noControls:[4,"no-controls"],noSettings:[4,"no-settings"],noLoadingScreen:[4,"no-loading-screen"]}]),pn=Y(hP,[1,"vm-embed",{embedSrc:[1,"embed-src"],mediaTitle:[1,"media-title"],params:[1],origin:[1],preconnections:[16],decoder:[16],srcWithParams:[32],hasEnteredViewport:[32]},[[8,"message","onWindowMessage"]]]),gn=Y(fP,[1,"vm-end-time",{duration:[2],i18n:[16],alwaysShowHours:[4,"always-show-hours"]}]),Ci=Y(yP,[6,"vm-file",{willAttach:[4,"will-attach"],crossOrigin:[1,"cross-origin"],preload:[1],poster:[1],mediaTitle:[1,"media-title"],controlsList:[1,"controls-list"],autoPiP:[4,"auto-pip"],disablePiP:[4,"disable-pip"],disableRemotePlayback:[4,"disable-remote-playback"],viewType:[1,"view-type"],playbackRates:[16],language:[1],autoplay:[4],controls:[4],logger:[16],loop:[4],muted:[4],playsinline:[4],noConnect:[4,"no-connect"],paused:[4],currentTime:[2,"current-time"],volume:[2],playbackReady:[4,"playback-ready"],playbackStarted:[4,"playback-started"],currentTextTrack:[2,"current-text-track"],hasCustomTextManager:[4,"has-custom-text-manager"],isTextTrackVisible:[4,"is-text-track-visible"],shouldRenderNativeTextTracks:[4,"should-render-native-text-tracks"],vmPoster:[32]},[[0,"vmMediaProviderConnect","onProviderConnect"],[0,"vmMediaProviderDisconnect","onProviderDisconnect"]]]),Qs=Y(kP,[1,"vm-fullscreen-control",{enterIcon:[1,"enter-icon"],exitIcon:[1,"exit-icon"],icons:[1],tooltipPosition:[1,"tooltip-position"],tooltipDirection:[1,"tooltip-direction"],hideTooltip:[4,"hide-tooltip"],keys:[1],isFullscreenActive:[4,"is-fullscreen-active"],i18n:[16],playbackReady:[4,"playback-ready"],canSetFullscreen:[32]}]),l0=Y(TP,[4,"vm-hls",{version:[1],libSrc:[1,"lib-src"],config:[8],crossOrigin:[1,"cross-origin"],preload:[1],poster:[1],controlsList:[1,"controls-list"],autoPiP:[4,"auto-pip"],disablePiP:[4,"disable-pip"],disableRemotePlayback:[4,"disable-remote-playback"],playbackReady:[4,"playback-ready"],mediaTitle:[1,"media-title"],hasAttached:[32]},[[0,"vmMediaElChange","onMediaElChange"],[0,"vmSrcSetChange","onSrcChange"]]]),ke=Y(xP,[1,"vm-icon",{name:[1],src:[1],label:[1],library:[1],icons:[1],svg:[32]}]),c0=Y(DP,[1,"vm-icon-library",{name:[1],resolver:[16],icons:[1]}]),Ys=Y(LP,[1,"vm-live-indicator",{isLive:[4,"is-live"],i18n:[16]}]),Kl=Y(OP,[1,"vm-loading-screen",{playbackReady:[4,"playback-ready"],hideDots:[4,"hide-dots"]}]),Ei=Y(BP,[1,"vm-menu",{active:[1540],identifier:[1],controller:[16],slideInDirection:[1,"slide-in-direction"],activeMenuItem:[32],activeSubmenu:[32]},[[0,"vmOpenSubmenu","onOpenSubmenu"],[0,"vmCloseSubmenu","onCloseSubmenu"],[8,"click","onWindowClick"],[8,"keydown","onWindowKeyDown"]]]),Si=Y(zP,[1,"vm-menu-item",{identifier:[1],hidden:[4],label:[1],menu:[16],expanded:[4],checked:[4],hint:[1],badge:[1],checkIcon:[1,"check-icon"],icons:[1],isTouch:[4,"is-touch"],showTapHighlight:[32]}]),Js=Y(jP,[1,"vm-menu-radio",{label:[1],value:[1],checked:[1028],badge:[1],checkIcon:[1,"check-icon"],icons:[1]}]),Xs=Y(qP,[1,"vm-menu-radio-group",{value:[1025]},[[0,"vmCheck","onSelectionChange"]]]),vn=Y(WP,[1,"vm-mute-control",{lowVolumeIcon:[1,"low-volume-icon"],highVolumeIcon:[1,"high-volume-icon"],mutedIcon:[1,"muted-icon"],icons:[1],tooltipPosition:[1,"tooltip-position"],tooltipDirection:[1,"tooltip-direction"],hideTooltip:[4,"hide-tooltip"],keys:[1],volume:[2],muted:[4],i18n:[16]}]),Zs=Y(QP,[1,"vm-pip-control",{enterIcon:[1,"enter-icon"],exitIcon:[1,"exit-icon"],icons:[1],tooltipPosition:[1,"tooltip-position"],tooltipDirection:[1,"tooltip-direction"],hideTooltip:[4,"hide-tooltip"],keys:[1],isPiPActive:[4,"is-pi-p-active"],i18n:[16],playbackReady:[4,"playback-ready"],canSetPiP:[32]}]),er=Y(YP,[1,"vm-playback-control",{playIcon:[1,"play-icon"],pauseIcon:[1,"pause-icon"],icons:[1],tooltipPosition:[1,"tooltip-position"],tooltipDirection:[1,"tooltip-direction"],hideTooltip:[4,"hide-tooltip"],keys:[1],paused:[4],i18n:[16]}]),u0=Y(sR,[1,"vm-player",{logger:[16],theme:[513],icons:[513],paused:[1028],playing:[1028],duration:[1026],mediaTitle:[1025,"media-title"],currentProvider:[1025,"current-provider"],currentSrc:[1025,"current-src"],currentPoster:[1025,"current-poster"],currentTime:[1026,"current-time"],autoplay:[4],ready:[1540],playbackReady:[1028,"playback-ready"],loop:[4],muted:[1028],buffered:[1026],playbackRate:[1026,"playback-rate"],playbackRates:[1040],playbackQuality:[1025,"playback-quality"],playbackQualities:[1040],seeking:[1028],debug:[4],playbackStarted:[1028,"playback-started"],playbackEnded:[1028,"playback-ended"],buffering:[1028],controls:[4],isControlsActive:[4,"is-controls-active"],isSettingsActive:[1028,"is-settings-active"],volume:[1026],isFullscreenActive:[1028,"is-fullscreen-active"],aspectRatio:[1025,"aspect-ratio"],viewType:[1025,"view-type"],isAudioView:[1028,"is-audio-view"],isVideoView:[1028,"is-video-view"],mediaType:[1025,"media-type"],isAudio:[1028,"is-audio"],isVideo:[1028,"is-video"],isLive:[1028,"is-live"],isMobile:[1028,"is-mobile"],isTouch:[1028,"is-touch"],isPiPActive:[1028,"is-pi-p-active"],textTracks:[16],currentTextTrack:[2,"current-text-track"],isTextTrackVisible:[4,"is-text-track-visible"],shouldRenderNativeTextTracks:[4,"should-render-native-text-tracks"],audioTracks:[16],currentAudioTrack:[2,"current-audio-track"],autopause:[4],playsinline:[4],language:[1025],translations:[1040],languages:[1040],i18n:[1040],container:[32]},[[0,"vmError","onError"]]]),Gl=Y(oR,[1,"vm-poster",{fit:[1],isVideoView:[4,"is-video-view"],currentPoster:[1,"current-poster"],mediaTitle:[1,"media-title"],playbackStarted:[4,"playback-started"],currentTime:[2,"current-time"],isHidden:[32],isActive:[32],hasLoaded:[32]}]),tr=Y(lR,[1,"vm-scrim",{gradient:[1],isVideoView:[4,"is-video-view"],isControlsActive:[4,"is-controls-active"]}]),ir=Y(mR,[1,"vm-scrubber-control",{alwaysShowHours:[4,"always-show-hours"],hideTooltip:[4,"hide-tooltip"],currentTime:[2,"current-time"],duration:[2],noKeyboard:[4,"no-keyboard"],buffering:[4],buffered:[2],i18n:[16],timestamp:[32],endTime:[32]}]),nr=Y(vR,[1,"vm-settings",{pin:[513],active:[1540],isMobile:[4,"is-mobile"],isAudioView:[4,"is-audio-view"],menuHeight:[32]}]),sr=Y(bR,[1,"vm-settings-control",{icon:[1],icons:[1],tooltipPosition:[1,"tooltip-position"],tooltipDirection:[1,"tooltip-direction"],menu:[1],expanded:[4],i18n:[16],hideTooltip:[4,"hide-tooltip"],vmSettings:[32]}]),h0=Y(kR,[1,"vm-skeleton",{effect:[1],ready:[4],hidden:[32]}]),Ii=Y(_R,[1,"vm-slider",{step:[2],min:[2],max:[2],value:[2],valueText:[1,"value-text"],label:[1]}]),Ql=Y(ER,[1,"vm-spinner",{isVideoView:[4,"is-video-view"],currentProvider:[1,"current-provider"],showWhenMediaLoading:[4,"show-when-media-loading"],playbackReady:[4,"playback-ready"],buffering:[4],isHidden:[32],isActive:[32]}]),rr=Y(SR,[1,"vm-submenu",{label:[1],hint:[1],slideInDirection:[1,"slide-in-direction"],active:[1540],menu:[32],controller:[32]}]),Qt=Y(AR,[1,"vm-time",{label:[1],seconds:[2],alwaysShowHours:[4,"always-show-hours"]}]),or=Y(RR,[1,"vm-time-progress",{separator:[1],alwaysShowHours:[4,"always-show-hours"]}]),Be=Y(DR,[1,"vm-tooltip",{hidden:[4],active:[4],position:[1],direction:[1],isTouch:[4,"is-touch"],isMobile:[4,"is-mobile"]}]),Yl=Y(LR,[1,"vm-ui",{isVideoView:[4,"is-video-view"],playsinline:[4],isFullscreenActive:[4,"is-fullscreen-active"]}]),ar=Y(OR,[4,"vm-video",{willAttach:[4,"will-attach"],hasCustomTextManager:[4,"has-custom-text-manager"],crossOrigin:[1,"cross-origin"],preload:[1],poster:[1],controlsList:[1,"controls-list"],autoPiP:[4,"auto-pip"],disablePiP:[4,"disable-pip"],disableRemotePlayback:[4,"disable-remote-playback"],mediaTitle:[1,"media-title"]},[[0,"vmMediaProviderConnect","onProviderConnect"],[0,"vmMediaProviderDisconnect","onProviderDisconnect"]]]),d0=Y(FR,[1,"vm-vimeo",{videoId:[1,"video-id"],byline:[4],color:[1],portrait:[4],noAutoAspectRatio:[4,"no-auto-aspect-ratio"],poster:[1],cookies:[4],language:[1],aspectRatio:[1,"aspect-ratio"],autoplay:[4],controls:[4],logger:[16],loop:[4],muted:[4],playsinline:[4],embedSrc:[32],mediaTitle:[32]}]),lr=Y(BR,[1,"vm-volume-control",{lowVolumeIcon:[1,"low-volume-icon"],highVolumeIcon:[1,"high-volume-icon"],mutedIcon:[1,"muted-icon"],icons:[1],tooltipPosition:[1,"tooltip-position"],tooltipDirection:[1,"tooltip-direction"],hideTooltip:[4,"hide-tooltip"],muteKeys:[1,"mute-keys"],noKeyboard:[4,"no-keyboard"],muted:[4],volume:[2],isMobile:[4,"is-mobile"],i18n:[16],currentVolume:[32],isSliderActive:[32]}]),f0=Y(zR,[1,"vm-youtube",{cookies:[4],videoId:[1,"video-id"],showFullscreenControl:[4,"show-fullscreen-control"],poster:[1],language:[1],autoplay:[4],controls:[4],logger:[16],loop:[4],muted:[4],playsinline:[4],embedSrc:[32],mediaTitle:[32]}]);w("vm-audio",s0);w("vm-file",Ci);w("vm-caption-control",qs);w("vm-control",Ke);w("vm-icon",ke);w("vm-tooltip",Be);w("vm-captions",$l);w("vm-click-to-play",zl);w("vm-control",Ke);w("vm-control-group",Ws);function jR(t){let e,i;const n=t[6].default,s=zi(n,t,t[5],null);return{c(){e=_("vm-control-spacer"),s&&s.c(),m(e,"class",t[0]),m(e,"style",t[1])},m(r,o){q(r,e,o),s&&s.m(e,null),t[7](e),i=!0},p(r,[o]){s&&s.p&&(!i||o&32)&&qi(s,n,r,r[5],i?ji(n,r[5],o,null):Wi(r[5]),null),(!i||o&1)&&m(e,"class",r[0]),(!i||o&2)&&m(e,"style",r[1])},i(r){i||(W(s,r),i=!0)},o(r){Z(s,r),i=!1},d(r){r&&j(e),s&&s.d(r),t[7](null)}}}w("vm-control-spacer",Ks);function qR(t,e,i){let{$$slots:n={},$$scope:s}=e,r;jt();let{class:o=""}=e,{style:a=""}=e;const l=()=>r,u=()=>r;Gt(()=>{});function c(h){Bt[h?"unshift":"push"](()=>{r=h,i(2,r)})}return t.$$set=h=>{"class"in h&&i(0,o=h.class),"style"in h&&i(1,a=h.style),"$$scope"in h&&i(5,s=h.$$scope)},[o,a,r,l,u,s,n,c]}class WR extends ot{constructor(e){super(),rt(this,e,qR,jR,Je,{class:0,style:1,ref:3,getWebComponent:4})}get ref(){return this.$$.ctx[3]}get getWebComponent(){return this.$$.ctx[4]}}function KR(t){let e,i;const n=t[23].default,s=zi(n,t,t[22],null);return{c(){e=_("vm-controls"),s&&s.c(),m(e,"class",t[0]),m(e,"style",t[1]),e.hidden=t[2],m(e,"full-width",t[3]),m(e,"full-height",t[4]),m(e,"direction",t[5]),m(e,"align",t[6]),m(e,"justify",t[7]),m(e,"pin",t[8]),m(e,"active-duration",t[9]),m(e,"wait-for-playback-start",t[10]),m(e,"hide-when-paused",t[11]),m(e,"hide-on-mouse-leave",t[12]),m(e,"is-audio-view",t[13]),m(e,"is-settings-active",t[14]),m(e,"playback-ready",t[15]),m(e,"is-controls-active",t[16]),m(e,"paused",t[17]),m(e,"playback-started",t[18])},m(r,o){q(r,e,o),s&&s.m(e,null),t[24](e),i=!0},p(r,[o]){s&&s.p&&(!i||o&4194304)&&qi(s,n,r,r[22],i?ji(n,r[22],o,null):Wi(r[22]),null),(!i||o&1)&&m(e,"class",r[0]),(!i||o&2)&&m(e,"style",r[1]),(!i||o&4)&&(e.hidden=r[2]),(!i||o&8)&&m(e,"full-width",r[3]),(!i||o&16)&&m(e,"full-height",r[4]),(!i||o&32)&&m(e,"direction",r[5]),(!i||o&64)&&m(e,"align",r[6]),(!i||o&128)&&m(e,"justify",r[7]),(!i||o&256)&&m(e,"pin",r[8]),(!i||o&512)&&m(e,"active-duration",r[9]),(!i||o&1024)&&m(e,"wait-for-playback-start",r[10]),(!i||o&2048)&&m(e,"hide-when-paused",r[11]),(!i||o&4096)&&m(e,"hide-on-mouse-leave",r[12]),(!i||o&8192)&&m(e,"is-audio-view",r[13]),(!i||o&16384)&&m(e,"is-settings-active",r[14]),(!i||o&32768)&&m(e,"playback-ready",r[15]),(!i||o&65536)&&m(e,"is-controls-active",r[16]),(!i||o&131072)&&m(e,"paused",r[17]),(!i||o&262144)&&m(e,"playback-started",r[18])},i(r){i||(W(s,r),i=!0)},o(r){Z(s,r),i=!1},d(r){r&&j(e),s&&s.d(r),t[24](null)}}}w("vm-controls",Gs);function GR(t,e,i){let{$$slots:n={},$$scope:s}=e,r;jt();let{class:o=""}=e,{style:a=""}=e,{hidden:l=!1}=e,{fullWidth:u=!1}=e,{fullHeight:c=!1}=e,{direction:h="row"}=e,{align:d="center"}=e,{justify:f="start"}=e,{pin:p="bottomLeft"}=e,{activeDuration:T=2750}=e,{waitForPlaybackStart:v=!1}=e,{hideWhenPaused:S=!1}=e,{hideOnMouseLeave:O=!1}=e,{isAudioView:I=!1}=e,{isSettingsActive:V=!1}=e,{playbackReady:G=!1}=e,{isControlsActive:P=!1}=e,{paused:ue=!0}=e,{playbackStarted:oe=!1}=e;const D=()=>r,ve=()=>r;Gt(()=>{});function Te(x){Bt[x?"unshift":"push"](()=>{r=x,i(19,r)})}return t.$$set=x=>{"class"in x&&i(0,o=x.class),"style"in x&&i(1,a=x.style),"hidden"in x&&i(2,l=x.hidden),"fullWidth"in x&&i(3,u=x.fullWidth),"fullHeight"in x&&i(4,c=x.fullHeight),"direction"in x&&i(5,h=x.direction),"align"in x&&i(6,d=x.align),"justify"in x&&i(7,f=x.justify),"pin"in x&&i(8,p=x.pin),"activeDuration"in x&&i(9,T=x.activeDuration),"waitForPlaybackStart"in x&&i(10,v=x.waitForPlaybackStart),"hideWhenPaused"in x&&i(11,S=x.hideWhenPaused),"hideOnMouseLeave"in x&&i(12,O=x.hideOnMouseLeave),"isAudioView"in x&&i(13,I=x.isAudioView),"isSettingsActive"in x&&i(14,V=x.isSettingsActive),"playbackReady"in x&&i(15,G=x.playbackReady),"isControlsActive"in x&&i(16,P=x.isControlsActive),"paused"in x&&i(17,ue=x.paused),"playbackStarted"in x&&i(18,oe=x.playbackStarted),"$$scope"in x&&i(22,s=x.$$scope)},[o,a,l,u,c,h,d,f,p,T,v,S,O,I,V,G,P,ue,oe,r,D,ve,s,n,Te]}class QR extends ot{constructor(e){super(),rt(this,e,GR,KR,Je,{class:0,style:1,hidden:2,fullWidth:3,fullHeight:4,direction:5,align:6,justify:7,pin:8,activeDuration:9,waitForPlaybackStart:10,hideWhenPaused:11,hideOnMouseLeave:12,isAudioView:13,isSettingsActive:14,playbackReady:15,isControlsActive:16,paused:17,playbackStarted:18,ref:20,getWebComponent:21})}get ref(){return this.$$.ctx[20]}get getWebComponent(){return this.$$.ctx[21]}}w("vm-current-time",mn);w("vm-time",Qt);w("vm-dailymotion",r0);w("vm-embed",pn);w("vm-dash",o0);w("vm-file",Ci);w("vm-video",ar);w("vm-dbl-click-fullscreen",jl);w("vm-default-controls",ql);w("vm-caption-control",qs);w("vm-control",Ke);w("vm-icon",ke);w("vm-tooltip",Be);w("vm-control-group",Ws);w("vm-control-spacer",Ks);w("vm-controls",Gs);w("vm-current-time",mn);w("vm-time",Qt);w("vm-end-time",gn);w("vm-fullscreen-control",Qs);w("vm-live-indicator",Ys);w("vm-mute-control",vn);w("vm-pip-control",Zs);w("vm-playback-control",er);w("vm-scrim",tr);w("vm-scrubber-control",ir);w("vm-slider",Ii);w("vm-settings-control",sr);w("vm-time-progress",or);w("vm-volume-control",lr);w("vm-default-settings",Wl);w("vm-icon",ke);w("vm-menu",Ei);w("vm-menu-item",Si);w("vm-menu-radio",Js);w("vm-menu-radio-group",Xs);w("vm-settings",nr);w("vm-submenu",rr);function YR(t){let e,i;const n=t[14].default,s=zi(n,t,t[13],null);return{c(){e=_("vm-default-ui"),s&&s.c(),m(e,"class",t[0]),m(e,"style",t[1]),m(e,"no-click-to-play",t[2]),m(e,"no-dbl-click-fullscreen",t[3]),m(e,"no-captions",t[4]),m(e,"no-poster",t[5]),m(e,"no-spinner",t[6]),m(e,"no-controls",t[7]),m(e,"no-settings",t[8]),m(e,"no-loading-screen",t[9])},m(r,o){q(r,e,o),s&&s.m(e,null),t[15](e),i=!0},p(r,[o]){s&&s.p&&(!i||o&8192)&&qi(s,n,r,r[13],i?ji(n,r[13],o,null):Wi(r[13]),null),(!i||o&1)&&m(e,"class",r[0]),(!i||o&2)&&m(e,"style",r[1]),(!i||o&4)&&m(e,"no-click-to-play",r[2]),(!i||o&8)&&m(e,"no-dbl-click-fullscreen",r[3]),(!i||o&16)&&m(e,"no-captions",r[4]),(!i||o&32)&&m(e,"no-poster",r[5]),(!i||o&64)&&m(e,"no-spinner",r[6]),(!i||o&128)&&m(e,"no-controls",r[7]),(!i||o&256)&&m(e,"no-settings",r[8]),(!i||o&512)&&m(e,"no-loading-screen",r[9])},i(r){i||(W(s,r),i=!0)},o(r){Z(s,r),i=!1},d(r){r&&j(e),s&&s.d(r),t[15](null)}}}w("vm-default-ui",a0);w("vm-caption-control",qs);w("vm-control",Ke);w("vm-icon",ke);w("vm-tooltip",Be);w("vm-captions",$l);w("vm-click-to-play",zl);w("vm-control-group",Ws);w("vm-control-spacer",Ks);w("vm-controls",Gs);w("vm-current-time",mn);w("vm-time",Qt);w("vm-dbl-click-fullscreen",jl);w("vm-default-controls",ql);w("vm-end-time",gn);w("vm-fullscreen-control",Qs);w("vm-live-indicator",Ys);w("vm-mute-control",vn);w("vm-pip-control",Zs);w("vm-playback-control",er);w("vm-scrim",tr);w("vm-scrubber-control",ir);w("vm-slider",Ii);w("vm-settings-control",sr);w("vm-time-progress",or);w("vm-volume-control",lr);w("vm-default-settings",Wl);w("vm-menu",Ei);w("vm-menu-item",Si);w("vm-menu-radio",Js);w("vm-menu-radio-group",Xs);w("vm-settings",nr);w("vm-submenu",rr);w("vm-loading-screen",Kl);w("vm-poster",Gl);w("vm-spinner",Ql);w("vm-ui",Yl);function JR(t,e,i){let{$$slots:n={},$$scope:s}=e,r;jt();let{class:o=""}=e,{style:a=""}=e,{noClickToPlay:l=!1}=e,{noDblClickFullscreen:u=!1}=e,{noCaptions:c=!1}=e,{noPoster:h=!1}=e,{noSpinner:d=!1}=e,{noControls:f=!1}=e,{noSettings:p=!1}=e,{noLoadingScreen:T=!1}=e;const v=()=>r,S=()=>r;Gt(()=>{});function O(I){Bt[I?"unshift":"push"](()=>{r=I,i(10,r)})}return t.$$set=I=>{"class"in I&&i(0,o=I.class),"style"in I&&i(1,a=I.style),"noClickToPlay"in I&&i(2,l=I.noClickToPlay),"noDblClickFullscreen"in I&&i(3,u=I.noDblClickFullscreen),"noCaptions"in I&&i(4,c=I.noCaptions),"noPoster"in I&&i(5,h=I.noPoster),"noSpinner"in I&&i(6,d=I.noSpinner),"noControls"in I&&i(7,f=I.noControls),"noSettings"in I&&i(8,p=I.noSettings),"noLoadingScreen"in I&&i(9,T=I.noLoadingScreen),"$$scope"in I&&i(13,s=I.$$scope)},[o,a,l,u,c,h,d,f,p,T,r,v,S,s,n,O]}class XR extends ot{constructor(e){super(),rt(this,e,JR,YR,Je,{class:0,style:1,noClickToPlay:2,noDblClickFullscreen:3,noCaptions:4,noPoster:5,noSpinner:6,noControls:7,noSettings:8,noLoadingScreen:9,ref:11,getWebComponent:12})}get ref(){return this.$$.ctx[11]}get getWebComponent(){return this.$$.ctx[12]}}w("vm-embed",pn);w("vm-end-time",gn);w("vm-time",Qt);w("vm-file",Ci);w("vm-fullscreen-control",Qs);w("vm-control",Ke);w("vm-icon",ke);w("vm-tooltip",Be);w("vm-hls",l0);w("vm-file",Ci);w("vm-video",ar);w("vm-icon",ke);w("vm-icon-library",c0);w("vm-live-indicator",Ys);w("vm-loading-screen",Kl);w("vm-menu",Ei);w("vm-menu-item",Si);w("vm-icon",ke);w("vm-menu-radio",Js);w("vm-icon",ke);w("vm-menu-item",Si);w("vm-menu-radio-group",Xs);function ZR(t){let e,i,n,s;const r=t[19].default,o=zi(r,t,t[18],null);return{c(){e=_("vm-mute-control"),o&&o.c(),m(e,"class",t[0]),m(e,"style",t[1]),m(e,"low-volume-icon",t[2]),m(e,"high-volume-icon",t[3]),m(e,"muted-icon",t[4]),m(e,"icons",t[5]),m(e,"tooltip-position",t[6]),m(e,"tooltip-direction",t[7]),m(e,"hide-tooltip",t[8]),m(e,"keys",t[9]),m(e,"volume",t[10]),m(e,"muted",t[11])},m(a,l){q(a,e,l),o&&o.m(e,null),t[20](e),i=!0,n||(s=[B(e,"vmFocus",t[13]),B(e,"vmBlur",t[13])],n=!0)},p(a,[l]){o&&o.p&&(!i||l&262144)&&qi(o,r,a,a[18],i?ji(r,a[18],l,null):Wi(a[18]),null),(!i||l&1)&&m(e,"class",a[0]),(!i||l&2)&&m(e,"style",a[1]),(!i||l&4)&&m(e,"low-volume-icon",a[2]),(!i||l&8)&&m(e,"high-volume-icon",a[3]),(!i||l&16)&&m(e,"muted-icon",a[4]),(!i||l&32)&&m(e,"icons",a[5]),(!i||l&64)&&m(e,"tooltip-position",a[6]),(!i||l&128)&&m(e,"tooltip-direction",a[7]),(!i||l&256)&&m(e,"hide-tooltip",a[8]),(!i||l&512)&&m(e,"keys",a[9]),(!i||l&1024)&&m(e,"volume",a[10]),(!i||l&2048)&&m(e,"muted",a[11])},i(a){i||(W(o,a),i=!0)},o(a){Z(o,a),i=!1},d(a){a&&j(e),o&&o.d(a),t[20](null),n=!1,ki(s)}}}w("vm-mute-control",vn);w("vm-control",Ke);w("vm-icon",ke);w("vm-tooltip",Be);function ex(t,e,i){let{$$slots:n={},$$scope:s}=e,r,o=!1;const a=jt();let{class:l=""}=e,{style:u=""}=e,{lowVolumeIcon:c="volume-low"}=e,{highVolumeIcon:h="volume-high"}=e,{mutedIcon:d="volume-mute"}=e,{icons:f=void 0}=e,{tooltipPosition:p="top"}=e,{tooltipDirection:T=void 0}=e,{hideTooltip:v=!1}=e,{keys:S="m"}=e,{volume:O=50}=e,{muted:I=!1}=e,{i18n:V={}}=e;const G=()=>r,P=()=>r;Gt(()=>{i(17,o=!0)});const ue=D=>{D.stopPropagation(),a(D.type,D.detail)};function oe(D){Bt[D?"unshift":"push"](()=>{r=D,i(12,r)})}return t.$$set=D=>{"class"in D&&i(0,l=D.class),"style"in D&&i(1,u=D.style),"lowVolumeIcon"in D&&i(2,c=D.lowVolumeIcon),"highVolumeIcon"in D&&i(3,h=D.highVolumeIcon),"mutedIcon"in D&&i(4,d=D.mutedIcon),"icons"in D&&i(5,f=D.icons),"tooltipPosition"in D&&i(6,p=D.tooltipPosition),"tooltipDirection"in D&&i(7,T=D.tooltipDirection),"hideTooltip"in D&&i(8,v=D.hideTooltip),"keys"in D&&i(9,S=D.keys),"volume"in D&&i(10,O=D.volume),"muted"in D&&i(11,I=D.muted),"i18n"in D&&i(14,V=D.i18n),"$$scope"in D&&i(18,s=D.$$scope)},t.$$.update=()=>{t.$$.dirty&151552&&o&&Ai(r,"i18n",V)},[l,u,c,h,d,f,p,T,v,S,O,I,r,ue,V,G,P,o,s,n,oe]}class tx extends ot{constructor(e){super(),rt(this,e,ex,ZR,Je,{class:0,style:1,lowVolumeIcon:2,highVolumeIcon:3,mutedIcon:4,icons:5,tooltipPosition:6,tooltipDirection:7,hideTooltip:8,keys:9,volume:10,muted:11,i18n:14,ref:15,getWebComponent:16})}get ref(){return this.$$.ctx[15]}get getWebComponent(){return this.$$.ctx[16]}}w("vm-pip-control",Zs);w("vm-control",Ke);w("vm-icon",ke);w("vm-tooltip",Be);w("vm-playback-control",er);w("vm-control",Ke);w("vm-icon",ke);w("vm-tooltip",Be);function ix(t){let e,i,n,s;const r=t[86].default,o=zi(r,t,t[85],null);return{c(){e=_("vm-player"),o&&o.c(),m(e,"class",t[0]),m(e,"style",t[1]),m(e,"theme",t[2]),m(e,"icons",t[3]),m(e,"paused",t[4]),m(e,"playing",t[5]),m(e,"duration",t[6]),m(e,"media-title",t[7]),m(e,"current-provider",t[8]),m(e,"current-src",t[9]),m(e,"current-poster",t[10]),m(e,"current-time",t[11]),m(e,"autoplay",t[12]),m(e,"ready",t[13]),m(e,"playback-ready",t[14]),m(e,"loop",t[15]),m(e,"muted",t[16]),m(e,"buffered",t[17]),m(e,"playback-rate",t[18]),m(e,"playback-quality",t[19]),m(e,"seeking",t[20]),m(e,"debug",t[21]),m(e,"playback-started",t[22]),m(e,"playback-ended",t[23]),m(e,"buffering",t[24]),m(e,"controls",t[25]),m(e,"is-controls-active",t[26]),m(e,"is-settings-active",t[27]),m(e,"volume",t[28]),m(e,"is-fullscreen-active",t[29]),m(e,"aspect-ratio",t[30]),m(e,"view-type",t[31]),m(e,"is-audio-view",t[32]),m(e,"is-video-view",t[33]),m(e,"media-type",t[34]),m(e,"is-audio",t[35]),m(e,"is-video",t[36]),m(e,"is-live",t[37]),m(e,"is-mobile",t[38]),m(e,"is-touch",t[39]),m(e,"is-pi-p-active",t[40]),m(e,"current-text-track",t[41]),m(e,"is-text-track-visible",t[42]),m(e,"should-render-native-text-tracks",t[43]),m(e,"current-audio-track",t[44]),m(e,"autopause",t[45]),m(e,"playsinline",t[46]),m(e,"language",t[47])},m(a,l){q(a,e,l),o&&o.m(e,null),t[87](e),i=!0,n||(s=[B(e,"vmThemeChange",t[49]),B(e,"vmPausedChange",t[49]),B(e,"vmPlay",t[49]),B(e,"vmPlayingChange",t[49]),B(e,"vmSeekingChange",t[49]),B(e,"vmSeeked",t[49]),B(e,"vmBufferingChange",t[49]),B(e,"vmDurationChange",t[49]),B(e,"vmCurrentTimeChange",t[49]),B(e,"vmReady",t[49]),B(e,"vmPlaybackReady",t[49]),B(e,"vmPlaybackStarted",t[49]),B(e,"vmPlaybackEnded",t[49]),B(e,"vmBufferedChange",t[49]),B(e,"vmError",t[49]),B(e,"vmLoadStart",t[49]),B(e,"vmCurrentProviderChange",t[49]),B(e,"vmCurrentSrcChange",t[49]),B(e,"vmCurrentPosterChange",t[49]),B(e,"vmMediaTitleChange",t[49]),B(e,"vmControlsChange",t[49]),B(e,"vmPlaybackRateChange",t[49]),B(e,"vmPlaybackRatesChange",t[49]),B(e,"vmPlaybackQualityChange",t[49]),B(e,"vmPlaybackQualitiesChange",t[49]),B(e,"vmMutedChange",t[49]),B(e,"vmVolumeChange",t[49]),B(e,"vmViewTypeChange",t[49]),B(e,"vmMediaTypeChange",t[49]),B(e,"vmLiveChange",t[49]),B(e,"vmTouchChange",t[49]),B(e,"vmLanguageChange",t[49]),B(e,"vmI18nChange",t[49]),B(e,"vmTranslationsChange",t[49]),B(e,"vmLanguagesChange",t[49]),B(e,"vmFullscreenChange",t[49]),B(e,"vmPiPChange",t[49]),B(e,"vmTextTracksChange",t[49]),B(e,"vmCurrentTextTrackChange",t[49]),B(e,"vmTextTrackVisibleChange",t[49]),B(e,"vmAudioTracksChange",t[49]),B(e,"vmCurrentAudioTrackChange",t[49])],n=!0)},p(a,l){o&&o.p&&(!i||l[2]&8388608)&&qi(o,r,a,a[85],i?ji(r,a[85],l,null):Wi(a[85]),null),(!i||l[0]&1)&&m(e,"class",a[0]),(!i||l[0]&2)&&m(e,"style",a[1]),(!i||l[0]&4)&&m(e,"theme",a[2]),(!i||l[0]&8)&&m(e,"icons",a[3]),(!i||l[0]&16)&&m(e,"paused",a[4]),(!i||l[0]&32)&&m(e,"playing",a[5]),(!i||l[0]&64)&&m(e,"duration",a[6]),(!i||l[0]&128)&&m(e,"media-title",a[7]),(!i||l[0]&256)&&m(e,"current-provider",a[8]),(!i||l[0]&512)&&m(e,"current-src",a[9]),(!i||l[0]&1024)&&m(e,"current-poster",a[10]),(!i||l[0]&2048)&&m(e,"current-time",a[11]),(!i||l[0]&4096)&&m(e,"autoplay",a[12]),(!i||l[0]&8192)&&m(e,"ready",a[13]),(!i||l[0]&16384)&&m(e,"playback-ready",a[14]),(!i||l[0]&32768)&&m(e,"loop",a[15]),(!i||l[0]&65536)&&m(e,"muted",a[16]),(!i||l[0]&131072)&&m(e,"buffered",a[17]),(!i||l[0]&262144)&&m(e,"playback-rate",a[18]),(!i||l[0]&524288)&&m(e,"playback-quality",a[19]),(!i||l[0]&1048576)&&m(e,"seeking",a[20]),(!i||l[0]&2097152)&&m(e,"debug",a[21]),(!i||l[0]&4194304)&&m(e,"playback-started",a[22]),(!i||l[0]&8388608)&&m(e,"playback-ended",a[23]),(!i||l[0]&16777216)&&m(e,"buffering",a[24]),(!i||l[0]&33554432)&&m(e,"controls",a[25]),(!i||l[0]&67108864)&&m(e,"is-controls-active",a[26]),(!i||l[0]&134217728)&&m(e,"is-settings-active",a[27]),(!i||l[0]&268435456)&&m(e,"volume",a[28]),(!i||l[0]&536870912)&&m(e,"is-fullscreen-active",a[29]),(!i||l[0]&1073741824)&&m(e,"aspect-ratio",a[30]),(!i||l[1]&1)&&m(e,"view-type",a[31]),(!i||l[1]&2)&&m(e,"is-audio-view",a[32]),(!i||l[1]&4)&&m(e,"is-video-view",a[33]),(!i||l[1]&8)&&m(e,"media-type",a[34]),(!i||l[1]&16)&&m(e,"is-audio",a[35]),(!i||l[1]&32)&&m(e,"is-video",a[36]),(!i||l[1]&64)&&m(e,"is-live",a[37]),(!i||l[1]&128)&&m(e,"is-mobile",a[38]),(!i||l[1]&256)&&m(e,"is-touch",a[39]),(!i||l[1]&512)&&m(e,"is-pi-p-active",a[40]),(!i||l[1]&1024)&&m(e,"current-text-track",a[41]),(!i||l[1]&2048)&&m(e,"is-text-track-visible",a[42]),(!i||l[1]&4096)&&m(e,"should-render-native-text-tracks",a[43]),(!i||l[1]&8192)&&m(e,"current-audio-track",a[44]),(!i||l[1]&16384)&&m(e,"autopause",a[45]),(!i||l[1]&32768)&&m(e,"playsinline",a[46]),(!i||l[1]&65536)&&m(e,"language",a[47])},i(a){i||(W(o,a),i=!0)},o(a){Z(o,a),i=!1},d(a){a&&j(e),o&&o.d(a),t[87](null),n=!1,ki(s)}}}w("vm-player",u0);function nx(t,e,i){let{$$slots:n={},$$scope:s}=e,r,o=!1;const a=jt();let{class:l=""}=e,{style:u=""}=e,{logger:c=void 0}=e,{theme:h=void 0}=e,{icons:d="vime"}=e,{paused:f=!0}=e,{playing:p=!1}=e,{duration:T=-1}=e,{mediaTitle:v=void 0}=e,{currentProvider:S=void 0}=e,{currentSrc:O=void 0}=e,{currentPoster:I=void 0}=e,{currentTime:V=0}=e,{autoplay:G=!1}=e,{ready:P=!1}=e,{playbackReady:ue=!1}=e,{loop:oe=!1}=e,{muted:D=!1}=e,{buffered:ve=0}=e,{playbackRate:Te=1}=e,{playbackRates:x=[1]}=e,{playbackQuality:he=void 0}=e,{playbackQualities:ge=[]}=e,{seeking:Fe=!1}=e,{debug:ze=!1}=e,{playbackStarted:De=!1}=e,{playbackEnded:$e=!1}=e,{buffering:lt=!1}=e,{controls:Xe=!1}=e,{isControlsActive:Ze=!1}=e,{isSettingsActive:Me=!1}=e,{volume:Le=50}=e,{isFullscreenActive:ae=!1}=e,{aspectRatio:et="16:9"}=e,{viewType:de=void 0}=e,{isAudioView:Q=!1}=e,{isVideoView:se=!1}=e,{mediaType:re=void 0}=e,{isAudio:F=!1}=e,{isVideo:U=!1}=e,{isLive:_e=!1}=e,{isMobile:ct=!1}=e,{isTouch:Ne=!1}=e,{isPiPActive:ai=!1}=e,{textTracks:yn=[]}=e,{currentTextTrack:cr=-1}=e,{isTextTrackVisible:qt=!0}=e,{shouldRenderNativeTextTracks:bn=!0}=e,{audioTracks:jn=[]}=e,{currentAudioTrack:hd=-1}=e,{autopause:dd=!0}=e,{playsinline:fd=!1}=e,{language:md="en"}=e,{translations:qn=void 0}=e,{languages:Jl=["en"]}=e,{i18n:Wn=void 0}=e;const m0=(...y)=>r.getProvider(...y),p0=(...y)=>r.getAdapter(...y),g0=(...y)=>r.play(...y),v0=(...y)=>r.pause(...y),y0=(...y)=>r.canPlay(...y),b0=(...y)=>r.canAutoplay(...y),w0=(...y)=>r.canMutedAutoplay(...y),k0=(...y)=>r.canSetPlaybackRate(...y),T0=(...y)=>r.canSetPlaybackQuality(...y),_0=(...y)=>r.canSetFullscreen(...y),C0=(...y)=>r.enterFullscreen(...y),E0=(...y)=>r.exitFullscreen(...y),S0=(...y)=>r.canSetPiP(...y),I0=(...y)=>r.enterPiP(...y),A0=(...y)=>r.exitPiP(...y),P0=(...y)=>r.canSetAudioTrack(...y),R0=(...y)=>r.setCurrentAudioTrack(...y),x0=(...y)=>r.canSetTextTrack(...y),D0=(...y)=>r.setCurrentTextTrack(...y),M0=(...y)=>r.canSetTextTrackVisibility(...y),L0=(...y)=>r.setTextTrackVisibility(...y),N0=(...y)=>r.extendLanguage(...y),O0=(...y)=>r.getContainer(...y),V0=(...y)=>r.callAdapter(...y),F0=()=>r,U0=()=>r;Gt(()=>{i(50,c=c===void 0?r.logger:c),i(51,qn=qn===void 0?r.translations:qn),i(52,Wn=Wn===void 0?r.i18n:Wn),i(84,o=!0)});const H0=y=>{y.stopPropagation(),a(y.type,y.detail)};function B0(y){Bt[y?"unshift":"push"](()=>{r=y,i(48,r)})}return t.$$set=y=>{"class"in y&&i(0,l=y.class),"style"in y&&i(1,u=y.style),"logger"in y&&i(50,c=y.logger),"theme"in y&&i(2,h=y.theme),"icons"in y&&i(3,d=y.icons),"paused"in y&&i(4,f=y.paused),"playing"in y&&i(5,p=y.playing),"duration"in y&&i(6,T=y.duration),"mediaTitle"in y&&i(7,v=y.mediaTitle),"currentProvider"in y&&i(8,S=y.currentProvider),"currentSrc"in y&&i(9,O=y.currentSrc),"currentPoster"in y&&i(10,I=y.currentPoster),"currentTime"in y&&i(11,V=y.currentTime),"autoplay"in y&&i(12,G=y.autoplay),"ready"in y&&i(13,P=y.ready),"playbackReady"in y&&i(14,ue=y.playbackReady),"loop"in y&&i(15,oe=y.loop),"muted"in y&&i(16,D=y.muted),"buffered"in y&&i(17,ve=y.buffered),"playbackRate"in y&&i(18,Te=y.playbackRate),"playbackRates"in y&&i(53,x=y.playbackRates),"playbackQuality"in y&&i(19,he=y.playbackQuality),"playbackQualities"in y&&i(54,ge=y.playbackQualities),"seeking"in y&&i(20,Fe=y.seeking),"debug"in y&&i(21,ze=y.debug),"playbackStarted"in y&&i(22,De=y.playbackStarted),"playbackEnded"in y&&i(23,$e=y.playbackEnded),"buffering"in y&&i(24,lt=y.buffering),"controls"in y&&i(25,Xe=y.controls),"isControlsActive"in y&&i(26,Ze=y.isControlsActive),"isSettingsActive"in y&&i(27,Me=y.isSettingsActive),"volume"in y&&i(28,Le=y.volume),"isFullscreenActive"in y&&i(29,ae=y.isFullscreenActive),"aspectRatio"in y&&i(30,et=y.aspectRatio),"viewType"in y&&i(31,de=y.viewType),"isAudioView"in y&&i(32,Q=y.isAudioView),"isVideoView"in y&&i(33,se=y.isVideoView),"mediaType"in y&&i(34,re=y.mediaType),"isAudio"in y&&i(35,F=y.isAudio),"isVideo"in y&&i(36,U=y.isVideo),"isLive"in y&&i(37,_e=y.isLive),"isMobile"in y&&i(38,ct=y.isMobile),"isTouch"in y&&i(39,Ne=y.isTouch),"isPiPActive"in y&&i(40,ai=y.isPiPActive),"textTracks"in y&&i(55,yn=y.textTracks),"currentTextTrack"in y&&i(41,cr=y.currentTextTrack),"isTextTrackVisible"in y&&i(42,qt=y.isTextTrackVisible),"shouldRenderNativeTextTracks"in y&&i(43,bn=y.shouldRenderNativeTextTracks),"audioTracks"in y&&i(56,jn=y.audioTracks),"currentAudioTrack"in y&&i(44,hd=y.currentAudioTrack),"autopause"in y&&i(45,dd=y.autopause),"playsinline"in y&&i(46,fd=y.playsinline),"language"in y&&i(47,md=y.language),"translations"in y&&i(51,qn=y.translations),"languages"in y&&i(57,Jl=y.languages),"i18n"in y&&i(52,Wn=y.i18n),"$$scope"in y&&i(85,s=y.$$scope)},t.$$.update=()=>{t.$$.dirty[1]&655360|t.$$.dirty[2]&4194304&&o&&Ai(r,"logger",c),t.$$.dirty[1]&4325376|t.$$.dirty[2]&4194304&&o&&Ai(r,"playbackRates",x),t.$$.dirty[1]&8519680|t.$$.dirty[2]&4194304&&o&&Ai(r,"playbackQualities",ge),t.$$.dirty[1]&16908288|t.$$.dirty[2]&4194304&&o&&Ai(r,"textTracks",yn),t.$$.dirty[1]&33685504|t.$$.dirty[2]&4194304&&o&&Ai(r,"audioTracks",jn),t.$$.dirty[1]&1179648|t.$$.dirty[2]&4194304&&o&&Ai(r,"translations",qn),t.$$.dirty[1]&67239936|t.$$.dirty[2]&4194304&&o&&Ai(r,"languages",Jl),t.$$.dirty[1]&2228224|t.$$.dirty[2]&4194304&&o&&Ai(r,"i18n",Wn)},[l,u,h,d,f,p,T,v,S,O,I,V,G,P,ue,oe,D,ve,Te,he,Fe,ze,De,$e,lt,Xe,Ze,Me,Le,ae,et,de,Q,se,re,F,U,_e,ct,Ne,ai,cr,qt,bn,hd,dd,fd,md,r,H0,c,qn,Wn,x,ge,yn,jn,Jl,m0,p0,g0,v0,y0,b0,w0,k0,T0,_0,C0,E0,S0,I0,A0,P0,R0,x0,D0,M0,L0,N0,O0,V0,F0,U0,o,s,n,B0]}class sx extends ot{constructor(e){super(),rt(this,e,nx,ix,Je,{class:0,style:1,logger:50,theme:2,icons:3,paused:4,playing:5,duration:6,mediaTitle:7,currentProvider:8,currentSrc:9,currentPoster:10,currentTime:11,autoplay:12,ready:13,playbackReady:14,loop:15,muted:16,buffered:17,playbackRate:18,playbackRates:53,playbackQuality:19,playbackQualities:54,seeking:20,debug:21,playbackStarted:22,playbackEnded:23,buffering:24,controls:25,isControlsActive:26,isSettingsActive:27,volume:28,isFullscreenActive:29,aspectRatio:30,viewType:31,isAudioView:32,isVideoView:33,mediaType:34,isAudio:35,isVideo:36,isLive:37,isMobile:38,isTouch:39,isPiPActive:40,textTracks:55,currentTextTrack:41,isTextTrackVisible:42,shouldRenderNativeTextTracks:43,audioTracks:56,currentAudioTrack:44,autopause:45,playsinline:46,language:47,translations:51,languages:57,i18n:52,getProvider:58,getAdapter:59,play:60,pause:61,canPlay:62,canAutoplay:63,canMutedAutoplay:64,canSetPlaybackRate:65,canSetPlaybackQuality:66,canSetFullscreen:67,enterFullscreen:68,exitFullscreen:69,canSetPiP:70,enterPiP:71,exitPiP:72,canSetAudioTrack:73,setCurrentAudioTrack:74,canSetTextTrack:75,setCurrentTextTrack:76,canSetTextTrackVisibility:77,setTextTrackVisibility:78,extendLanguage:79,getContainer:80,callAdapter:81,ref:82,getWebComponent:83},null,[-1,-1,-1])}get getProvider(){return this.$$.ctx[58]}get getAdapter(){return this.$$.ctx[59]}get play(){return this.$$.ctx[60]}get pause(){return this.$$.ctx[61]}get canPlay(){return this.$$.ctx[62]}get canAutoplay(){return this.$$.ctx[63]}get canMutedAutoplay(){return this.$$.ctx[64]}get canSetPlaybackRate(){return this.$$.ctx[65]}get canSetPlaybackQuality(){return this.$$.ctx[66]}get canSetFullscreen(){return this.$$.ctx[67]}get enterFullscreen(){return this.$$.ctx[68]}get exitFullscreen(){return this.$$.ctx[69]}get canSetPiP(){return this.$$.ctx[70]}get enterPiP(){return this.$$.ctx[71]}get exitPiP(){return this.$$.ctx[72]}get canSetAudioTrack(){return this.$$.ctx[73]}get setCurrentAudioTrack(){return this.$$.ctx[74]}get canSetTextTrack(){return this.$$.ctx[75]}get setCurrentTextTrack(){return this.$$.ctx[76]}get canSetTextTrackVisibility(){return this.$$.ctx[77]}get setTextTrackVisibility(){return this.$$.ctx[78]}get extendLanguage(){return this.$$.ctx[79]}get getContainer(){return this.$$.ctx[80]}get callAdapter(){return this.$$.ctx[81]}get ref(){return this.$$.ctx[82]}get getWebComponent(){return this.$$.ctx[83]}}w("vm-poster",Gl);function rx(t){let e,i;const n=t[9].default,s=zi(n,t,t[8],null);return{c(){e=_("vm-scrim"),s&&s.c(),m(e,"class",t[0]),m(e,"style",t[1]),m(e,"gradient",t[2]),m(e,"is-video-view",t[3]),m(e,"is-controls-active",t[4])},m(r,o){q(r,e,o),s&&s.m(e,null),t[10](e),i=!0},p(r,[o]){s&&s.p&&(!i||o&256)&&qi(s,n,r,r[8],i?ji(n,r[8],o,null):Wi(r[8]),null),(!i||o&1)&&m(e,"class",r[0]),(!i||o&2)&&m(e,"style",r[1]),(!i||o&4)&&m(e,"gradient",r[2]),(!i||o&8)&&m(e,"is-video-view",r[3]),(!i||o&16)&&m(e,"is-controls-active",r[4])},i(r){i||(W(s,r),i=!0)},o(r){Z(s,r),i=!1},d(r){r&&j(e),s&&s.d(r),t[10](null)}}}w("vm-scrim",tr);function ox(t,e,i){let{$$slots:n={},$$scope:s}=e,r;jt();let{class:o=""}=e,{style:a=""}=e,{gradient:l=void 0}=e,{isVideoView:u=!1}=e,{isControlsActive:c=!1}=e;const h=()=>r,d=()=>r;Gt(()=>{});function f(p){Bt[p?"unshift":"push"](()=>{r=p,i(5,r)})}return t.$$set=p=>{"class"in p&&i(0,o=p.class),"style"in p&&i(1,a=p.style),"gradient"in p&&i(2,l=p.gradient),"isVideoView"in p&&i(3,u=p.isVideoView),"isControlsActive"in p&&i(4,c=p.isControlsActive),"$$scope"in p&&i(8,s=p.$$scope)},[o,a,l,u,c,r,h,d,s,n,f]}class ax extends ot{constructor(e){super(),rt(this,e,ox,rx,Je,{class:0,style:1,gradient:2,isVideoView:3,isControlsActive:4,ref:6,getWebComponent:7})}get ref(){return this.$$.ctx[6]}get getWebComponent(){return this.$$.ctx[7]}}w("vm-scrubber-control",ir);w("vm-slider",Ii);w("vm-tooltip",Be);w("vm-settings",nr);w("vm-menu",Ei);w("vm-settings-control",sr);w("vm-control",Ke);w("vm-icon",ke);w("vm-tooltip",Be);w("vm-skeleton",h0);w("vm-slider",Ii);w("vm-spinner",Ql);w("vm-submenu",rr);w("vm-icon",ke);w("vm-menu",Ei);w("vm-menu-item",Si);w("vm-time",Qt);function lx(t){let e,i;const n=t[8].default,s=zi(n,t,t[7],null);return{c(){e=_("vm-time-progress"),s&&s.c(),m(e,"class",t[0]),m(e,"style",t[1]),m(e,"separator",t[2]),m(e,"always-show-hours",t[3])},m(r,o){q(r,e,o),s&&s.m(e,null),t[9](e),i=!0},p(r,[o]){s&&s.p&&(!i||o&128)&&qi(s,n,r,r[7],i?ji(n,r[7],o,null):Wi(r[7]),null),(!i||o&1)&&m(e,"class",r[0]),(!i||o&2)&&m(e,"style",r[1]),(!i||o&4)&&m(e,"separator",r[2]),(!i||o&8)&&m(e,"always-show-hours",r[3])},i(r){i||(W(s,r),i=!0)},o(r){Z(s,r),i=!1},d(r){r&&j(e),s&&s.d(r),t[9](null)}}}w("vm-time-progress",or);w("vm-current-time",mn);w("vm-time",Qt);w("vm-end-time",gn);function cx(t,e,i){let{$$slots:n={},$$scope:s}=e,r;jt();let{class:o=""}=e,{style:a=""}=e,{separator:l="/"}=e,{alwaysShowHours:u=!1}=e;const c=()=>r,h=()=>r;Gt(()=>{});function d(f){Bt[f?"unshift":"push"](()=>{r=f,i(4,r)})}return t.$$set=f=>{"class"in f&&i(0,o=f.class),"style"in f&&i(1,a=f.style),"separator"in f&&i(2,l=f.separator),"alwaysShowHours"in f&&i(3,u=f.alwaysShowHours),"$$scope"in f&&i(7,s=f.$$scope)},[o,a,l,u,r,c,h,s,n,d]}class ux extends ot{constructor(e){super(),rt(this,e,cx,lx,Je,{class:0,style:1,separator:2,alwaysShowHours:3,ref:5,getWebComponent:6})}get ref(){return this.$$.ctx[5]}get getWebComponent(){return this.$$.ctx[6]}}w("vm-tooltip",Be);w("vm-ui",Yl);function hx(t){let e,i;const n=t[17].default,s=zi(n,t,t[16],null);return{c(){e=_("vm-video"),s&&s.c(),m(e,"class",t[0]),m(e,"style",t[1]),m(e,"will-attach",t[2]),m(e,"has-custom-text-manager",t[3]),m(e,"cross-origin",t[4]),m(e,"preload",t[5]),m(e,"poster",t[6]),m(e,"controls-list",t[7]),m(e,"auto-pip",t[8]),m(e,"disable-pip",t[9]),m(e,"disable-remote-playback",t[10]),m(e,"media-title",t[11])},m(r,o){q(r,e,o),s&&s.m(e,null),t[18](e),i=!0},p(r,[o]){s&&s.p&&(!i||o&65536)&&qi(s,n,r,r[16],i?ji(n,r[16],o,null):Wi(r[16]),null),(!i||o&1)&&m(e,"class",r[0]),(!i||o&2)&&m(e,"style",r[1]),(!i||o&4)&&m(e,"will-attach",r[2]),(!i||o&8)&&m(e,"has-custom-text-manager",r[3]),(!i||o&16)&&m(e,"cross-origin",r[4]),(!i||o&32)&&m(e,"preload",r[5]),(!i||o&64)&&m(e,"poster",r[6]),(!i||o&128)&&m(e,"controls-list",r[7]),(!i||o&256)&&m(e,"auto-pip",r[8]),(!i||o&512)&&m(e,"disable-pip",r[9]),(!i||o&1024)&&m(e,"disable-remote-playback",r[10]),(!i||o&2048)&&m(e,"media-title",r[11])},i(r){i||(W(s,r),i=!0)},o(r){Z(s,r),i=!1},d(r){r&&j(e),s&&s.d(r),t[18](null)}}}w("vm-video",ar);w("vm-file",Ci);function dx(t,e,i){let{$$slots:n={},$$scope:s}=e,r;jt();let{class:o=""}=e,{style:a=""}=e,{willAttach:l=!1}=e,{hasCustomTextManager:u=!1}=e,{crossOrigin:c=void 0}=e,{preload:h="metadata"}=e,{poster:d=void 0}=e,{controlsList:f=void 0}=e,{autoPiP:p=void 0}=e,{disablePiP:T=void 0}=e,{disableRemotePlayback:v=void 0}=e,{mediaTitle:S=void 0}=e;const O=(...P)=>r.getAdapter(...P),I=()=>r,V=()=>r;Gt(()=>{});function G(P){Bt[P?"unshift":"push"](()=>{r=P,i(12,r)})}return t.$$set=P=>{"class"in P&&i(0,o=P.class),"style"in P&&i(1,a=P.style),"willAttach"in P&&i(2,l=P.willAttach),"hasCustomTextManager"in P&&i(3,u=P.hasCustomTextManager),"crossOrigin"in P&&i(4,c=P.crossOrigin),"preload"in P&&i(5,h=P.preload),"poster"in P&&i(6,d=P.poster),"controlsList"in P&&i(7,f=P.controlsList),"autoPiP"in P&&i(8,p=P.autoPiP),"disablePiP"in P&&i(9,T=P.disablePiP),"disableRemotePlayback"in P&&i(10,v=P.disableRemotePlayback),"mediaTitle"in P&&i(11,S=P.mediaTitle),"$$scope"in P&&i(16,s=P.$$scope)},[o,a,l,u,c,h,d,f,p,T,v,S,r,O,I,V,s,n,G]}class fx extends ot{constructor(e){super(),rt(this,e,dx,hx,Je,{class:0,style:1,willAttach:2,hasCustomTextManager:3,crossOrigin:4,preload:5,poster:6,controlsList:7,autoPiP:8,disablePiP:9,disableRemotePlayback:10,mediaTitle:11,getAdapter:13,ref:14,getWebComponent:15})}get getAdapter(){return this.$$.ctx[13]}get ref(){return this.$$.ctx[14]}get getWebComponent(){return this.$$.ctx[15]}}w("vm-vimeo",d0);w("vm-embed",pn);w("vm-volume-control",lr);w("vm-control",Ke);w("vm-icon",ke);w("vm-mute-control",vn);w("vm-tooltip",Be);w("vm-slider",Ii);w("vm-youtube",f0);w("vm-embed",pn);const ud=WR,zm=QR,mx=XR,px=tx,gx=sx,vx=ax,yx=ux,bx=fx,k=(t,e)=>{typeof window!="undefined"&&!customElements.get(t)&&customElements.define(t,e)};k("vm-audio",s0);k("vm-file",Ci);k("vm-caption-control",qs);k("vm-control",Ke);k("vm-icon",ke);k("vm-tooltip",Be);k("vm-captions",$l);k("vm-click-to-play",zl);k("vm-control",Ke);k("vm-control-group",Ws);k("vm-control-spacer",Ks);k("vm-controls",Gs);k("vm-current-time",mn);k("vm-time",Qt);k("vm-dailymotion",r0);k("vm-embed",pn);k("vm-dash",o0);k("vm-file",Ci);k("vm-video",ar);k("vm-dbl-click-fullscreen",jl);k("vm-default-controls",ql);k("vm-caption-control",qs);k("vm-control",Ke);k("vm-icon",ke);k("vm-tooltip",Be);k("vm-control-group",Ws);k("vm-control-spacer",Ks);k("vm-controls",Gs);k("vm-current-time",mn);k("vm-time",Qt);k("vm-end-time",gn);k("vm-fullscreen-control",Qs);k("vm-live-indicator",Ys);k("vm-mute-control",vn);k("vm-pip-control",Zs);k("vm-playback-control",er);k("vm-scrim",tr);k("vm-scrubber-control",ir);k("vm-slider",Ii);k("vm-settings-control",sr);k("vm-time-progress",or);k("vm-volume-control",lr);k("vm-default-settings",Wl);k("vm-icon",ke);k("vm-menu",Ei);k("vm-menu-item",Si);k("vm-menu-radio",Js);k("vm-menu-radio-group",Xs);k("vm-settings",nr);k("vm-submenu",rr);k("vm-default-ui",a0);k("vm-caption-control",qs);k("vm-control",Ke);k("vm-icon",ke);k("vm-tooltip",Be);k("vm-captions",$l);k("vm-click-to-play",zl);k("vm-control-group",Ws);k("vm-control-spacer",Ks);k("vm-controls",Gs);k("vm-current-time",mn);k("vm-time",Qt);k("vm-dbl-click-fullscreen",jl);k("vm-default-controls",ql);k("vm-end-time",gn);k("vm-fullscreen-control",Qs);k("vm-live-indicator",Ys);k("vm-mute-control",vn);k("vm-pip-control",Zs);k("vm-playback-control",er);k("vm-scrim",tr);k("vm-scrubber-control",ir);k("vm-slider",Ii);k("vm-settings-control",sr);k("vm-time-progress",or);k("vm-volume-control",lr);k("vm-default-settings",Wl);k("vm-menu",Ei);k("vm-menu-item",Si);k("vm-menu-radio",Js);k("vm-menu-radio-group",Xs);k("vm-settings",nr);k("vm-submenu",rr);k("vm-loading-screen",Kl);k("vm-poster",Gl);k("vm-spinner",Ql);k("vm-ui",Yl);k("vm-embed",pn);k("vm-end-time",gn);k("vm-time",Qt);k("vm-file",Ci);k("vm-fullscreen-control",Qs);k("vm-control",Ke);k("vm-icon",ke);k("vm-tooltip",Be);k("vm-hls",l0);k("vm-file",Ci);k("vm-video",ar);k("vm-icon",ke);k("vm-icon-library",c0);k("vm-live-indicator",Ys);k("vm-loading-screen",Kl);k("vm-menu",Ei);k("vm-menu-item",Si);k("vm-icon",ke);k("vm-menu-radio",Js);k("vm-icon",ke);k("vm-menu-item",Si);k("vm-menu-radio-group",Xs);k("vm-mute-control",vn);k("vm-control",Ke);k("vm-icon",ke);k("vm-tooltip",Be);k("vm-pip-control",Zs);k("vm-control",Ke);k("vm-icon",ke);k("vm-tooltip",Be);k("vm-playback-control",er);k("vm-control",Ke);k("vm-icon",ke);k("vm-tooltip",Be);k("vm-player",u0);k("vm-poster",Gl);k("vm-scrim",tr);k("vm-scrubber-control",ir);k("vm-slider",Ii);k("vm-tooltip",Be);k("vm-settings",nr);k("vm-menu",Ei);k("vm-settings-control",sr);k("vm-control",Ke);k("vm-icon",ke);k("vm-tooltip",Be);k("vm-skeleton",h0);k("vm-slider",Ii);k("vm-spinner",Ql);k("vm-submenu",rr);k("vm-icon",ke);k("vm-menu",Ei);k("vm-menu-item",Si);k("vm-time",Qt);k("vm-time-progress",or);k("vm-current-time",mn);k("vm-time",Qt);k("vm-end-time",gn);k("vm-tooltip",Be);k("vm-ui",Yl);k("vm-video",ar);k("vm-file",Ci);k("vm-vimeo",d0);k("vm-embed",pn);k("vm-volume-control",lr);k("vm-control",Ke);k("vm-icon",ke);k("vm-mute-control",vn);k("vm-tooltip",Be);k("vm-slider",Ii);k("vm-youtube",f0);k("vm-embed",pn);globalThis&&globalThis.__awaiter;function jm(t,e,i){const n=t.slice();return n[44]=e[i],n}function qm(t,e,i){const n=t.slice();return n[47]=e[i],n[49]=i,n}function Wm(t,e,i){const n=t.slice();return n[6]=e[i],n}function wx(t){let e;return{c(){e=_("source"),C(e,"data-src","https://svelte-vid-sync-chat-app-public.s3.amazonaws.com/survivor/tv.11516.S28E1.1080p.H264.20200815180824.mp4"),C(e,"type","video/mp4"),C(e,"class","svelte-1u7a8um")},m(i,n){q(i,e,n)},p:Ee,d(i){i&&j(e)}}}function kx(t){let e,i,n,s;return e=new ud({}),n=new px({}),{c(){Re(e.$$.fragment),i=$(),Re(n.$$.fragment)},m(r,o){Ae(e,r,o),q(r,i,o),Ae(n,r,o),s=!0},i(r){s||(W(e.$$.fragment,r),W(n.$$.fragment,r),s=!0)},o(r){Z(e.$$.fragment,r),Z(n.$$.fragment,r),s=!1},d(r){Pe(e,r),r&&j(i),Pe(n,r)}}}function Tx(t){let e,i,n,s;return e=new ud({}),n=new yx({}),{c(){Re(e.$$.fragment),i=$(),Re(n.$$.fragment)},m(r,o){Ae(e,r,o),q(r,i,o),Ae(n,r,o),s=!0},i(r){s||(W(e.$$.fragment,r),W(n.$$.fragment,r),s=!0)},o(r){Z(e.$$.fragment,r),Z(n.$$.fragment,r),s=!1},d(r){Pe(e,r),r&&j(i),Pe(n,r)}}}function _x(t){let e,i,n,s,r,o,a,l;return e=new vx({}),n=new zm({props:{fullWidth:!0,pin:"topLeft",$$slots:{default:[kx]},$$scope:{ctx:t}}}),r=new ud({}),a=new zm({props:{fullWidth:!0,pin:"bottomRight",$$slots:{default:[Tx]},$$scope:{ctx:t}}}),{c(){Re(e.$$.fragment),i=$(),Re(n.$$.fragment),s=$(),Re(r.$$.fragment),o=$(),Re(a.$$.fragment)},m(u,c){Ae(e,u,c),q(u,i,c),Ae(n,u,c),q(u,s,c),Ae(r,u,c),q(u,o,c),Ae(a,u,c),l=!0},p(u,c){const h={};c[1]&2097152&&(h.$$scope={dirty:c,ctx:u}),n.$set(h);const d={};c[1]&2097152&&(d.$$scope={dirty:c,ctx:u}),a.$set(d)},i(u){l||(W(e.$$.fragment,u),W(n.$$.fragment,u),W(r.$$.fragment,u),W(a.$$.fragment,u),l=!0)},o(u){Z(e.$$.fragment,u),Z(n.$$.fragment,u),Z(r.$$.fragment,u),Z(a.$$.fragment,u),l=!1},d(u){Pe(e,u),u&&j(i),Pe(n,u),u&&j(s),Pe(r,u),u&&j(o),Pe(a,u)}}}function Cx(t){let e,i,n,s;return e=new bx({props:{$$slots:{default:[wx]},$$scope:{ctx:t}}}),n=new mx({props:{noControls:!0,noClickToPlay:!0,noDblClickFullscreen:!0,$$slots:{default:[_x]},$$scope:{ctx:t}}}),{c(){Re(e.$$.fragment),i=$(),Re(n.$$.fragment)},m(r,o){Ae(e,r,o),q(r,i,o),Ae(n,r,o),s=!0},p(r,o){const a={};o[1]&2097152&&(a.$$scope={dirty:o,ctx:r}),e.$set(a);const l={};o[1]&2097152&&(l.$$scope={dirty:o,ctx:r}),n.$set(l)},i(r){s||(W(e.$$.fragment,r),W(n.$$.fragment,r),s=!0)},o(r){Z(e.$$.fragment,r),Z(n.$$.fragment,r),s=!1},d(r){Pe(e,r),r&&j(i),Pe(n,r)}}}function Ex(t){let e;return{c(){e=Oe("Sync to group")},m(i,n){q(i,e,n)},d(i){i&&j(e)}}}function Sx(t){let e,i=t[6].message_string+"",n,s,r,o,a=t[6].relative_timestamp+"",l,u,c;return{c(){e=_("li"),n=Oe(i),r=$(),o=_("div"),l=Oe(a),u=$(),C(e,"class","other svelte-1u7a8um"),C(o,"id","timestamp-other"),C(o,"class","svelte-1u7a8um")},m(h,d){q(h,e,d),b(e,n),q(h,r,d),q(h,o,d),b(o,l),b(o,u),c=!0},p(h,d){(!c||d[0]&32)&&i!==(i=h[6].message_string+"")&&Ni(n,i),(!c||d[0]&32)&&a!==(a=h[6].relative_timestamp+"")&&Ni(l,a)},i(h){c||(ei(()=>{!c||(s||(s=sn(e,Ps,{},!0)),s.run(1))}),c=!0)},o(h){s||(s=sn(e,Ps,{},!1)),s.run(0),c=!1},d(h){h&&j(e),h&&s&&s.end(),h&&j(r),h&&j(o)}}}function Ix(t){let e,i=t[6].message_string+"",n,s,r,o;return{c(){e=_("li"),n=Oe(i),r=$(),C(e,"class","server svelte-1u7a8um")},m(a,l){q(a,e,l),b(e,n),q(a,r,l),o=!0},p(a,l){(!o||l[0]&32)&&i!==(i=a[6].message_string+"")&&Ni(n,i)},i(a){o||(ei(()=>{!o||(s||(s=sn(e,Ps,{},!0)),s.run(1))}),o=!0)},o(a){s||(s=sn(e,Ps,{},!1)),s.run(0),o=!1},d(a){a&&j(e),a&&s&&s.end(),a&&j(r)}}}function Ax(t){let e,i=t[6].message_string+"",n,s,r,o,a=t[6].relative_timestamp+"",l,u,c;return{c(){e=_("li"),n=Oe(i),r=$(),o=_("div"),l=Oe(a),u=$(),C(e,"class","svelte-1u7a8um"),C(o,"id","timestamp"),C(o,"class","svelte-1u7a8um")},m(h,d){q(h,e,d),b(e,n),q(h,r,d),q(h,o,d),b(o,l),q(h,u,d),c=!0},p(h,d){(!c||d[0]&32)&&i!==(i=h[6].message_string+"")&&Ni(n,i),(!c||d[0]&32)&&a!==(a=h[6].relative_timestamp+"")&&Ni(l,a)},i(h){c||(ei(()=>{!c||(s||(s=sn(e,Ps,{},!0)),s.run(1))}),c=!0)},o(h){s||(s=sn(e,Ps,{},!1)),s.run(0),c=!1},d(h){h&&j(e),h&&s&&s.end(),h&&j(r),h&&j(o),h&&j(u)}}}function Km(t){let e,i,n,s;const r=[Ax,Ix,Sx],o=[];function a(l,u){return l[6].author===`${l[11]}`?0:l[6].author==="Server"?1:2}return e=a(t),i=o[e]=r[e](t),{c(){i.c(),n=Ga()},m(l,u){o[e].m(l,u),q(l,n,u),s=!0},p(l,u){let c=e;e=a(l),e===c?o[e].p(l,u):(An(),Z(o[c],1,1,()=>{o[c]=null}),Pn(),i=o[e],i?i.p(l,u):(i=o[e]=r[e](l),i.c()),W(i,1),i.m(n.parentNode,n))},i(l){s||(W(i),s=!0)},o(l){Z(i),s=!1},d(l){o[e].d(l),l&&j(n)}}}function Gm(t){let e,i,n,s,r,o,a,l,u,c=t[9],h=[];for(let p=0;p<c.length;p+=1)h[p]=Qm(qm(t,c,p));let d=t[0],f=[];for(let p=0;p<d.length;p+=1)f[p]=Ym(jm(t,d,p));return{c(){e=_("div"),i=_("header");for(let p=0;p<h.length;p+=1)h[p].c();n=$(),s=_("div"),s.textContent="X",r=$();for(let p=0;p<f.length;p+=1)f[p].c();C(s,"id","closer-icon"),C(s,"class","svelte-1u7a8um"),C(i,"class","svelte-1u7a8um"),C(e,"id","emoji-cont"),C(e,"class","svelte-1u7a8um")},m(p,T){q(p,e,T),b(e,i);for(let v=0;v<h.length;v+=1)h[v]&&h[v].m(i,null);b(i,n),b(i,s),b(e,r);for(let v=0;v<f.length;v+=1)f[v]&&f[v].m(e,null);a=!0,l||(u=B(s,"click",t[27]),l=!0)},p(p,T){if(T[0]&768){c=p[9];let v;for(v=0;v<c.length;v+=1){const S=qm(p,c,v);h[v]?h[v].p(S,T):(h[v]=Qm(S),h[v].c(),h[v].m(i,n))}for(;v<h.length;v+=1)h[v].d(1);h.length=c.length}if(T[0]&1025){d=p[0];let v;for(v=0;v<d.length;v+=1){const S=jm(p,d,v);f[v]?f[v].p(S,T):(f[v]=Ym(S),f[v].c(),f[v].m(e,null))}for(;v<f.length;v+=1)f[v].d(1);f.length=d.length}},i(p){a||(ei(()=>{!a||(o||(o=sn(e,lm,{y:-30},!0)),o.run(1))}),a=!0)},o(p){o||(o=sn(e,lm,{y:-30},!1)),o.run(0),a=!1},d(p){p&&j(e),Or(h,p),Or(f,p),p&&o&&o.end(),l=!1,u()}}}function Qm(t){let e,i=String.fromCodePoint(t[47])+"",n,s,r,o;return{c(){e=_("div"),n=Oe(i),C(e,"data-id",s=t[49]),C(e,"class","svelte-1u7a8um")},m(a,l){q(a,e,l),b(e,n),r||(o=B(e,"click",t[8]),r=!0)},p:Ee,d(a){a&&j(e),r=!1,o()}}}function Ym(t){let e,i=t[44]+"",n,s,r;return{c(){e=_("span"),n=Oe(i),C(e,"class","svelte-1u7a8um")},m(o,a){q(o,e,a),b(e,n),s||(r=B(e,"click",t[10]),s=!0)},p(o,a){a[0]&1&&i!==(i=o[44]+"")&&Ni(n,i)},d(o){o&&j(e),s=!1,r()}}}function Px(t){let e,i,n,s,r,o,a,l,u,c,h,d,f,p,T,v,S,O,I,V,G,P,ue,oe,D,ve,Te,x,he,ge,Fe,ze,De,$e,lt;function Xe(Q){t[23](Q)}function Ze(Q){t[24](Q)}let Me={autoplay:!0,muted:!0,$$slots:{default:[Cx]},$$scope:{ctx:t}};t[2]!==void 0&&(Me.paused=t[2]),t[3]!==void 0&&(Me.currentTime=t[3]),s=new gx({props:Me}),t[22](s),Bt.push(()=>kd(s,"paused",Xe)),Bt.push(()=>kd(s,"currentTime",Ze)),s.$on("vmCurrentTimeChange",t[7]),s.$on("vmPlaybackEnded",t[13]),I=new Ll({props:{color:"blue",$$slots:{default:[Ex]},$$scope:{ctx:t}}}),I.$on("click",t[14]);let Le=t[5],ae=[];for(let Q=0;Q<Le.length;Q+=1)ae[Q]=Km(Wm(t,Le,Q));const et=Q=>Z(ae[Q],1,1,()=>{ae[Q]=null});let de=t[4]&&Gm(t);return{c(){e=_("div"),i=_("div"),n=_("div"),Re(s.$$.fragment),a=$(),l=_("br"),u=$(),c=_("p"),c.textContent="Click the unmute button in the top-right corner of the video!",h=$(),d=_("br"),f=$(),p=_("p"),T=Oe("If you feel out-of-sync with the group, click the sync button below:"),v=_("br"),S=_("br"),O=$(),Re(I.$$.fragment),V=$(),G=_("div"),P=_("div"),ue=_("ul");for(let Q=0;Q<ae.length;Q+=1)ae[Q].c();oe=$(),D=_("form"),ve=_("div"),Te=_("div"),Te.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-smile svelte-1u7a8um"><circle cx="12" cy="12" r="10" class="svelte-1u7a8um"></circle><path d="M8 14s1.5 2 4 2 4-2 4-2" class="svelte-1u7a8um"></path><line x1="9" y1="9" x2="9.01" y2="9" class="svelte-1u7a8um"></line><line x1="15" y1="9" x2="15.01" y2="9" class="svelte-1u7a8um"></line></svg>',x=$(),de&&de.c(),he=$(),ge=_("input"),Fe=$(),ze=_("button"),ze.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-send svelte-1u7a8um"><line x1="22" y1="2" x2="11" y2="13" class="svelte-1u7a8um"></line><polygon points="22 2 15 22 11 13 2 9 22 2" class="svelte-1u7a8um"></polygon></svg>',C(l,"class","svelte-1u7a8um"),C(c,"class","svelte-1u7a8um"),C(d,"class","svelte-1u7a8um"),C(v,"class","svelte-1u7a8um"),C(S,"class","svelte-1u7a8um"),C(p,"class","svelte-1u7a8um"),C(n,"id","video_cont"),C(n,"class","svelte-1u7a8um"),C(i,"class","basis-1/2 svelte-1u7a8um"),C(ue,"id","messages"),C(ue,"class","svelte-1u7a8um"),C(P,"id","chatWindow"),C(P,"class","svelte-1u7a8um"),C(Te,"id","emoji-opener-icon"),C(Te,"tabindex","0"),C(Te,"class","svelte-1u7a8um"),C(ve,"id","btn-emoji-icon-cont"),C(ve,"class","svelte-1u7a8um"),C(ge,"id","m"),C(ge,"autocomplete","off"),C(ge,"placeholder",t[12]),C(ge,"class","svelte-1u7a8um"),C(ze,"class","svelte-1u7a8um"),C(D,"action",""),C(D,"class","svelte-1u7a8um"),C(G,"class","basis-1/2 svelte-1u7a8um"),C(e,"class","flex svelte-1u7a8um")},m(Q,se){q(Q,e,se),b(e,i),b(i,n),Ae(s,n,null),b(n,a),b(n,l),b(n,u),b(n,c),b(n,h),b(n,d),b(n,f),b(n,p),b(p,T),b(p,v),b(p,S),b(p,O),Ae(I,p,null),b(e,V),b(e,G),b(G,P),b(P,ue);for(let re=0;re<ae.length;re+=1)ae[re]&&ae[re].m(ue,null);b(G,oe),b(G,D),b(D,ve),b(ve,Te),b(D,x),de&&de.m(D,null),b(D,he),b(D,ge),vd(ge,t[6].message_string),b(D,Fe),b(D,ze),De=!0,$e||(lt=[B(Te,"click",t[25]),B(Te,"keydown",t[26]),B(ge,"input",t[28]),B(ze,"click",Mu(t[15]))],$e=!0)},p(Q,se){const re={};se[1]&2097152&&(re.$$scope={dirty:se,ctx:Q}),!r&&se[0]&4&&(r=!0,re.paused=Q[2],wd(()=>r=!1)),!o&&se[0]&8&&(o=!0,re.currentTime=Q[3],wd(()=>o=!1)),s.$set(re);const F={};if(se[1]&2097152&&(F.$$scope={dirty:se,ctx:Q}),I.$set(F),se[0]&2080){Le=Q[5];let U;for(U=0;U<Le.length;U+=1){const _e=Wm(Q,Le,U);ae[U]?(ae[U].p(_e,se),W(ae[U],1)):(ae[U]=Km(_e),ae[U].c(),W(ae[U],1),ae[U].m(ue,null))}for(An(),U=Le.length;U<ae.length;U+=1)et(U);Pn()}Q[4]?de?(de.p(Q,se),se[0]&16&&W(de,1)):(de=Gm(Q),de.c(),W(de,1),de.m(D,he)):de&&(An(),Z(de,1,1,()=>{de=null}),Pn()),se[0]&64&&ge.value!==Q[6].message_string&&vd(ge,Q[6].message_string)},i(Q){if(!De){W(s.$$.fragment,Q),W(I.$$.fragment,Q);for(let se=0;se<Le.length;se+=1)W(ae[se]);W(de),De=!0}},o(Q){Z(s.$$.fragment,Q),Z(I.$$.fragment,Q),ae=ae.filter(Boolean);for(let se=0;se<ae.length;se+=1)Z(ae[se]);Z(de),De=!1},d(Q){Q&&j(e),t[22](null),Pe(s),Pe(I),Or(ae,Q),de&&de.d(),$e=!1,ki(lt)}}}function Rx(t,e,i){let n,s,r,o;St(t,Fn,F=>i(20,r=F)),St(t,As,F=>i(21,o=F));const a=jt();console.log("groupStore",r);let l,u=!1,c=0;const h=async F=>{i(3,c=F.detail)};let d=[{type:"faces",minVal:128512,maxVal:128580},{type:"faces2",minVal:129296,maxVal:129327}],f=0,p=[];const T=()=>i(0,p=[]),v=F=>{i(16,f=Number(F.target.dataset.id)),T()};let S=[128512,129313],O=!1;const I=F=>{i(6,he.message_string+=F.target.textContent,he)},V=(F,U)=>{let ct=_S[0][F].indexOf(U);return G[ct]};let G=[128028,128049,128055,128013];const P=String.fromCodePoint(V(o.groupId,o.netId)),oe={author:`${P}`,absolute_timestamp:la,message_string:"Type your message here..."}.message_string,D={author:"Server",absolute_timestamp:la,message_string:`Server: You have joined the chat as ${P}`},ve=async()=>{let F=r.groupId,U=await Qo(F);return console.log("groupMessages",U),U};let Te=[D],x=ve();console.log("greeting messages",x),console.log(Qo(r.groupId));let he={author:`${P}`,absolute_timestamp:la,message_string:""};const ge=()=>{console.log("VIDEO ENDED"),a("finished")},Fe=async()=>{let F=r.users;await tm(F,!0)},ze=async()=>{await IS(o.userId,c)},De=async F=>{await tm(r.users,F)},$e=async F=>{await AS(r.groupId,F)},lt=async()=>{await Qo(r.groupId)},Xe=async()=>{let F=r.users,U=o.groupId,_e=await PS(U,F);console.log("Experiment -- highestTimestamp",_e),i(3,c=_e)},Ze=()=>{const F=document.getElementById("chatWindow");setTimeout(()=>{F.scrollTop=F.scrollHeight},0)},Me=async()=>{if(i(6,he.message_string=he.message_string.trim(),he),he.message_string=="")return;let F={author:`${P}`,relative_timestamp:CS(c),message_string:`${P}: ${he.message_string}`};console.log("messageObj",F),await RS(r.groupId,F);let U=await Qo(r.groupId);i(5,Te=U),console.log("updated messages list",Te),Ze(),i(6,he.message_string="",he),i(4,O=!1)};Gt(()=>{Fe(),i(17,x=ve())});function Le(F){Bt[F?"unshift":"push"](()=>{l=F,i(1,l)})}function ae(F){u=F,i(2,u)}function et(F){c=F,i(3,c)}const de=()=>i(4,O=!O),Q=F=>{(F.key==="Enter"||F.key===" ")&&i(4,O=!O)},se=()=>i(4,O=!1);function re(){he.message_string=this.value,i(6,he)}return t.$$.update=()=>{if(t.$$.dirty[0]&65536&&i(19,n=d[f].minVal),t.$$.dirty[0]&65536&&i(18,s=d[f].maxVal),t.$$.dirty[0]&786433)for(let F=n;F<=s;F++)i(0,p=[...p,String.fromCodePoint(F)]);t.$$.dirty[0]&3145728&&(o.logVideoTimestamp==!0&&(ze(),Xe(),De(!1)),r.newMessage==!0&&(lt(),ve(),$e(!1)))},[p,l,u,c,O,Te,he,h,v,S,I,P,oe,ge,Fe,Me,f,x,s,n,r,o,Le,ae,et,de,Q,se,re]}class xx extends ot{constructor(e){super(),rt(this,e,Rx,Px,Je,{},null,[-1,-1])}}function Jm(t){let e,i,n,s,r,o,a,l,u,c,h,d,f,p,T,v,S,O,I,V,G,P,ue,oe,D,ve,Te,x,he,ge,Fe,ze,De,$e,lt,Xe,Ze,Me,Le,ae,et,de,Q,se,re,F,U,_e,ct,Ne,ai,yn,cr;return Ne=new Ll({props:{type:"submit",color:"blue",$$slots:{default:[Dx]},$$scope:{ctx:t}}}),{c(){e=_("form"),i=_("div"),i.innerHTML=`<label class="block mb-2 text-sm font-bold text-gray-700" for="name">Name</label> 
        <input class="w-full px-3 py-2 leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline" id="name" type="text" name="name" placeholder="Type your FULL name (including middle name)"/>`,n=$(),s=_("div"),s.innerHTML=`<label class="block mb-2 text-sm font-bold text-gray-700" for="age">Age</label> 
        <input class="w-full px-3 py-2 leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline" id="age" type="text" name="age" placeholder="Type your age in years"/>`,r=$(),o=_("div"),o.innerHTML=`<label class="block mb-2 text-sm font-bold text-gray-700" for="birth">Birth Date</label> 
        <input type="date" name="birth" id="birth" min="1988-01-01" class="w-full px-3 py-2 leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"/>`,a=$(),l=_("div"),l.innerHTML=`<label for="birthCity" class="block mb-2 text-sm font-bold text-gray-700">Birth Location</label> 
        <input class="w-full px-3 py-2 leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline" id="birthCity" type="text" name="birthCity" placeholder="City, state, country (like in passport/visa)"/>`,u=$(),c=_("div"),c.innerHTML=`<label class="block mb-2 text-sm font-bold text-gray-700" for="nativeLang">Native Language</label> 
        <input class="w-full px-3 py-2 leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline" id="nativeLang" type="text" name="nativeLang" placeholder="What is your native language"/>`,h=$(),d=_("div"),f=_("label"),f.textContent="Gender",p=$(),T=_("select"),v=_("option"),v.textContent="--gender assigned at birth--",S=_("option"),S.textContent="Male",O=_("option"),O.textContent="Female",I=_("option"),I.textContent="Other",V=$(),G=_("div"),P=_("label"),P.textContent="Race",ue=$(),oe=_("select"),D=_("option"),D.textContent="--choose your race--",ve=_("option"),ve.textContent="Asian / Asian-American",Te=_("option"),Te.textContent="Black / African-American",x=_("option"),x.textContent="Native-American / Alaskan-Native",he=_("option"),he.textContent="Pacific-Islander / Native-Hawaiian",ge=_("option"),ge.textContent="White",Fe=_("option"),Fe.textContent="Other",ze=$(),De=_("div"),$e=_("label"),$e.textContent="Ethnicity",lt=$(),Xe=_("select"),Ze=_("option"),Ze.textContent="--choose your ethnicity--",Me=_("option"),Me.textContent="Hispanic",Le=_("option"),Le.textContent="Not Hispanic",ae=$(),et=_("div"),de=_("label"),de.textContent="Handedness",Q=$(),se=_("select"),re=_("option"),re.textContent="--choose your dominant hand--",F=_("option"),F.textContent="Right-Handed",U=_("option"),U.textContent="Left-Handed",_e=$(),ct=_("div"),Re(Ne.$$.fragment),C(i,"class","mb-4"),C(s,"class","mb-4"),C(o,"class","mb-4"),C(l,"class","mb-4"),C(c,"class","mb-4"),C(f,"class","block mb-2 text-sm font-bold text-gray-700"),C(f,"for","sex"),v.__value="",v.value=v.__value,S.__value="male",S.value=S.__value,O.__value="female",O.value=O.__value,I.__value="other",I.value=I.__value,C(T,"id","sex"),C(T,"name","sex"),C(T,"class","w-full px-3 py-2 leading-tight border rounded shadow focus:outline-none focus:shadow-outline"),C(d,"class","mb-4"),C(P,"for","race"),C(P,"class","mb-2 text-sm font-bold text-gray-700"),D.__value="",D.value=D.__value,ve.__value="Asian",ve.value=ve.__value,Te.__value="Black",Te.value=Te.__value,x.__value="Native-American",x.value=x.__value,he.__value="Pacific-Islander",he.value=he.__value,ge.__value="White",ge.value=ge.__value,Fe.__value="Other",Fe.value=Fe.__value,C(oe,"id","race"),C(oe,"name","race"),C(oe,"class","w-full px-3 py-2 leading-tight border rounded shadow focus:outline-none focus:shadow-outline"),C(G,"class","mb-4"),C($e,"class","block mb-2 text-sm font-bold text-gray-700"),C($e,"for","ethnicity"),Ze.__value="",Ze.value=Ze.__value,Me.__value="Hispanic",Me.value=Me.__value,Le.__value="Not-Hispanic",Le.value=Le.__value,C(Xe,"id","ethnicity"),C(Xe,"name","ethnicity"),C(Xe,"class","w-full px-3 py-2 leading-tight border rounded shadow focus:outline-none focus:shadow-outline"),C(De,"class","mb-4"),C(de,"class","block mb-2 text-sm font-bold text-gray-700"),C(de,"for","handed"),re.__value="",re.value=re.__value,F.__value="Right",F.value=F.__value,U.__value="Left",U.value=U.__value,C(se,"id","handed"),C(se,"name","handed"),C(se,"class","w-full px-3 py-2 leading-tight border rounded shadow focus:outline-none focus:shadow-outline"),C(et,"class","mb-4"),C(ct,"class","text-center"),C(e,"class","px-8 pt-6 pb-8 mb-4 bg-white rounded shadow-md")},m(qt,bn){q(qt,e,bn),b(e,i),b(e,n),b(e,s),b(e,r),b(e,o),b(e,a),b(e,l),b(e,u),b(e,c),b(e,h),b(e,d),b(d,f),b(d,p),b(d,T),b(T,v),b(T,S),b(T,O),b(T,I),b(e,V),b(e,G),b(G,P),b(G,ue),b(G,oe),b(oe,D),b(oe,ve),b(oe,Te),b(oe,x),b(oe,he),b(oe,ge),b(oe,Fe),b(e,ze),b(e,De),b(De,$e),b(De,lt),b(De,Xe),b(Xe,Ze),b(Xe,Me),b(Xe,Le),b(e,ae),b(e,et),b(et,de),b(et,Q),b(et,se),b(se,re),b(se,F),b(se,U),b(e,_e),b(e,ct),Ae(Ne,ct,null),ai=!0,yn||(cr=B(e,"submit",Mu(t[1])),yn=!0)},p(qt,bn){const jn={};bn&128&&(jn.$$scope={dirty:bn,ctx:qt}),Ne.$set(jn)},i(qt){ai||(W(Ne.$$.fragment,qt),ai=!0)},o(qt){Z(Ne.$$.fragment,qt),ai=!1},d(qt){qt&&j(e),Pe(Ne),yn=!1,cr()}}}function Dx(t){let e;return{c(){e=Oe("Submit")},m(i,n){q(i,e,n)},d(i){i&&j(e)}}}function Mx(t){let e,i,n,s,r=!t[0]&&Jm(t);return{c(){e=_("div"),i=_("div"),i.innerHTML='<h1 class="mb-4 text-2xl">Thanks for participating!</h1>',n=$(),r&&r.c(),C(i,"class","text-center"),C(e,"class","w-full max-w-md mb-6")},m(o,a){q(o,e,a),b(e,i),b(e,n),r&&r.m(e,null),s=!0},p(o,[a]){o[0]?r&&(An(),Z(r,1,1,()=>{r=null}),Pn()):r?(r.p(o,a),a&1&&W(r,1)):(r=Jm(o),r.c(),W(r,1),r.m(e,null))},i(o){s||(W(r),s=!0)},o(o){Z(r),s=!1},d(o){o&&j(e),r&&r.d()}}}function Lx(t,e,i){let n,s;St(t,Fn,c=>i(4,n=c)),St(t,As,c=>i(5,s=c));let r=!1,o=0,a=n.trials.length*_y.receiverEndowmentPerTrial;function l(){s.role==="decider1"?n.trials.forEach(({endowment:c,D1_agency:h,D1_spent:d,R_D1_compensate:f})=>{f=f===void 0?0:f,o+=c*h-d+f}):s.role==="decider2"?n.trials.forEach(({endowment:c,D2_agency:h,D2_spent:d,R_D2_compensate:f})=>{f=f===void 0?0:f,o+=c*h-d+f}):s.role==="receiver"&&(n.trials.forEach(({R_D1_compensate:c,R_D2_compensate:h})=>{c=c===void 0?0:c,h=h===void 0?0:h,a-=c+h}),o=a)}async function u(c){const h=new FormData(c.target);i(0,r=!0);const d={name:h.get("name"),age:h.get("age"),birth:h.get("birth"),birthCity:h.get("birthCity"),nativeLang:h.get("nativeLang"),sex:h.get("sex"),race:h.get("race"),ethnicity:h.get("ethnicity"),handed:h.get("handed"),bonus:o};await MS(d)}return Gt(l),[r,u]}class Nx extends ot{constructor(e){super(),rt(this,e,Lx,Mx,Je,{})}}function Ox(t){let e,i,n,s,r,o,a,l;return{c(){e=_("div"),i=$(),n=_("div"),s=_("button"),s.textContent="logout",r=$(),o=_("div"),C(s,"class","px-4 py-1 text-xs font-bold bg-blue-500 rounded"),Vo(s,"invisible",!t[0]),C(e,"class","banner svelte-11u7anh"),Vo(e,"bg-red-600",!1),Vo(e,"bg-gray-600",!0)},m(u,c){q(u,e,c),b(e,i),b(e,n),b(n,s),b(n,r),b(n,o),a||(l=B(s,"click",t[2]),a=!0)},p(u,[c]){c&1&&Vo(s,"invisible",!u[0])},i:Ee,o:Ee,d(u){u&&j(e),a=!1,l()}}}function Vx(t,e,i){let n,s,r;return St(t,Mr,a=>i(0,n=a)),St(t,wi,a=>i(3,s=a)),St(t,is,a=>i(1,r=a)),[n,r,async()=>{const a=Ku();try{await Sk(a),localStorage.removeItem("userId"),ls(wi,s=null,s),ls(Mr,n=!1,n),console.log("Sucessfully logged out of firebase")}catch(l){console.error(l)}}]}class Fx extends ot{constructor(e){super(),rt(this,e,Vx,Ox,Je,{})}}function Ux(t){let e,i,n,s;const r=[qx,jx,zx,$x],o=[];function a(l,u){return l[0].currentState==="request-full-screen"?0:l[0].currentState==="countdown"?1:l[0].currentState==="experiment"?2:l[0].currentState==="debrief"?3:-1}return~(e=a(t))&&(i=o[e]=r[e](t)),{c(){i&&i.c(),n=Ga()},m(l,u){~e&&o[e].m(l,u),q(l,n,u),s=!0},p(l,u){let c=e;e=a(l),e===c?~e&&o[e].p(l,u):(i&&(An(),Z(o[c],1,1,()=>{o[c]=null}),Pn()),~e?(i=o[e],i?i.p(l,u):(i=o[e]=r[e](l),i.c()),W(i,1),i.m(n.parentNode,n)):i=null)},i(l){s||(W(i),s=!0)},o(l){Z(i),s=!1},d(l){~e&&o[e].d(l),l&&j(n)}}}function Hx(t){let e,i;return e=new Cy({}),{c(){Re(e.$$.fragment)},m(n,s){Ae(e,n,s),i=!0},p:Ee,i(n){i||(W(e.$$.fragment,n),i=!0)},o(n){Z(e.$$.fragment,n),i=!1},d(n){Pe(e,n)}}}function Bx(t){let e,i;return e=new HS({}),{c(){Re(e.$$.fragment)},m(n,s){Ae(e,n,s),i=!0},p:Ee,i(n){i||(W(e.$$.fragment,n),i=!0)},o(n){Z(e.$$.fragment,n),i=!1},d(n){Pe(e,n)}}}function $x(t){let e,i;return e=new Nx({}),{c(){Re(e.$$.fragment)},m(n,s){Ae(e,n,s),i=!0},p:Ee,i(n){i||(W(e.$$.fragment,n),i=!0)},o(n){Z(e.$$.fragment,n),i=!1},d(n){Pe(e,n)}}}function zx(t){let e,i;return e=new xx({}),e.$on("finished",t[5]),{c(){Re(e.$$.fragment)},m(n,s){Ae(e,n,s),i=!0},p:Ee,i(n){i||(W(e.$$.fragment,n),i=!0)},o(n){Z(e.$$.fragment,n),i=!1},d(n){Pe(e,n)}}}function jx(t){let e,i;return e=new tI({}),e.$on("finished",t[4]),{c(){Re(e.$$.fragment)},m(n,s){Ae(e,n,s),i=!0},p:Ee,i(n){i||(W(e.$$.fragment,n),i=!0)},o(n){Z(e.$$.fragment,n),i=!1},d(n){Pe(e,n)}}}function qx(t){let e,i;return e=new GS({}),e.$on("finished",t[3]),{c(){Re(e.$$.fragment)},m(n,s){Ae(e,n,s),i=!0},p:Ee,i(n){i||(W(e.$$.fragment,n),i=!0)},o(n){Z(e.$$.fragment,n),i=!1},d(n){Pe(e,n)}}}function Wx(t){let e,i,n,s,r,o;const a=[Bx,Hx,Ux],l=[];function u(c,h){return c[1]?!c[0]||!c[0].currentState?1:2:0}return i=u(t),n=l[i]=a[i](t),r=new Fx({}),{c(){e=_("main"),n.c(),s=$(),Re(r.$$.fragment),C(e,"class","flex flex-col items-center p-10 mx-auto space-y-10 bg-white")},m(c,h){q(c,e,h),l[i].m(e,null),q(c,s,h),Ae(r,c,h),o=!0},p(c,[h]){let d=i;i=u(c),i===d?l[i].p(c,h):(An(),Z(l[d],1,1,()=>{l[d]=null}),Pn(),n=l[i],n?n.p(c,h):(n=l[i]=a[i](c),n.c()),W(n,1),n.m(e,null))},i(c){o||(W(n),W(r.$$.fragment,c),o=!0)},o(c){Z(n),Z(r.$$.fragment,c),o=!1},d(c){c&&j(e),l[i].d(),c&&j(s),Pe(r,c)}}}function Kx(t,e,i){let n,s,r,o;St(t,Fn,f=>i(0,n=f)),St(t,As,f=>i(8,s=f)),St(t,wi,f=>i(9,r=f)),St(t,Mr,f=>i(1,o=f));let a,l;const u=async f=>{console.log("App -- updateState -- currentState",n.currentState),console.log("App -- updateState -- newState",f),await xS(f)};return Gt(async()=>{Ek(kS,async f=>{if(!f)ls(Mr,o=!1,o),a&&(a(),a=null),l&&(l(),l=null);else{ls(wi,r=localStorage.getItem("userId"),r),ls(Mr,o=!0,o),console.log(`User ${r} signed-in. Loading data...`);try{a=Kf(At(Qe,"survivor-participants",r),p=>{var T,v;if(p.exists()){As.set(p.data());const S=(T=p.data())==null?void 0:T.groupId,O=(v=p.data())==null?void 0:v.epNum,I=`${S}_${O}`;S!=""&&(l=Kf(At(Qe,"survivor-groups",I),V=>{Fn.set(V.data())}))}else console.log("userDoc does not exist")})}catch(p){console.error(p)}}})}),console.log("App.svelte -- userStore['currentState']",s.currentState),console.log("App.svelte -- groupStore['currentState']",n.currentState),[n,o,u,()=>u("countdown"),()=>u("experiment"),()=>u("debrief")]}class Gx extends ot{constructor(e){super(),rt(this,e,Kx,Wx,Je,{})}}new Gx({target:document.getElementById("app")});
